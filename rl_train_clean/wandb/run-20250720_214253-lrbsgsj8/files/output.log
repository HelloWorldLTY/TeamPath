Using LocalLogger is deprecated. The constructor API will change
Checkpoint tracker file does not exist: %s /nfs/roberts/project/pi_hz27/tl688/verl/../ckpt/checkpoints/latest_checkpointed_iteration.txt
Training from scratch
Training Progress:   2%|‚ñè         | 7/340 [08:08<6:00:01, 64.87s/it]
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/1.jsonl
step:1 - global_seqlen/min:78586.000 - global_seqlen/max:83795.000 - global_seqlen/minmax_diff:5209.000 - global_seqlen/balanced_min:80935.000 - global_seqlen/balanced_max:82008.000 - global_seqlen/mean:81332.375 - actor/entropy_loss:1.698 - training/rollout_probs_diff_max:0.985 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:0.043 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.324 - perf/mfu/actor:0.158 - perf/max_memory_allocated_gb:19.991 - perf/max_memory_reserved_gb:42.891 - perf/cpu_memory_used_gb:94.822 - actor/lr:0.000 - training/global_step:1.000 - training/epoch:0.000 - critic/score/mean:0.472 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.472 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.027 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.027 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:173.729 - response_length/max:2048.000 - response_length/min:15.000 - response_length/clip_ratio:0.001 - prompt_length/mean:461.680 - prompt_length/max:511.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:30.447 - timing_s/reshard:9.753 - timing_s/gen:45.096 - timing_s/reward:0.160 - timing_s/old_log_prob:11.797 - timing_s/ref:10.681 - timing_s/adv:0.024 - timing_s/update_actor:24.755 - timing_s/dump_rollout_generations:0.299 - timing_s/step:92.856 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.038 - timing_per_token_ms/gen:0.253 - timing_per_token_ms/ref:0.016 - perf/total_num_tokens:650659.000 - perf/time_per_step:92.856 - perf/throughput:875.897
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/2.jsonl
step:2 - global_seqlen/min:76545.000 - global_seqlen/max:82978.000 - global_seqlen/minmax_diff:6433.000 - global_seqlen/balanced_min:79542.000 - global_seqlen/balanced_max:80596.000 - global_seqlen/mean:79674.000 - actor/entropy_loss:1.745 - training/rollout_probs_diff_max:0.985 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.214 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:27.512 - perf/max_memory_reserved_gb:45.475 - perf/cpu_memory_used_gb:97.473 - actor/lr:0.000 - training/global_step:2.000 - training/epoch:0.000 - critic/score/mean:0.529 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.529 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:164.195 - response_length/max:2048.000 - response_length/min:25.000 - response_length/clip_ratio:0.001 - prompt_length/mean:458.258 - prompt_length/max:521.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:23.438 - timing_s/reshard:7.431 - timing_s/gen:32.165 - timing_s/reward:0.175 - timing_s/old_log_prob:7.519 - timing_s/ref:7.357 - timing_s/adv:0.022 - timing_s/update_actor:22.331 - timing_s/dump_rollout_generations:0.271 - timing_s/step:69.880 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.191 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:637392.000 - perf/time_per_step:69.880 - perf/throughput:1140.148
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/3.jsonl
step:3 - global_seqlen/min:76600.000 - global_seqlen/max:84187.000 - global_seqlen/minmax_diff:7587.000 - global_seqlen/balanced_min:79803.000 - global_seqlen/balanced_max:80875.000 - global_seqlen/mean:80070.375 - actor/entropy_loss:1.767 - training/rollout_probs_diff_max:0.886 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:-0.040 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.855 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:27.512 - perf/max_memory_reserved_gb:47.385 - perf/cpu_memory_used_gb:100.248 - actor/lr:0.000 - training/global_step:3.000 - training/epoch:0.000 - critic/score/mean:0.540 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.540 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.075 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.075 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:166.308 - response_length/max:2048.000 - response_length/min:23.000 - response_length/clip_ratio:0.001 - prompt_length/mean:459.242 - prompt_length/max:535.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.700 - timing_s/reshard:4.167 - timing_s/gen:27.412 - timing_s/reward:0.158 - timing_s/old_log_prob:7.527 - timing_s/ref:7.345 - timing_s/adv:0.030 - timing_s/update_actor:21.838 - timing_s/dump_rollout_generations:0.273 - timing_s/step:64.613 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.161 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:640563.000 - perf/time_per_step:64.613 - perf/throughput:1239.221
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/4.jsonl
step:4 - global_seqlen/min:74786.000 - global_seqlen/max:83187.000 - global_seqlen/minmax_diff:8401.000 - global_seqlen/balanced_min:78987.000 - global_seqlen/balanced_max:80038.000 - global_seqlen/mean:79154.000 - actor/entropy_loss:1.744 - training/rollout_probs_diff_max:0.992 - training/rollout_probs_diff_mean:0.044 - training/rollout_probs_diff_std:0.074 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:-0.056 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.847 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:101.246 - actor/lr:0.000 - training/global_step:4.000 - training/epoch:0.000 - critic/score/mean:0.533 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.533 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.007 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:158.648 - response_length/max:2048.000 - response_length/min:24.000 - response_length/clip_ratio:0.001 - prompt_length/mean:459.742 - prompt_length/max:514.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.904 - timing_s/reshard:4.133 - timing_s/gen:27.593 - timing_s/reward:0.157 - timing_s/old_log_prob:7.301 - timing_s/ref:7.217 - timing_s/adv:0.022 - timing_s/update_actor:22.338 - timing_s/dump_rollout_generations:0.270 - timing_s/step:64.929 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.170 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:633232.000 - perf/time_per_step:64.929 - perf/throughput:1219.082
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/5.jsonl
step:5 - global_seqlen/min:74652.000 - global_seqlen/max:82765.000 - global_seqlen/minmax_diff:8113.000 - global_seqlen/balanced_min:79786.000 - global_seqlen/balanced_max:80945.000 - global_seqlen/mean:79948.750 - actor/entropy_loss:1.763 - training/rollout_probs_diff_max:0.760 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.003 - actor/kl_coef:0.010 - actor/pg_loss:0.176 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.964 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:103.492 - actor/lr:0.000 - training/global_step:5.000 - training/epoch:0.000 - critic/score/mean:0.517 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.517 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.058 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.058 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:165.256 - response_length/max:2048.000 - response_length/min:30.000 - response_length/clip_ratio:0.001 - prompt_length/mean:459.344 - prompt_length/max:491.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.818 - timing_s/reshard:4.166 - timing_s/gen:27.556 - timing_s/reward:0.159 - timing_s/old_log_prob:7.537 - timing_s/ref:7.086 - timing_s/adv:0.025 - timing_s/update_actor:22.104 - timing_s/dump_rollout_generations:0.265 - timing_s/step:64.764 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.163 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:639590.000 - perf/time_per_step:64.764 - perf/throughput:1234.465
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/6.jsonl
step:6 - global_seqlen/min:75344.000 - global_seqlen/max:82551.000 - global_seqlen/minmax_diff:7207.000 - global_seqlen/balanced_min:77964.000 - global_seqlen/balanced_max:79155.000 - global_seqlen/mean:78622.250 - actor/entropy_loss:1.557 - training/rollout_probs_diff_max:0.959 - training/rollout_probs_diff_mean:0.042 - training/rollout_probs_diff_std:0.072 - actor/kl_loss:0.003 - actor/kl_coef:0.010 - actor/pg_loss:0.082 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.696 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:104.869 - actor/lr:0.000 - training/global_step:6.000 - training/epoch:0.000 - critic/score/mean:0.504 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.504 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.081 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.081 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:151.736 - response_length/max:2048.000 - response_length/min:39.000 - response_length/clip_ratio:0.002 - prompt_length/mean:462.500 - prompt_length/max:516.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:23.011 - timing_s/reshard:6.122 - timing_s/gen:29.666 - timing_s/reward:0.156 - timing_s/old_log_prob:7.362 - timing_s/ref:7.305 - timing_s/adv:0.037 - timing_s/update_actor:21.871 - timing_s/dump_rollout_generations:0.265 - timing_s/step:66.695 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.191 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:628978.000 - perf/time_per_step:66.695 - perf/throughput:1178.832
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/7.jsonl
step:7 - global_seqlen/min:74666.000 - global_seqlen/max:81136.000 - global_seqlen/minmax_diff:6470.000 - global_seqlen/balanced_min:77494.000 - global_seqlen/balanced_max:77784.000 - global_seqlen/mean:77531.000 - actor/entropy_loss:1.648 - training/rollout_probs_diff_max:0.763 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.072 - actor/kl_loss:0.003 - actor/kl_coef:0.010 - actor/pg_loss:0.059 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.877 - perf/mfu/actor:0.188 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:106.918 - actor/lr:0.000 - training/global_step:7.000 - training/epoch:0.000 - critic/score/mean:0.547 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.547 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.007 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:146.203 - response_length/max:1038.000 - response_length/min:35.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.508 - prompt_length/max:492.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:16.619 - timing_s/reshard:6.722 - timing_s/gen:23.895 - timing_s/reward:0.152 - timing_s/old_log_prob:7.230 - timing_s/ref:6.997 - timing_s/adv:0.022 - timing_s/update_actor:19.862 - timing_s/dump_rollout_generations:0.266 - timing_s/step:58.457 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.032 - timing_per_token_ms/gen:0.160 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:620248.000 - perf/time_per_step:58.457 - perf/throughput:1326.290
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/8.jsonl
step:8 - global_seqlen/min:74291.000 - global_seqlen/max:81465.000 - global_seqlen/minmax_diff:7174.000 - global_seqlen/balanced_min:77597.000 - global_seqlen/balanced_max:78984.000 - global_seqlen/mean:77947.625 - actor/entropy_loss:1.542 - training/rollout_probs_diff_max:0.888 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.005 - actor/kl_coef:0.010 - actor/pg_loss:-0.041 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.678 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:108.121 - actor/lr:0.000 - training/global_step:8.000 - training/epoch:0.000 - critic/score/mean:0.528 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.528 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.022 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.022 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:145.771 - response_length/max:2048.000 - response_length/min:40.000 - response_length/clip_ratio:0.001 - prompt_length/mean:463.195 - prompt_length/max:507.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.564 - timing_s/reshard:7.497 - timing_s/gen:31.372 - timing_s/reward:0.151 - timing_s/old_log_prob:7.283 - timing_s/ref:7.042 - timing_s/adv:0.022 - timing_s/update_actor:21.646 - timing_s/dump_rollout_generations:0.266 - timing_s/step:67.818 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.210 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:623581.000 - perf/time_per_step:67.818 - perf/throughput:1149.360
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/9.jsonl
step:9 - global_seqlen/min:75668.000 - global_seqlen/max:79409.000 - global_seqlen/minmax_diff:3741.000 - global_seqlen/balanced_min:77229.000 - global_seqlen/balanced_max:77278.000 - global_seqlen/mean:77235.375 - actor/entropy_loss:1.489 - training/rollout_probs_diff_max:0.827 - training/rollout_probs_diff_mean:0.045 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.005 - actor/kl_coef:0.010 - actor/pg_loss:0.164 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.722 - perf/mfu/actor:0.166 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:107.934 - actor/lr:0.000 - training/global_step:9.000 - training/epoch:0.000 - critic/score/mean:0.550 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.550 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.020 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.020 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:143.878 - response_length/max:736.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.523 - prompt_length/max:506.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.231 - timing_s/reshard:4.074 - timing_s/gen:20.539 - timing_s/reward:0.160 - timing_s/old_log_prob:7.471 - timing_s/ref:7.242 - timing_s/adv:0.021 - timing_s/update_actor:22.371 - timing_s/dump_rollout_generations:0.261 - timing_s/step:58.098 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.139 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:617883.000 - perf/time_per_step:58.098 - perf/throughput:1329.406
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/10.jsonl
step:10 - global_seqlen/min:74146.000 - global_seqlen/max:79555.000 - global_seqlen/minmax_diff:5409.000 - global_seqlen/balanced_min:76799.000 - global_seqlen/balanced_max:78221.000 - global_seqlen/mean:76986.000 - actor/entropy_loss:1.411 - training/rollout_probs_diff_max:0.989 - training/rollout_probs_diff_mean:0.045 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.014 - actor/kl_coef:0.010 - actor/pg_loss:0.092 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.242 - perf/mfu/actor:0.166 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:107.177 - actor/lr:0.000 - training/global_step:10.000 - training/epoch:0.000 - critic/score/mean:0.575 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.575 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.043 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.043 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:139.953 - response_length/max:2048.000 - response_length/min:43.000 - response_length/clip_ratio:0.001 - prompt_length/mean:461.500 - prompt_length/max:516.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.404 - timing_s/reshard:4.139 - timing_s/gen:27.204 - timing_s/reward:0.152 - timing_s/old_log_prob:7.294 - timing_s/ref:7.248 - timing_s/adv:0.022 - timing_s/update_actor:22.221 - timing_s/dump_rollout_generations:0.260 - timing_s/step:64.433 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.190 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:615888.000 - perf/time_per_step:64.433 - perf/throughput:1194.824
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/11.jsonl
step:11 - global_seqlen/min:74254.000 - global_seqlen/max:79633.000 - global_seqlen/minmax_diff:5379.000 - global_seqlen/balanced_min:75993.000 - global_seqlen/balanced_max:77427.000 - global_seqlen/mean:76172.375 - actor/entropy_loss:1.298 - training/rollout_probs_diff_max:0.982 - training/rollout_probs_diff_mean:0.045 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.014 - actor/kl_coef:0.010 - actor/pg_loss:-0.061 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.642 - perf/mfu/actor:0.166 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:107.305 - actor/lr:0.000 - training/global_step:11.000 - training/epoch:0.000 - critic/score/mean:0.573 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.573 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.038 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.038 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:135.729 - response_length/max:2048.000 - response_length/min:28.000 - response_length/clip_ratio:0.001 - prompt_length/mean:459.367 - prompt_length/max:508.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.502 - timing_s/reshard:4.165 - timing_s/gen:27.205 - timing_s/reward:0.166 - timing_s/old_log_prob:7.300 - timing_s/ref:7.104 - timing_s/adv:0.022 - timing_s/update_actor:21.985 - timing_s/dump_rollout_generations:0.260 - timing_s/step:64.080 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.196 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:609379.000 - perf/time_per_step:64.080 - perf/throughput:1188.707
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/12.jsonl
step:12 - global_seqlen/min:73646.000 - global_seqlen/max:79388.000 - global_seqlen/minmax_diff:5742.000 - global_seqlen/balanced_min:76127.000 - global_seqlen/balanced_max:77568.000 - global_seqlen/mean:76353.375 - actor/entropy_loss:1.249 - training/rollout_probs_diff_max:0.992 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.074 - actor/kl_loss:0.009 - actor/kl_coef:0.010 - actor/pg_loss:0.196 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.826 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:106.711 - actor/lr:0.000 - training/global_step:12.000 - training/epoch:0.000 - critic/score/mean:0.487 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.487 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.044 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.044 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:132.964 - response_length/max:2048.000 - response_length/min:39.000 - response_length/clip_ratio:0.001 - prompt_length/mean:463.547 - prompt_length/max:519.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.853 - timing_s/reshard:4.178 - timing_s/gen:26.580 - timing_s/reward:0.167 - timing_s/old_log_prob:7.262 - timing_s/ref:7.159 - timing_s/adv:0.022 - timing_s/update_actor:21.168 - timing_s/dump_rollout_generations:0.260 - timing_s/step:62.653 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.195 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:610827.000 - perf/time_per_step:62.653 - perf/throughput:1218.679
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/13.jsonl
step:13 - global_seqlen/min:73262.000 - global_seqlen/max:75303.000 - global_seqlen/minmax_diff:2041.000 - global_seqlen/balanced_min:74219.000 - global_seqlen/balanced_max:74220.000 - global_seqlen/mean:74219.750 - actor/entropy_loss:1.163 - training/rollout_probs_diff_max:0.861 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.012 - actor/kl_coef:0.010 - actor/pg_loss:-0.059 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.810 - perf/mfu/actor:0.167 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:108.366 - actor/lr:0.000 - training/global_step:13.000 - training/epoch:0.000 - critic/score/mean:0.555 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.555 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.017 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.017 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:120.943 - response_length/max:389.000 - response_length/min:42.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.898 - prompt_length/max:492.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.957 - timing_s/reshard:4.088 - timing_s/gen:17.567 - timing_s/reward:0.145 - timing_s/old_log_prob:7.059 - timing_s/ref:7.048 - timing_s/adv:0.020 - timing_s/update_actor:21.317 - timing_s/dump_rollout_generations:0.255 - timing_s/step:53.440 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.142 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:593758.000 - perf/time_per_step:53.440 - perf/throughput:1388.839
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/14.jsonl
step:14 - global_seqlen/min:72853.000 - global_seqlen/max:79214.000 - global_seqlen/minmax_diff:6361.000 - global_seqlen/balanced_min:74041.000 - global_seqlen/balanced_max:75524.000 - global_seqlen/mean:74461.875 - actor/entropy_loss:1.168 - training/rollout_probs_diff_max:0.874 - training/rollout_probs_diff_mean:0.045 - training/rollout_probs_diff_std:0.072 - actor/kl_loss:0.011 - actor/kl_coef:0.010 - actor/pg_loss:0.062 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.355 - perf/mfu/actor:0.162 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:108.419 - actor/lr:0.000 - training/global_step:14.000 - training/epoch:0.000 - critic/score/mean:0.526 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.526 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.051 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.051 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:122.124 - response_length/max:2048.000 - response_length/min:43.000 - response_length/clip_ratio:0.002 - prompt_length/mean:459.609 - prompt_length/max:511.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.023 - timing_s/reshard:4.103 - timing_s/gen:26.702 - timing_s/reward:0.147 - timing_s/old_log_prob:7.037 - timing_s/ref:6.873 - timing_s/adv:0.026 - timing_s/update_actor:21.989 - timing_s/dump_rollout_generations:0.256 - timing_s/step:63.063 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.037 - timing_per_token_ms/gen:0.214 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:595695.000 - perf/time_per_step:63.063 - perf/throughput:1180.760
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/15.jsonl
step:15 - global_seqlen/min:72969.000 - global_seqlen/max:79151.000 - global_seqlen/minmax_diff:6182.000 - global_seqlen/balanced_min:74669.000 - global_seqlen/balanced_max:76195.000 - global_seqlen/mean:75061.500 - actor/entropy_loss:1.122 - training/rollout_probs_diff_max:0.968 - training/rollout_probs_diff_mean:0.045 - training/rollout_probs_diff_std:0.072 - actor/kl_loss:0.021 - actor/kl_coef:0.010 - actor/pg_loss:-0.004 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.729 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:108.659 - actor/lr:0.000 - training/global_step:15.000 - training/epoch:0.000 - critic/score/mean:0.511 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.511 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.047 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.047 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:124.520 - response_length/max:2048.000 - response_length/min:27.000 - response_length/clip_ratio:0.002 - prompt_length/mean:461.898 - prompt_length/max:517.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.227 - timing_s/reshard:4.150 - timing_s/gen:26.931 - timing_s/reward:0.146 - timing_s/old_log_prob:7.063 - timing_s/ref:6.860 - timing_s/adv:0.024 - timing_s/update_actor:20.806 - timing_s/dump_rollout_generations:0.255 - timing_s/step:62.115 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.211 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:600492.000 - perf/time_per_step:62.115 - perf/throughput:1208.431
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/16.jsonl
step:16 - global_seqlen/min:71650.000 - global_seqlen/max:75897.000 - global_seqlen/minmax_diff:4247.000 - global_seqlen/balanced_min:74079.000 - global_seqlen/balanced_max:74080.000 - global_seqlen/mean:74079.125 - actor/entropy_loss:1.110 - training/rollout_probs_diff_max:0.985 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.014 - actor/kl_coef:0.010 - actor/pg_loss:-0.051 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.721 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:109.165 - actor/lr:0.000 - training/global_step:16.000 - training/epoch:0.000 - critic/score/mean:0.555 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.555 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.008 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.008 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:117.657 - response_length/max:392.000 - response_length/min:32.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.086 - prompt_length/max:509.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.669 - timing_s/reshard:4.086 - timing_s/gen:17.596 - timing_s/reward:0.142 - timing_s/old_log_prob:6.783 - timing_s/ref:6.906 - timing_s/adv:0.022 - timing_s/update_actor:20.003 - timing_s/dump_rollout_generations:0.263 - timing_s/step:51.743 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.146 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:592633.000 - perf/time_per_step:51.743 - perf/throughput:1431.681
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/17.jsonl
step:17 - global_seqlen/min:71478.000 - global_seqlen/max:75092.000 - global_seqlen/minmax_diff:3614.000 - global_seqlen/balanced_min:73369.000 - global_seqlen/balanced_max:73370.000 - global_seqlen/mean:73369.500 - actor/entropy_loss:1.073 - training/rollout_probs_diff_max:0.988 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.071 - actor/kl_loss:0.012 - actor/kl_coef:0.010 - actor/pg_loss:-0.086 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.784 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:109.593 - actor/lr:0.000 - training/global_step:17.000 - training/epoch:0.000 - critic/score/mean:0.540 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.540 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.012 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.012 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:113.270 - response_length/max:343.000 - response_length/min:27.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.930 - prompt_length/max:497.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.312 - timing_s/reshard:4.148 - timing_s/gen:17.660 - timing_s/reward:0.144 - timing_s/old_log_prob:7.125 - timing_s/ref:6.930 - timing_s/adv:0.020 - timing_s/update_actor:20.526 - timing_s/dump_rollout_generations:0.262 - timing_s/step:52.695 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.152 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:586956.000 - perf/time_per_step:52.695 - perf/throughput:1392.340
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/18.jsonl
step:18 - global_seqlen/min:72784.000 - global_seqlen/max:75881.000 - global_seqlen/minmax_diff:3097.000 - global_seqlen/balanced_min:73897.000 - global_seqlen/balanced_max:75445.000 - global_seqlen/mean:74121.000 - actor/entropy_loss:1.112 - training/rollout_probs_diff_max:0.976 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.072 - actor/kl_loss:0.013 - actor/kl_coef:0.010 - actor/pg_loss:0.069 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.654 - perf/mfu/actor:0.167 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:110.651 - actor/lr:0.000 - training/global_step:18.000 - training/epoch:0.000 - critic/score/mean:0.557 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.557 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.059 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.059 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:116.398 - response_length/max:2048.000 - response_length/min:45.000 - response_length/clip_ratio:0.001 - prompt_length/mean:462.672 - prompt_length/max:507.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.416 - timing_s/reshard:5.430 - timing_s/gen:28.051 - timing_s/reward:0.145 - timing_s/old_log_prob:7.149 - timing_s/ref:7.040 - timing_s/adv:0.022 - timing_s/update_actor:21.265 - timing_s/dump_rollout_generations:0.298 - timing_s/step:64.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.235 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:592968.000 - perf/time_per_step:64.004 - perf/throughput:1158.060
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/19.jsonl
step:19 - global_seqlen/min:72098.000 - global_seqlen/max:76519.000 - global_seqlen/minmax_diff:4421.000 - global_seqlen/balanced_min:73780.000 - global_seqlen/balanced_max:75283.000 - global_seqlen/mean:73967.875 - actor/entropy_loss:1.158 - training/rollout_probs_diff_max:0.977 - training/rollout_probs_diff_mean:0.045 - training/rollout_probs_diff_std:0.072 - actor/kl_loss:0.013 - actor/kl_coef:0.010 - actor/pg_loss:0.056 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.768 - perf/mfu/actor:0.161 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:111.065 - actor/lr:0.000 - training/global_step:19.000 - training/epoch:0.000 - critic/score/mean:0.547 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.547 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.018 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.018 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:115.655 - response_length/max:2048.000 - response_length/min:19.000 - response_length/clip_ratio:0.001 - prompt_length/mean:462.219 - prompt_length/max:540.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.061 - timing_s/reshard:4.174 - timing_s/gen:26.511 - timing_s/reward:0.143 - timing_s/old_log_prob:7.165 - timing_s/ref:6.997 - timing_s/adv:0.021 - timing_s/update_actor:22.044 - timing_s/dump_rollout_generations:0.260 - timing_s/step:63.176 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.037 - timing_per_token_ms/gen:0.224 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:591743.000 - perf/time_per_step:63.176 - perf/throughput:1170.823
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/20.jsonl
step:20 - global_seqlen/min:72002.000 - global_seqlen/max:75520.000 - global_seqlen/minmax_diff:3518.000 - global_seqlen/balanced_min:73933.000 - global_seqlen/balanced_max:73934.000 - global_seqlen/mean:73933.125 - actor/entropy_loss:1.142 - training/rollout_probs_diff_max:0.987 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.020 - actor/kl_coef:0.010 - actor/pg_loss:0.064 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.699 - perf/mfu/actor:0.164 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:111.722 - actor/lr:0.000 - training/global_step:20.000 - training/epoch:0.000 - critic/score/mean:0.596 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.596 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.012 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:115.962 - response_length/max:391.000 - response_length/min:35.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.641 - prompt_length/max:514.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.619 - timing_s/reshard:4.131 - timing_s/gen:17.977 - timing_s/reward:0.145 - timing_s/old_log_prob:7.223 - timing_s/ref:7.063 - timing_s/adv:0.020 - timing_s/update_actor:21.573 - timing_s/dump_rollout_generations:0.263 - timing_s/step:54.298 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.151 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:591465.000 - perf/time_per_step:54.298 - perf/throughput:1361.618
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/21.jsonl
step:21 - global_seqlen/min:71435.000 - global_seqlen/max:75393.000 - global_seqlen/minmax_diff:3958.000 - global_seqlen/balanced_min:73467.000 - global_seqlen/balanced_max:73468.000 - global_seqlen/mean:73467.500 - actor/entropy_loss:1.164 - training/rollout_probs_diff_max:0.997 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.014 - actor/kl_coef:0.010 - actor/pg_loss:-0.021 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.079 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:112.966 - actor/lr:0.000 - training/global_step:21.000 - training/epoch:0.000 - critic/score/mean:0.606 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.606 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.012 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:114.957 - response_length/max:444.000 - response_length/min:44.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.008 - prompt_length/max:512.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.747 - timing_s/reshard:4.222 - timing_s/gen:17.527 - timing_s/reward:0.143 - timing_s/old_log_prob:7.028 - timing_s/ref:6.901 - timing_s/adv:0.021 - timing_s/update_actor:20.508 - timing_s/dump_rollout_generations:0.262 - timing_s/step:52.419 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.149 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:587740.000 - perf/time_per_step:52.419 - perf/throughput:1401.549
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/22.jsonl
step:22 - global_seqlen/min:72768.000 - global_seqlen/max:76426.000 - global_seqlen/minmax_diff:3658.000 - global_seqlen/balanced_min:73913.000 - global_seqlen/balanced_max:75473.000 - global_seqlen/mean:74108.375 - actor/entropy_loss:1.112 - training/rollout_probs_diff_max:0.762 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.071 - actor/kl_loss:0.004 - actor/kl_coef:0.010 - actor/pg_loss:0.041 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.592 - perf/mfu/actor:0.168 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:113.716 - actor/lr:0.000 - training/global_step:22.000 - training/epoch:0.000 - critic/score/mean:0.548 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.548 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.014 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.014 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:118.433 - response_length/max:2048.000 - response_length/min:28.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.539 - prompt_length/max:526.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.214 - timing_s/reshard:7.952 - timing_s/gen:30.369 - timing_s/reward:0.144 - timing_s/old_log_prob:6.860 - timing_s/ref:6.817 - timing_s/adv:0.027 - timing_s/update_actor:21.123 - timing_s/dump_rollout_generations:0.256 - timing_s/step:65.625 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.250 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:592867.000 - perf/time_per_step:65.625 - perf/throughput:1129.274
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/23.jsonl
step:23 - global_seqlen/min:73054.000 - global_seqlen/max:75191.000 - global_seqlen/minmax_diff:2137.000 - global_seqlen/balanced_min:73823.000 - global_seqlen/balanced_max:73824.000 - global_seqlen/mean:73823.250 - actor/entropy_loss:1.095 - training/rollout_probs_diff_max:0.888 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.018 - actor/kl_coef:0.010 - actor/pg_loss:-0.066 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.770 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:115.051 - actor/lr:0.000 - training/global_step:23.000 - training/epoch:0.000 - critic/score/mean:0.563 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.563 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:115.619 - response_length/max:398.000 - response_length/min:44.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.125 - prompt_length/max:494.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.322 - timing_s/reshard:4.932 - timing_s/gen:17.812 - timing_s/reward:0.144 - timing_s/old_log_prob:6.826 - timing_s/ref:6.681 - timing_s/adv:0.019 - timing_s/update_actor:20.766 - timing_s/dump_rollout_generations:0.263 - timing_s/step:52.544 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.150 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:590586.000 - perf/time_per_step:52.544 - perf/throughput:1404.987
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/24.jsonl
step:24 - global_seqlen/min:72282.000 - global_seqlen/max:75963.000 - global_seqlen/minmax_diff:3681.000 - global_seqlen/balanced_min:74088.000 - global_seqlen/balanced_max:74089.000 - global_seqlen/mean:74088.250 - actor/entropy_loss:1.126 - training/rollout_probs_diff_max:0.895 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.074 - actor/kl_loss:0.021 - actor/kl_coef:0.010 - actor/pg_loss:-0.034 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.030 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:49.814 - perf/cpu_memory_used_gb:116.080 - actor/lr:0.000 - training/global_step:24.000 - training/epoch:0.000 - critic/score/mean:0.490 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.490 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:116.479 - response_length/max:346.000 - response_length/min:41.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.336 - prompt_length/max:533.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.117 - timing_s/reshard:8.729 - timing_s/gen:21.428 - timing_s/reward:0.143 - timing_s/old_log_prob:6.965 - timing_s/ref:6.753 - timing_s/adv:0.020 - timing_s/update_actor:20.560 - timing_s/dump_rollout_generations:0.262 - timing_s/step:56.165 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.180 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:592706.000 - perf/time_per_step:56.165 - perf/throughput:1319.129
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/25.jsonl
step:25 - global_seqlen/min:72704.000 - global_seqlen/max:76801.000 - global_seqlen/minmax_diff:4097.000 - global_seqlen/balanced_min:74051.000 - global_seqlen/balanced_max:75619.000 - global_seqlen/mean:74289.375 - actor/entropy_loss:1.149 - training/rollout_probs_diff_max:0.992 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.037 - actor/kl_coef:0.010 - actor/pg_loss:0.137 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.622 - perf/mfu/actor:0.167 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:50.010 - perf/cpu_memory_used_gb:115.915 - actor/lr:0.000 - training/global_step:25.000 - training/epoch:0.000 - critic/score/mean:0.546 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.546 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.028 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.028 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:119.464 - response_length/max:2048.000 - response_length/min:40.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.922 - prompt_length/max:494.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.414 - timing_s/reshard:6.897 - timing_s/gen:28.862 - timing_s/reward:0.146 - timing_s/old_log_prob:7.300 - timing_s/ref:7.284 - timing_s/adv:0.021 - timing_s/update_actor:21.400 - timing_s/dump_rollout_generations:0.254 - timing_s/step:65.297 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.236 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:594315.000 - perf/time_per_step:65.297 - perf/throughput:1137.722
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/26.jsonl
step:26 - global_seqlen/min:72902.000 - global_seqlen/max:75829.000 - global_seqlen/minmax_diff:2927.000 - global_seqlen/balanced_min:73781.000 - global_seqlen/balanced_max:75385.000 - global_seqlen/mean:74182.875 - actor/entropy_loss:1.089 - training/rollout_probs_diff_max:0.766 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.028 - actor/kl_coef:0.010 - actor/pg_loss:0.099 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.641 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:50.010 - perf/cpu_memory_used_gb:116.360 - actor/lr:0.000 - training/global_step:26.000 - training/epoch:0.000 - critic/score/mean:0.555 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.555 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.074 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.074 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:118.812 - response_length/max:2048.000 - response_length/min:49.000 - response_length/clip_ratio:0.002 - prompt_length/mean:460.742 - prompt_length/max:526.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.723 - timing_s/reshard:7.591 - timing_s/gen:30.501 - timing_s/reward:0.144 - timing_s/old_log_prob:7.295 - timing_s/ref:7.254 - timing_s/adv:0.021 - timing_s/update_actor:20.827 - timing_s/dump_rollout_generations:0.260 - timing_s/step:66.334 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.251 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:593463.000 - perf/time_per_step:66.334 - perf/throughput:1118.331
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/27.jsonl
step:27 - global_seqlen/min:73192.000 - global_seqlen/max:75708.000 - global_seqlen/minmax_diff:2516.000 - global_seqlen/balanced_min:74465.000 - global_seqlen/balanced_max:74466.000 - global_seqlen/mean:74465.750 - actor/entropy_loss:1.134 - training/rollout_probs_diff_max:0.993 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.021 - actor/kl_coef:0.010 - actor/pg_loss:-0.035 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.031 - perf/mfu/actor:0.167 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:50.010 - perf/cpu_memory_used_gb:117.298 - actor/lr:0.000 - training/global_step:27.000 - training/epoch:0.000 - critic/score/mean:0.547 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.547 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.011 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:120.607 - response_length/max:446.000 - response_length/min:35.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.156 - prompt_length/max:497.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.100 - timing_s/reshard:4.076 - timing_s/gen:17.718 - timing_s/reward:0.146 - timing_s/old_log_prob:7.254 - timing_s/ref:7.030 - timing_s/adv:0.019 - timing_s/update_actor:21.471 - timing_s/dump_rollout_generations:0.257 - timing_s/step:53.929 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.143 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:595726.000 - perf/time_per_step:53.929 - perf/throughput:1380.810
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/28.jsonl
step:28 - global_seqlen/min:72254.000 - global_seqlen/max:76467.000 - global_seqlen/minmax_diff:4213.000 - global_seqlen/balanced_min:73788.000 - global_seqlen/balanced_max:75372.000 - global_seqlen/mean:73986.500 - actor/entropy_loss:1.061 - training/rollout_probs_diff_max:0.886 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.026 - actor/kl_coef:0.010 - actor/pg_loss:0.128 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.218 - perf/mfu/actor:0.163 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:50.010 - perf/cpu_memory_used_gb:116.347 - actor/lr:0.000 - training/global_step:28.000 - training/epoch:0.000 - critic/score/mean:0.607 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.607 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.047 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.047 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:119.746 - response_length/max:2048.000 - response_length/min:35.000 - response_length/clip_ratio:0.001 - prompt_length/mean:458.273 - prompt_length/max:495.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.816 - timing_s/reshard:7.410 - timing_s/gen:30.580 - timing_s/reward:0.143 - timing_s/old_log_prob:6.965 - timing_s/ref:6.868 - timing_s/adv:0.024 - timing_s/update_actor:21.784 - timing_s/dump_rollout_generations:0.261 - timing_s/step:66.654 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.037 - timing_per_token_ms/gen:0.249 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:591892.000 - perf/time_per_step:66.654 - perf/throughput:1110.007
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/29.jsonl
step:29 - global_seqlen/min:72591.000 - global_seqlen/max:75755.000 - global_seqlen/minmax_diff:3164.000 - global_seqlen/balanced_min:74053.000 - global_seqlen/balanced_max:75527.000 - global_seqlen/mean:74386.000 - actor/entropy_loss:1.049 - training/rollout_probs_diff_max:0.987 - training/rollout_probs_diff_mean:0.045 - training/rollout_probs_diff_std:0.072 - actor/kl_loss:0.036 - actor/kl_coef:0.010 - actor/pg_loss:0.130 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.679 - perf/mfu/actor:0.163 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:50.010 - perf/cpu_memory_used_gb:116.451 - actor/lr:0.000 - training/global_step:29.000 - training/epoch:0.000 - critic/score/mean:0.459 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.459 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.085 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.085 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:120.188 - response_length/max:2048.000 - response_length/min:30.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.953 - prompt_length/max:502.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:20.330 - timing_s/reshard:4.135 - timing_s/gen:25.744 - timing_s/reward:0.146 - timing_s/old_log_prob:7.181 - timing_s/ref:6.967 - timing_s/adv:0.022 - timing_s/update_actor:22.029 - timing_s/dump_rollout_generations:0.258 - timing_s/step:62.381 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.037 - timing_per_token_ms/gen:0.209 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:595088.000 - perf/time_per_step:62.381 - perf/throughput:1192.439
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/30.jsonl
step:30 - global_seqlen/min:72075.000 - global_seqlen/max:75160.000 - global_seqlen/minmax_diff:3085.000 - global_seqlen/balanced_min:73683.000 - global_seqlen/balanced_max:73684.000 - global_seqlen/mean:73683.500 - actor/entropy_loss:1.079 - training/rollout_probs_diff_max:0.893 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.074 - actor/kl_loss:0.017 - actor/kl_coef:0.010 - actor/pg_loss:0.097 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.215 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:50.010 - perf/cpu_memory_used_gb:116.825 - actor/lr:0.000 - training/global_step:30.000 - training/epoch:0.000 - critic/score/mean:0.503 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.503 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:116.035 - response_length/max:335.000 - response_length/min:42.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.617 - prompt_length/max:506.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:11.700 - timing_s/reshard:4.046 - timing_s/gen:16.292 - timing_s/reward:0.141 - timing_s/old_log_prob:6.996 - timing_s/ref:6.870 - timing_s/adv:0.020 - timing_s/update_actor:20.442 - timing_s/dump_rollout_generations:0.261 - timing_s/step:51.053 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.137 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:589468.000 - perf/time_per_step:51.053 - perf/throughput:1443.281
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/31.jsonl
step:31 - global_seqlen/min:73289.000 - global_seqlen/max:76362.000 - global_seqlen/minmax_diff:3073.000 - global_seqlen/balanced_min:74268.000 - global_seqlen/balanced_max:74269.000 - global_seqlen/mean:74268.375 - actor/entropy_loss:1.100 - training/rollout_probs_diff_max:0.748 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.028 - actor/kl_coef:0.010 - actor/pg_loss:0.041 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.788 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:50.010 - perf/cpu_memory_used_gb:116.796 - actor/lr:0.000 - training/global_step:31.000 - training/epoch:0.000 - critic/score/mean:0.553 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.553 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.013 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.013 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:119.120 - response_length/max:453.000 - response_length/min:38.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.102 - prompt_length/max:521.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.688 - timing_s/reshard:7.100 - timing_s/gen:20.352 - timing_s/reward:0.168 - timing_s/old_log_prob:6.984 - timing_s/ref:6.891 - timing_s/adv:0.020 - timing_s/update_actor:20.951 - timing_s/dump_rollout_generations:0.257 - timing_s/step:55.658 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.167 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:594147.000 - perf/time_per_step:55.658 - perf/throughput:1334.382
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/32.jsonl
step:32 - global_seqlen/min:72948.000 - global_seqlen/max:77116.000 - global_seqlen/minmax_diff:4168.000 - global_seqlen/balanced_min:73780.000 - global_seqlen/balanced_max:75204.000 - global_seqlen/mean:74313.875 - actor/entropy_loss:1.065 - training/rollout_probs_diff_max:0.995 - training/rollout_probs_diff_mean:0.045 - training/rollout_probs_diff_std:0.072 - actor/kl_loss:0.021 - actor/kl_coef:0.010 - actor/pg_loss:0.077 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.613 - perf/mfu/actor:0.166 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:50.010 - perf/cpu_memory_used_gb:117.367 - actor/lr:0.000 - training/global_step:32.000 - training/epoch:0.000 - critic/score/mean:0.584 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.584 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.119 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.119 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:122.077 - response_length/max:2048.000 - response_length/min:27.000 - response_length/clip_ratio:0.003 - prompt_length/mean:458.500 - prompt_length/max:504.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.266 - timing_s/reshard:8.453 - timing_s/gen:30.979 - timing_s/reward:0.144 - timing_s/old_log_prob:7.045 - timing_s/ref:6.963 - timing_s/adv:0.037 - timing_s/update_actor:21.513 - timing_s/dump_rollout_generations:0.258 - timing_s/step:66.970 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.248 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:594511.000 - perf/time_per_step:66.970 - perf/throughput:1109.667
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/33.jsonl
step:33 - global_seqlen/min:72681.000 - global_seqlen/max:75550.000 - global_seqlen/minmax_diff:2869.000 - global_seqlen/balanced_min:73946.000 - global_seqlen/balanced_max:73947.000 - global_seqlen/mean:73946.750 - actor/entropy_loss:1.037 - training/rollout_probs_diff_max:0.895 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.074 - actor/kl_loss:0.033 - actor/kl_coef:0.010 - actor/pg_loss:0.033 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.505 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:50.010 - perf/cpu_memory_used_gb:117.036 - actor/lr:0.000 - training/global_step:33.000 - training/epoch:0.000 - critic/score/mean:0.565 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.565 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:117.209 - response_length/max:331.000 - response_length/min:45.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.500 - prompt_length/max:499.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.061 - timing_s/reshard:4.122 - timing_s/gen:16.710 - timing_s/reward:0.144 - timing_s/old_log_prob:7.083 - timing_s/ref:6.968 - timing_s/adv:0.019 - timing_s/update_actor:20.708 - timing_s/dump_rollout_generations:0.255 - timing_s/step:51.920 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.139 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:591574.000 - perf/time_per_step:51.920 - perf/throughput:1424.244
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/34.jsonl
step:34 - global_seqlen/min:73495.000 - global_seqlen/max:75995.000 - global_seqlen/minmax_diff:2500.000 - global_seqlen/balanced_min:74881.000 - global_seqlen/balanced_max:74882.000 - global_seqlen/mean:74881.875 - actor/entropy_loss:1.059 - training/rollout_probs_diff_max:0.967 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.074 - actor/kl_loss:0.017 - actor/kl_coef:0.010 - actor/pg_loss:0.034 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.032 - perf/mfu/actor:0.169 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:50.010 - perf/cpu_memory_used_gb:117.462 - actor/lr:0.000 - training/global_step:34.000 - training/epoch:0.000 - critic/score/mean:0.553 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.553 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.014 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.014 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:121.772 - response_length/max:341.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:463.242 - prompt_length/max:516.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.164 - timing_s/reshard:8.601 - timing_s/gen:21.306 - timing_s/reward:0.145 - timing_s/old_log_prob:7.224 - timing_s/ref:6.993 - timing_s/adv:0.020 - timing_s/update_actor:21.309 - timing_s/dump_rollout_generations:0.257 - timing_s/step:57.281 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.171 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:599055.000 - perf/time_per_step:57.281 - perf/throughput:1307.270
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/35.jsonl
step:35 - global_seqlen/min:73138.000 - global_seqlen/max:78825.000 - global_seqlen/minmax_diff:5687.000 - global_seqlen/balanced_min:75078.000 - global_seqlen/balanced_max:75079.000 - global_seqlen/mean:75078.375 - actor/entropy_loss:1.079 - training/rollout_probs_diff_max:0.832 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.021 - actor/kl_coef:0.010 - actor/pg_loss:0.017 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.606 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:50.010 - perf/cpu_memory_used_gb:117.379 - actor/lr:0.000 - training/global_step:35.000 - training/epoch:0.000 - critic/score/mean:0.480 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.480 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:124.308 - response_length/max:371.000 - response_length/min:42.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.242 - prompt_length/max:519.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.778 - timing_s/reshard:7.874 - timing_s/gen:21.255 - timing_s/reward:0.146 - timing_s/old_log_prob:7.081 - timing_s/ref:7.068 - timing_s/adv:0.025 - timing_s/update_actor:20.440 - timing_s/dump_rollout_generations:0.257 - timing_s/step:56.306 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.167 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:600627.000 - perf/time_per_step:56.306 - perf/throughput:1333.389
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/36.jsonl
step:36 - global_seqlen/min:72478.000 - global_seqlen/max:76015.000 - global_seqlen/minmax_diff:3537.000 - global_seqlen/balanced_min:74332.000 - global_seqlen/balanced_max:74333.000 - global_seqlen/mean:74332.750 - actor/entropy_loss:1.069 - training/rollout_probs_diff_max:0.993 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.074 - actor/kl_loss:0.018 - actor/kl_coef:0.010 - actor/pg_loss:0.078 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.577 - perf/mfu/actor:0.163 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:50.010 - perf/cpu_memory_used_gb:117.688 - actor/lr:0.000 - training/global_step:36.000 - training/epoch:0.000 - critic/score/mean:0.593 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.593 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:120.623 - response_length/max:387.000 - response_length/min:41.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.102 - prompt_length/max:507.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.872 - timing_s/reshard:4.126 - timing_s/gen:17.545 - timing_s/reward:0.144 - timing_s/old_log_prob:7.148 - timing_s/ref:7.033 - timing_s/adv:0.019 - timing_s/update_actor:21.877 - timing_s/dump_rollout_generations:0.259 - timing_s/step:54.053 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.037 - timing_per_token_ms/gen:0.142 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:594662.000 - perf/time_per_step:54.053 - perf/throughput:1375.188
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/37.jsonl
step:37 - global_seqlen/min:72664.000 - global_seqlen/max:76100.000 - global_seqlen/minmax_diff:3436.000 - global_seqlen/balanced_min:74565.000 - global_seqlen/balanced_max:74566.000 - global_seqlen/mean:74565.375 - actor/entropy_loss:1.068 - training/rollout_probs_diff_max:0.903 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.074 - actor/kl_loss:0.024 - actor/kl_coef:0.010 - actor/pg_loss:-0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.571 - perf/mfu/actor:0.163 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:50.010 - perf/cpu_memory_used_gb:118.742 - actor/lr:0.000 - training/global_step:37.000 - training/epoch:0.000 - critic/score/mean:0.575 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.575 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:121.995 - response_length/max:377.000 - response_length/min:42.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.547 - prompt_length/max:508.000 - prompt_length/min:436.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.396 - timing_s/reshard:4.092 - timing_s/gen:17.745 - timing_s/reward:0.146 - timing_s/old_log_prob:7.171 - timing_s/ref:6.969 - timing_s/adv:0.020 - timing_s/update_actor:21.920 - timing_s/dump_rollout_generations:0.256 - timing_s/step:54.263 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.037 - timing_per_token_ms/gen:0.142 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:596523.000 - perf/time_per_step:54.263 - perf/throughput:1374.147
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/38.jsonl
step:38 - global_seqlen/min:73290.000 - global_seqlen/max:75618.000 - global_seqlen/minmax_diff:2328.000 - global_seqlen/balanced_min:74090.000 - global_seqlen/balanced_max:74091.000 - global_seqlen/mean:74090.125 - actor/entropy_loss:1.049 - training/rollout_probs_diff_max:0.962 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.075 - actor/kl_loss:0.028 - actor/kl_coef:0.010 - actor/pg_loss:0.043 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.562 - perf/mfu/actor:0.166 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:50.010 - perf/cpu_memory_used_gb:119.125 - actor/lr:0.000 - training/global_step:38.000 - training/epoch:0.000 - critic/score/mean:0.557 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.557 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:118.431 - response_length/max:359.000 - response_length/min:45.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.398 - prompt_length/max:508.000 - prompt_length/min:436.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.267 - timing_s/reshard:4.079 - timing_s/gen:17.614 - timing_s/reward:0.145 - timing_s/old_log_prob:6.985 - timing_s/ref:6.946 - timing_s/adv:0.021 - timing_s/update_actor:21.491 - timing_s/dump_rollout_generations:0.263 - timing_s/step:53.499 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.145 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:592721.000 - perf/time_per_step:53.499 - perf/throughput:1384.895
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/39.jsonl
step:39 - global_seqlen/min:73527.000 - global_seqlen/max:76147.000 - global_seqlen/minmax_diff:2620.000 - global_seqlen/balanced_min:74494.000 - global_seqlen/balanced_max:74494.000 - global_seqlen/mean:74494.000 - actor/entropy_loss:1.086 - training/rollout_probs_diff_max:0.962 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.074 - actor/kl_loss:0.023 - actor/kl_coef:0.010 - actor/pg_loss:-0.035 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.753 - perf/mfu/actor:0.182 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:50.010 - perf/cpu_memory_used_gb:119.360 - actor/lr:0.000 - training/global_step:39.000 - training/epoch:0.000 - critic/score/mean:0.569 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.569 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.010 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:121.727 - response_length/max:343.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.258 - prompt_length/max:522.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.087 - timing_s/reshard:5.188 - timing_s/gen:17.836 - timing_s/reward:0.145 - timing_s/old_log_prob:7.100 - timing_s/ref:6.868 - timing_s/adv:0.021 - timing_s/update_actor:19.677 - timing_s/dump_rollout_generations:0.257 - timing_s/step:51.933 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.143 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:595952.000 - perf/time_per_step:51.933 - perf/throughput:1434.435
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/40.jsonl
local_global_step_folder: ../ckpt/checkpoints/global_step_40
step:40 - global_seqlen/min:70484.000 - global_seqlen/max:77058.000 - global_seqlen/minmax_diff:6574.000 - global_seqlen/balanced_min:74138.000 - global_seqlen/balanced_max:74139.000 - global_seqlen/mean:74138.625 - actor/entropy_loss:1.063 - training/rollout_probs_diff_max:0.930 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.074 - actor/kl_loss:0.027 - actor/kl_coef:0.010 - actor/pg_loss:-0.083 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.229 - perf/mfu/actor:0.169 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:50.010 - perf/cpu_memory_used_gb:119.816 - actor/lr:0.000 - training/global_step:40.000 - training/epoch:0.000 - critic/score/mean:0.511 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.511 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.000 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:119.661 - response_length/max:348.000 - response_length/min:42.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.547 - prompt_length/max:512.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.251 - timing_s/reshard:6.744 - timing_s/gen:19.573 - timing_s/reward:0.142 - timing_s/old_log_prob:6.852 - timing_s/ref:6.869 - timing_s/adv:0.021 - timing_s/update_actor:21.080 - timing_s/dump_rollout_generations:0.262 - timing_s/save_checkpoint:28.643 - timing_s/step:83.473 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.160 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:593109.000 - perf/time_per_step:83.473 - perf/throughput:888.177
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/41.jsonl
step:41 - global_seqlen/min:72374.000 - global_seqlen/max:75287.000 - global_seqlen/minmax_diff:2913.000 - global_seqlen/balanced_min:73974.000 - global_seqlen/balanced_max:73975.000 - global_seqlen/mean:73974.625 - actor/entropy_loss:1.073 - training/rollout_probs_diff_max:0.813 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.074 - actor/kl_loss:0.022 - actor/kl_coef:0.010 - actor/pg_loss:0.036 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.748 - perf/mfu/actor:0.163 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:127.225 - actor/lr:0.000 - training/global_step:41.000 - training/epoch:0.000 - critic/score/mean:0.568 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.568 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.007 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.007 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:118.028 - response_length/max:351.000 - response_length/min:37.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.898 - prompt_length/max:490.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.908 - timing_s/reshard:4.352 - timing_s/gen:18.785 - timing_s/reward:0.142 - timing_s/old_log_prob:7.140 - timing_s/ref:7.052 - timing_s/adv:0.018 - timing_s/update_actor:21.707 - timing_s/dump_rollout_generations:0.265 - timing_s/step:55.135 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.037 - timing_per_token_ms/gen:0.155 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:591797.000 - perf/time_per_step:55.135 - perf/throughput:1341.699
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/42.jsonl
step:42 - global_seqlen/min:74091.000 - global_seqlen/max:77191.000 - global_seqlen/minmax_diff:3100.000 - global_seqlen/balanced_min:75073.000 - global_seqlen/balanced_max:76668.000 - global_seqlen/mean:75280.125 - actor/entropy_loss:1.085 - training/rollout_probs_diff_max:0.930 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.075 - actor/kl_loss:0.028 - actor/kl_coef:0.010 - actor/pg_loss:0.039 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.758 - perf/mfu/actor:0.166 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:119.590 - actor/lr:0.000 - training/global_step:42.000 - training/epoch:0.000 - critic/score/mean:0.507 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.507 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.029 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.029 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:125.071 - response_length/max:2048.000 - response_length/min:37.000 - response_length/clip_ratio:0.001 - prompt_length/mean:463.055 - prompt_length/max:505.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.241 - timing_s/reshard:4.151 - timing_s/gen:25.943 - timing_s/reward:0.171 - timing_s/old_log_prob:7.397 - timing_s/ref:7.176 - timing_s/adv:0.025 - timing_s/update_actor:21.888 - timing_s/dump_rollout_generations:0.260 - timing_s/step:62.896 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.203 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:602241.000 - perf/time_per_step:62.896 - perf/throughput:1196.902
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/43.jsonl
step:43 - global_seqlen/min:72559.000 - global_seqlen/max:75607.000 - global_seqlen/minmax_diff:3048.000 - global_seqlen/balanced_min:74552.000 - global_seqlen/balanced_max:74553.000 - global_seqlen/mean:74552.500 - actor/entropy_loss:1.090 - training/rollout_probs_diff_max:0.870 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.021 - actor/kl_coef:0.010 - actor/pg_loss:0.052 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.531 - perf/mfu/actor:0.165 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:119.376 - actor/lr:0.000 - training/global_step:43.000 - training/epoch:0.000 - critic/score/mean:0.547 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.547 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.009 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:121.668 - response_length/max:375.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.773 - prompt_length/max:509.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.054 - timing_s/reshard:4.073 - timing_s/gen:17.664 - timing_s/reward:0.145 - timing_s/old_log_prob:7.139 - timing_s/ref:6.886 - timing_s/adv:0.019 - timing_s/update_actor:21.673 - timing_s/dump_rollout_generations:0.255 - timing_s/step:53.809 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.142 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:596420.000 - perf/time_per_step:53.809 - perf/throughput:1385.496
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/44.jsonl
step:44 - global_seqlen/min:73058.000 - global_seqlen/max:75707.000 - global_seqlen/minmax_diff:2649.000 - global_seqlen/balanced_min:74376.000 - global_seqlen/balanced_max:74500.000 - global_seqlen/mean:74391.500 - actor/entropy_loss:1.156 - training/rollout_probs_diff_max:0.985 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.075 - actor/kl_loss:0.069 - actor/kl_coef:0.010 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.656 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:119.636 - actor/lr:0.000 - training/global_step:44.000 - training/epoch:0.000 - critic/score/mean:0.584 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.584 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:119.887 - response_length/max:595.000 - response_length/min:31.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.297 - prompt_length/max:531.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.638 - timing_s/reshard:4.094 - timing_s/gen:18.975 - timing_s/reward:0.147 - timing_s/old_log_prob:7.055 - timing_s/ref:6.861 - timing_s/adv:0.026 - timing_s/update_actor:20.487 - timing_s/dump_rollout_generations:0.257 - timing_s/step:53.845 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.155 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:595132.000 - perf/time_per_step:53.845 - perf/throughput:1381.582
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/45.jsonl
step:45 - global_seqlen/min:72550.000 - global_seqlen/max:76110.000 - global_seqlen/minmax_diff:3560.000 - global_seqlen/balanced_min:73877.000 - global_seqlen/balanced_max:73878.000 - global_seqlen/mean:73877.250 - actor/entropy_loss:1.122 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.015 - actor/kl_coef:0.010 - actor/pg_loss:-0.021 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.618 - perf/mfu/actor:0.165 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:119.352 - actor/lr:0.000 - training/global_step:45.000 - training/epoch:0.000 - critic/score/mean:0.647 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.647 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:117.846 - response_length/max:436.000 - response_length/min:30.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.320 - prompt_length/max:519.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.272 - timing_s/reshard:4.174 - timing_s/gen:17.985 - timing_s/reward:0.171 - timing_s/old_log_prob:7.107 - timing_s/ref:6.969 - timing_s/adv:0.021 - timing_s/update_actor:21.447 - timing_s/dump_rollout_generations:0.260 - timing_s/step:53.992 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.149 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:591018.000 - perf/time_per_step:53.992 - perf/throughput:1368.305
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/46.jsonl
step:46 - global_seqlen/min:73710.000 - global_seqlen/max:75901.000 - global_seqlen/minmax_diff:2191.000 - global_seqlen/balanced_min:75155.000 - global_seqlen/balanced_max:75156.000 - global_seqlen/mean:75155.625 - actor/entropy_loss:1.133 - training/rollout_probs_diff_max:0.918 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.020 - actor/kl_coef:0.010 - actor/pg_loss:-0.017 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.531 - perf/mfu/actor:0.167 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:119.443 - actor/lr:0.000 - training/global_step:46.000 - training/epoch:0.000 - critic/score/mean:0.581 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.581 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.000 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:125.505 - response_length/max:343.000 - response_length/min:39.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.648 - prompt_length/max:508.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.284 - timing_s/reshard:6.680 - timing_s/gen:19.499 - timing_s/reward:0.146 - timing_s/old_log_prob:6.968 - timing_s/ref:6.818 - timing_s/adv:0.021 - timing_s/update_actor:21.614 - timing_s/dump_rollout_generations:0.287 - timing_s/step:55.382 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.152 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:601245.000 - perf/time_per_step:55.382 - perf/throughput:1357.035
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/47.jsonl
step:47 - global_seqlen/min:73462.000 - global_seqlen/max:77750.000 - global_seqlen/minmax_diff:4288.000 - global_seqlen/balanced_min:75211.000 - global_seqlen/balanced_max:75486.000 - global_seqlen/mean:75245.750 - actor/entropy_loss:1.072 - training/rollout_probs_diff_max:0.890 - training/rollout_probs_diff_mean:0.050 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.051 - actor/kl_coef:0.010 - actor/pg_loss:-0.047 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.549 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:119.568 - actor/lr:0.000 - training/global_step:47.000 - training/epoch:0.000 - critic/score/mean:0.543 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.543 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:126.264 - response_length/max:697.000 - response_length/min:45.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.594 - prompt_length/max:505.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.128 - timing_s/reshard:8.827 - timing_s/gen:23.522 - timing_s/reward:0.143 - timing_s/old_log_prob:7.032 - timing_s/ref:6.919 - timing_s/adv:0.021 - timing_s/update_actor:21.126 - timing_s/dump_rollout_generations:0.256 - timing_s/step:59.051 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.182 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:601966.000 - perf/time_per_step:59.051 - perf/throughput:1274.257
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/48.jsonl
step:48 - global_seqlen/min:72960.000 - global_seqlen/max:77927.000 - global_seqlen/minmax_diff:4967.000 - global_seqlen/balanced_min:75010.000 - global_seqlen/balanced_max:75011.000 - global_seqlen/mean:75010.125 - actor/entropy_loss:1.129 - training/rollout_probs_diff_max:0.986 - training/rollout_probs_diff_mean:0.050 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.035 - actor/kl_coef:0.010 - actor/pg_loss:0.045 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.769 - perf/mfu/actor:0.180 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:119.676 - actor/lr:0.000 - training/global_step:48.000 - training/epoch:0.000 - critic/score/mean:0.596 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.596 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:125.681 - response_length/max:373.000 - response_length/min:31.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.336 - prompt_length/max:502.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.429 - timing_s/reshard:7.914 - timing_s/gen:20.910 - timing_s/reward:0.146 - timing_s/old_log_prob:7.063 - timing_s/ref:6.958 - timing_s/adv:0.019 - timing_s/update_actor:20.002 - timing_s/dump_rollout_generations:0.260 - timing_s/step:55.398 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.162 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:600081.000 - perf/time_per_step:55.398 - perf/throughput:1354.030
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/49.jsonl
step:49 - global_seqlen/min:73592.000 - global_seqlen/max:77448.000 - global_seqlen/minmax_diff:3856.000 - global_seqlen/balanced_min:74765.000 - global_seqlen/balanced_max:74766.000 - global_seqlen/mean:74765.625 - actor/entropy_loss:1.151 - training/rollout_probs_diff_max:0.994 - training/rollout_probs_diff_mean:0.050 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.041 - actor/kl_coef:0.010 - actor/pg_loss:-0.036 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.553 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:119.626 - actor/lr:0.000 - training/global_step:49.000 - training/epoch:0.000 - critic/score/mean:0.542 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.542 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:124.966 - response_length/max:388.000 - response_length/min:46.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.141 - prompt_length/max:493.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.726 - timing_s/reshard:4.988 - timing_s/gen:18.272 - timing_s/reward:0.146 - timing_s/old_log_prob:7.229 - timing_s/ref:7.068 - timing_s/adv:0.019 - timing_s/update_actor:21.032 - timing_s/dump_rollout_generations:0.257 - timing_s/step:54.053 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.143 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:598125.000 - perf/time_per_step:54.053 - perf/throughput:1383.190
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/50.jsonl
step:50 - global_seqlen/min:72551.000 - global_seqlen/max:76662.000 - global_seqlen/minmax_diff:4111.000 - global_seqlen/balanced_min:74851.000 - global_seqlen/balanced_max:74852.000 - global_seqlen/mean:74851.375 - actor/entropy_loss:1.111 - training/rollout_probs_diff_max:0.971 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.075 - actor/kl_loss:0.036 - actor/kl_coef:0.010 - actor/pg_loss:0.011 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.524 - perf/mfu/actor:0.165 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:119.784 - actor/lr:0.000 - training/global_step:50.000 - training/epoch:0.000 - critic/score/mean:0.576 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.576 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.000 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:125.315 - response_length/max:345.000 - response_length/min:33.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.461 - prompt_length/max:505.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.615 - timing_s/reshard:4.048 - timing_s/gen:17.901 - timing_s/reward:0.142 - timing_s/old_log_prob:7.337 - timing_s/ref:7.134 - timing_s/adv:0.019 - timing_s/update_actor:21.813 - timing_s/dump_rollout_generations:0.259 - timing_s/step:54.634 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.140 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:598811.000 - perf/time_per_step:54.634 - perf/throughput:1370.048
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/51.jsonl
step:51 - global_seqlen/min:73658.000 - global_seqlen/max:76664.000 - global_seqlen/minmax_diff:3006.000 - global_seqlen/balanced_min:75393.000 - global_seqlen/balanced_max:75713.000 - global_seqlen/mean:75433.000 - actor/entropy_loss:1.153 - training/rollout_probs_diff_max:0.892 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.034 - actor/kl_coef:0.010 - actor/pg_loss:0.064 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.611 - perf/mfu/actor:0.165 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:119.995 - actor/lr:0.000 - training/global_step:51.000 - training/epoch:0.000 - critic/score/mean:0.638 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.638 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.000 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:128.406 - response_length/max:838.000 - response_length/min:32.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.914 - prompt_length/max:514.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.001 - timing_s/reshard:4.085 - timing_s/gen:20.349 - timing_s/reward:0.170 - timing_s/old_log_prob:7.103 - timing_s/ref:7.008 - timing_s/adv:0.019 - timing_s/update_actor:21.969 - timing_s/dump_rollout_generations:0.263 - timing_s/step:56.911 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.155 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:603464.000 - perf/time_per_step:56.911 - perf/throughput:1325.445
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/52.jsonl
step:52 - global_seqlen/min:75373.000 - global_seqlen/max:78000.000 - global_seqlen/minmax_diff:2627.000 - global_seqlen/balanced_min:76032.000 - global_seqlen/balanced_max:76033.000 - global_seqlen/mean:76032.375 - actor/entropy_loss:1.167 - training/rollout_probs_diff_max:0.907 - training/rollout_probs_diff_mean:0.050 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.024 - actor/kl_coef:0.010 - actor/pg_loss:-0.015 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.590 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:120.184 - actor/lr:0.000 - training/global_step:52.000 - training/epoch:0.000 - critic/score/mean:0.599 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.599 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.013 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.013 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:134.104 - response_length/max:405.000 - response_length/min:39.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.898 - prompt_length/max:521.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.460 - timing_s/reshard:4.106 - timing_s/gen:17.108 - timing_s/reward:0.144 - timing_s/old_log_prob:7.224 - timing_s/ref:7.096 - timing_s/adv:0.020 - timing_s/update_actor:21.531 - timing_s/dump_rollout_generations:0.264 - timing_s/step:53.422 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:608259.000 - perf/time_per_step:53.422 - perf/throughput:1423.248
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/53.jsonl
step:53 - global_seqlen/min:73001.000 - global_seqlen/max:78715.000 - global_seqlen/minmax_diff:5714.000 - global_seqlen/balanced_min:76413.000 - global_seqlen/balanced_max:76414.000 - global_seqlen/mean:76413.500 - actor/entropy_loss:1.172 - training/rollout_probs_diff_max:0.955 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.037 - actor/kl_coef:0.010 - actor/pg_loss:0.031 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.342 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:120.050 - actor/lr:0.000 - training/global_step:53.000 - training/epoch:0.000 - critic/score/mean:0.566 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.566 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:136.402 - response_length/max:370.000 - response_length/min:51.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.578 - prompt_length/max:514.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.434 - timing_s/reshard:6.353 - timing_s/gen:19.343 - timing_s/reward:0.164 - timing_s/old_log_prob:7.169 - timing_s/ref:6.983 - timing_s/adv:0.021 - timing_s/update_actor:21.334 - timing_s/dump_rollout_generations:0.256 - timing_s/step:55.307 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.138 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:611308.000 - perf/time_per_step:55.307 - perf/throughput:1381.628
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/54.jsonl
step:54 - global_seqlen/min:73898.000 - global_seqlen/max:79042.000 - global_seqlen/minmax_diff:5144.000 - global_seqlen/balanced_min:76283.000 - global_seqlen/balanced_max:77798.000 - global_seqlen/mean:76473.000 - actor/entropy_loss:1.148 - training/rollout_probs_diff_max:0.980 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.044 - actor/kl_coef:0.010 - actor/pg_loss:0.050 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.840 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:120.104 - actor/lr:0.000 - training/global_step:54.000 - training/epoch:0.000 - critic/score/mean:0.634 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.634 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.016 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.016 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:138.047 - response_length/max:2048.000 - response_length/min:35.000 - response_length/clip_ratio:0.001 - prompt_length/mean:459.398 - prompt_length/max:499.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.661 - timing_s/reshard:8.198 - timing_s/gen:31.097 - timing_s/reward:0.142 - timing_s/old_log_prob:7.052 - timing_s/ref:7.024 - timing_s/adv:0.022 - timing_s/update_actor:21.529 - timing_s/dump_rollout_generations:0.262 - timing_s/step:67.159 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.220 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:611784.000 - perf/time_per_step:67.159 - perf/throughput:1138.690
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/55.jsonl
step:55 - global_seqlen/min:76040.000 - global_seqlen/max:79078.000 - global_seqlen/minmax_diff:3038.000 - global_seqlen/balanced_min:77586.000 - global_seqlen/balanced_max:78450.000 - global_seqlen/mean:77694.250 - actor/entropy_loss:1.192 - training/rollout_probs_diff_max:0.896 - training/rollout_probs_diff_mean:0.050 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.018 - actor/kl_coef:0.010 - actor/pg_loss:0.102 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.639 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:120.291 - actor/lr:0.000 - training/global_step:55.000 - training/epoch:0.000 - critic/score/mean:0.563 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.563 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.036 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.036 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:146.408 - response_length/max:1413.000 - response_length/min:36.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.578 - prompt_length/max:494.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:18.113 - timing_s/reshard:4.736 - timing_s/gen:24.126 - timing_s/reward:0.144 - timing_s/old_log_prob:7.193 - timing_s/ref:7.056 - timing_s/adv:0.021 - timing_s/update_actor:21.941 - timing_s/dump_rollout_generations:0.249 - timing_s/step:60.759 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.161 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:621554.000 - perf/time_per_step:60.759 - perf/throughput:1278.718
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/56.jsonl
step:56 - global_seqlen/min:74546.000 - global_seqlen/max:79699.000 - global_seqlen/minmax_diff:5153.000 - global_seqlen/balanced_min:77170.000 - global_seqlen/balanced_max:77540.000 - global_seqlen/mean:77216.500 - actor/entropy_loss:1.237 - training/rollout_probs_diff_max:0.978 - training/rollout_probs_diff_mean:0.050 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.036 - actor/kl_coef:0.010 - actor/pg_loss:0.024 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.592 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:120.293 - actor/lr:0.000 - training/global_step:56.000 - training/epoch:0.000 - critic/score/mean:0.586 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.586 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:144.473 - response_length/max:987.000 - response_length/min:28.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.781 - prompt_length/max:529.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.740 - timing_s/reshard:4.469 - timing_s/gen:21.259 - timing_s/reward:0.146 - timing_s/old_log_prob:7.227 - timing_s/ref:6.948 - timing_s/adv:0.019 - timing_s/update_actor:21.566 - timing_s/dump_rollout_generations:0.256 - timing_s/step:57.454 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.144 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:617732.000 - perf/time_per_step:57.454 - perf/throughput:1343.977
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/57.jsonl
step:57 - global_seqlen/min:76792.000 - global_seqlen/max:79468.000 - global_seqlen/minmax_diff:2676.000 - global_seqlen/balanced_min:77921.000 - global_seqlen/balanced_max:78099.000 - global_seqlen/mean:77943.875 - actor/entropy_loss:1.306 - training/rollout_probs_diff_max:0.880 - training/rollout_probs_diff_mean:0.050 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.061 - actor/kl_coef:0.010 - actor/pg_loss:-0.006 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.650 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:120.606 - actor/lr:0.000 - training/global_step:57.000 - training/epoch:0.000 - critic/score/mean:0.591 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.591 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:149.937 - response_length/max:775.000 - response_length/min:30.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.000 - prompt_length/max:495.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.056 - timing_s/reshard:4.667 - timing_s/gen:20.237 - timing_s/reward:0.144 - timing_s/old_log_prob:7.231 - timing_s/ref:7.182 - timing_s/adv:0.019 - timing_s/update_actor:21.096 - timing_s/dump_rollout_generations:0.259 - timing_s/step:56.198 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.132 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:623551.000 - perf/time_per_step:56.198 - perf/throughput:1386.955
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/58.jsonl
step:58 - global_seqlen/min:76731.000 - global_seqlen/max:80169.000 - global_seqlen/minmax_diff:3438.000 - global_seqlen/balanced_min:78060.000 - global_seqlen/balanced_max:79537.000 - global_seqlen/mean:78244.875 - actor/entropy_loss:1.277 - training/rollout_probs_diff_max:0.832 - training/rollout_probs_diff_mean:0.050 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.029 - actor/kl_coef:0.010 - actor/pg_loss:0.132 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.772 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:120.549 - actor/lr:0.000 - training/global_step:58.000 - training/epoch:0.000 - critic/score/mean:0.555 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.555 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.029 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.029 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:150.702 - response_length/max:2048.000 - response_length/min:15.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.586 - prompt_length/max:493.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.384 - timing_s/reshard:6.889 - timing_s/gen:29.495 - timing_s/reward:0.146 - timing_s/old_log_prob:7.323 - timing_s/ref:7.242 - timing_s/adv:0.021 - timing_s/update_actor:21.489 - timing_s/dump_rollout_generations:0.264 - timing_s/step:66.014 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.191 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:625959.000 - perf/time_per_step:66.014 - perf/throughput:1185.284
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/59.jsonl
step:59 - global_seqlen/min:77356.000 - global_seqlen/max:81415.000 - global_seqlen/minmax_diff:4059.000 - global_seqlen/balanced_min:78916.000 - global_seqlen/balanced_max:80360.000 - global_seqlen/mean:79097.250 - actor/entropy_loss:1.403 - training/rollout_probs_diff_max:0.843 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.050 - actor/kl_coef:0.010 - actor/pg_loss:0.150 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.653 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:120.491 - actor/lr:0.000 - training/global_step:59.000 - training/epoch:0.000 - critic/score/mean:0.572 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.572 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.039 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.039 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:155.041 - response_length/max:2048.000 - response_length/min:51.000 - response_length/clip_ratio:0.001 - prompt_length/mean:462.906 - prompt_length/max:526.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.612 - timing_s/reshard:4.127 - timing_s/gen:27.002 - timing_s/reward:0.147 - timing_s/old_log_prob:7.329 - timing_s/ref:7.175 - timing_s/adv:0.025 - timing_s/update_actor:21.813 - timing_s/dump_rollout_generations:0.263 - timing_s/step:63.782 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.170 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:632778.000 - perf/time_per_step:63.782 - perf/throughput:1240.124
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/60.jsonl
step:60 - global_seqlen/min:76175.000 - global_seqlen/max:80095.000 - global_seqlen/minmax_diff:3920.000 - global_seqlen/balanced_min:77743.000 - global_seqlen/balanced_max:77859.000 - global_seqlen/mean:77758.250 - actor/entropy_loss:1.363 - training/rollout_probs_diff_max:0.969 - training/rollout_probs_diff_mean:0.051 - training/rollout_probs_diff_std:0.080 - actor/kl_loss:0.057 - actor/kl_coef:0.010 - actor/pg_loss:0.051 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.749 - perf/mfu/actor:0.167 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:120.413 - actor/lr:0.000 - training/global_step:60.000 - training/epoch:0.000 - critic/score/mean:0.530 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.530 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:145.572 - response_length/max:680.000 - response_length/min:42.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.914 - prompt_length/max:504.000 - prompt_length/min:430.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.268 - timing_s/reshard:4.156 - timing_s/gen:19.695 - timing_s/reward:0.166 - timing_s/old_log_prob:7.269 - timing_s/ref:6.992 - timing_s/adv:0.019 - timing_s/update_actor:22.287 - timing_s/dump_rollout_generations:0.264 - timing_s/step:56.724 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.132 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:622066.000 - perf/time_per_step:56.724 - perf/throughput:1370.816
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/61.jsonl
step:61 - global_seqlen/min:75390.000 - global_seqlen/max:80330.000 - global_seqlen/minmax_diff:4940.000 - global_seqlen/balanced_min:78535.000 - global_seqlen/balanced_max:78536.000 - global_seqlen/mean:78535.500 - actor/entropy_loss:1.317 - training/rollout_probs_diff_max:0.976 - training/rollout_probs_diff_mean:0.050 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.045 - actor/kl_coef:0.010 - actor/pg_loss:-0.021 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.580 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:120.542 - actor/lr:0.000 - training/global_step:61.000 - training/epoch:0.000 - critic/score/mean:0.523 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.523 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.011 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.011 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:151.387 - response_length/max:473.000 - response_length/min:46.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.172 - prompt_length/max:503.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.464 - timing_s/reshard:4.177 - timing_s/gen:18.192 - timing_s/reward:0.148 - timing_s/old_log_prob:7.224 - timing_s/ref:7.070 - timing_s/adv:0.021 - timing_s/update_actor:21.700 - timing_s/dump_rollout_generations:0.263 - timing_s/step:54.654 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:628284.000 - perf/time_per_step:54.654 - perf/throughput:1436.960
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/62.jsonl
step:62 - global_seqlen/min:78146.000 - global_seqlen/max:81765.000 - global_seqlen/minmax_diff:3619.000 - global_seqlen/balanced_min:79782.000 - global_seqlen/balanced_max:79816.000 - global_seqlen/mean:79787.000 - actor/entropy_loss:1.379 - training/rollout_probs_diff_max:0.984 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.043 - actor/kl_coef:0.010 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.489 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:120.197 - actor/lr:0.000 - training/global_step:62.000 - training/epoch:0.000 - critic/score/mean:0.577 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.577 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:163.250 - response_length/max:705.000 - response_length/min:33.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.086 - prompt_length/max:509.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.831 - timing_s/reshard:6.134 - timing_s/gen:21.519 - timing_s/reward:0.160 - timing_s/old_log_prob:7.248 - timing_s/ref:7.035 - timing_s/adv:0.022 - timing_s/update_actor:22.066 - timing_s/dump_rollout_generations:0.259 - timing_s/step:58.347 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.129 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:638296.000 - perf/time_per_step:58.347 - perf/throughput:1367.463
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/63.jsonl
step:63 - global_seqlen/min:76658.000 - global_seqlen/max:82009.000 - global_seqlen/minmax_diff:5351.000 - global_seqlen/balanced_min:80083.000 - global_seqlen/balanced_max:80096.000 - global_seqlen/mean:80086.750 - actor/entropy_loss:1.339 - training/rollout_probs_diff_max:0.927 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.048 - actor/kl_coef:0.010 - actor/pg_loss:0.081 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.521 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:120.323 - actor/lr:0.000 - training/global_step:63.000 - training/epoch:0.000 - critic/score/mean:0.633 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.633 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.010 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:164.693 - response_length/max:578.000 - response_length/min:49.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.984 - prompt_length/max:518.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.766 - timing_s/reshard:6.718 - timing_s/gen:22.062 - timing_s/reward:0.166 - timing_s/old_log_prob:7.189 - timing_s/ref:7.107 - timing_s/adv:0.020 - timing_s/update_actor:21.999 - timing_s/dump_rollout_generations:0.260 - timing_s/step:58.841 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.131 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:640694.000 - perf/time_per_step:58.841 - perf/throughput:1361.066
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/64.jsonl
step:64 - global_seqlen/min:78811.000 - global_seqlen/max:84066.000 - global_seqlen/minmax_diff:5255.000 - global_seqlen/balanced_min:80618.000 - global_seqlen/balanced_max:82032.000 - global_seqlen/mean:80795.500 - actor/entropy_loss:1.318 - training/rollout_probs_diff_max:0.979 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.033 - actor/kl_coef:0.010 - actor/pg_loss:0.139 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.597 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:120.296 - actor/lr:0.000 - training/global_step:64.000 - training/epoch:0.000 - critic/score/mean:0.610 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.610 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.030 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.030 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:170.340 - response_length/max:2048.000 - response_length/min:46.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.875 - prompt_length/max:520.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.581 - timing_s/reshard:7.563 - timing_s/gen:31.368 - timing_s/reward:0.148 - timing_s/old_log_prob:7.262 - timing_s/ref:7.050 - timing_s/adv:0.023 - timing_s/update_actor:22.218 - timing_s/dump_rollout_generations:0.264 - timing_s/step:68.362 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.180 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:646364.000 - perf/time_per_step:68.362 - perf/throughput:1181.885
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/65.jsonl
step:65 - global_seqlen/min:77325.000 - global_seqlen/max:85364.000 - global_seqlen/minmax_diff:8039.000 - global_seqlen/balanced_min:82036.000 - global_seqlen/balanced_max:83506.000 - global_seqlen/mean:82220.375 - actor/entropy_loss:1.301 - training/rollout_probs_diff_max:0.993 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.048 - actor/kl_coef:0.010 - actor/pg_loss:-0.096 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.459 - perf/mfu/actor:0.182 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:120.396 - actor/lr:0.000 - training/global_step:65.000 - training/epoch:0.000 - critic/score/mean:0.602 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.602 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:181.214 - response_length/max:2048.000 - response_length/min:56.000 - response_length/clip_ratio:0.001 - prompt_length/mean:461.133 - prompt_length/max:540.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.479 - timing_s/reshard:4.117 - timing_s/gen:27.119 - timing_s/reward:0.155 - timing_s/old_log_prob:7.047 - timing_s/ref:6.797 - timing_s/adv:0.025 - timing_s/update_actor:21.680 - timing_s/dump_rollout_generations:0.265 - timing_s/step:63.122 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.146 - timing_per_token_ms/ref:0.010 - perf/total_num_tokens:657763.000 - perf/time_per_step:63.122 - perf/throughput:1302.572
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/66.jsonl
step:66 - global_seqlen/min:79951.000 - global_seqlen/max:84860.000 - global_seqlen/minmax_diff:4909.000 - global_seqlen/balanced_min:82544.000 - global_seqlen/balanced_max:82545.000 - global_seqlen/mean:82544.375 - actor/entropy_loss:1.299 - training/rollout_probs_diff_max:0.963 - training/rollout_probs_diff_mean:0.050 - training/rollout_probs_diff_std:0.080 - actor/kl_loss:0.040 - actor/kl_coef:0.010 - actor/pg_loss:-0.066 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.543 - perf/mfu/actor:0.189 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:120.417 - actor/lr:0.000 - training/global_step:66.000 - training/epoch:0.000 - critic/score/mean:0.529 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.529 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:183.776 - response_length/max:491.000 - response_length/min:44.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.102 - prompt_length/max:504.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.436 - timing_s/reshard:4.480 - timing_s/gen:20.103 - timing_s/reward:0.153 - timing_s/old_log_prob:7.106 - timing_s/ref:7.114 - timing_s/adv:0.019 - timing_s/update_actor:20.989 - timing_s/dump_rollout_generations:0.264 - timing_s/step:55.779 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.032 - timing_per_token_ms/gen:0.107 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:660355.000 - perf/time_per_step:55.779 - perf/throughput:1479.852
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/67.jsonl
step:67 - global_seqlen/min:81610.000 - global_seqlen/max:85849.000 - global_seqlen/minmax_diff:4239.000 - global_seqlen/balanced_min:83381.000 - global_seqlen/balanced_max:83382.000 - global_seqlen/mean:83381.750 - actor/entropy_loss:1.345 - training/rollout_probs_diff_max:0.971 - training/rollout_probs_diff_mean:0.050 - training/rollout_probs_diff_std:0.080 - actor/kl_loss:0.043 - actor/kl_coef:0.010 - actor/pg_loss:-0.090 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.701 - perf/mfu/actor:0.181 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:120.518 - actor/lr:0.000 - training/global_step:67.000 - training/epoch:0.000 - critic/score/mean:0.599 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.599 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.007 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.007 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:190.951 - response_length/max:519.000 - response_length/min:36.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.469 - prompt_length/max:505.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.548 - timing_s/reshard:4.127 - timing_s/gen:19.941 - timing_s/reward:0.153 - timing_s/old_log_prob:7.215 - timing_s/ref:7.144 - timing_s/adv:0.021 - timing_s/update_actor:22.126 - timing_s/dump_rollout_generations:0.263 - timing_s/step:56.893 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:667054.000 - perf/time_per_step:56.893 - perf/throughput:1465.594
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/68.jsonl
step:68 - global_seqlen/min:80765.000 - global_seqlen/max:86711.000 - global_seqlen/minmax_diff:5946.000 - global_seqlen/balanced_min:82701.000 - global_seqlen/balanced_max:82702.000 - global_seqlen/mean:82701.375 - actor/entropy_loss:1.376 - training/rollout_probs_diff_max:0.867 - training/rollout_probs_diff_mean:0.050 - training/rollout_probs_diff_std:0.080 - actor/kl_loss:0.044 - actor/kl_coef:0.010 - actor/pg_loss:0.028 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.722 - perf/mfu/actor:0.183 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:120.547 - actor/lr:0.000 - training/global_step:68.000 - training/epoch:0.000 - critic/score/mean:0.553 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.553 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:188.331 - response_length/max:487.000 - response_length/min:46.000 - response_length/clip_ratio:0.000 - prompt_length/mean:457.773 - prompt_length/max:488.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.424 - timing_s/reshard:4.435 - timing_s/gen:19.405 - timing_s/reward:0.174 - timing_s/old_log_prob:7.266 - timing_s/ref:7.101 - timing_s/adv:0.021 - timing_s/update_actor:21.698 - timing_s/dump_rollout_generations:0.268 - timing_s/step:55.968 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:661611.000 - perf/time_per_step:55.968 - perf/throughput:1477.666
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/69.jsonl
step:69 - global_seqlen/min:79507.000 - global_seqlen/max:84637.000 - global_seqlen/minmax_diff:5130.000 - global_seqlen/balanced_min:82789.000 - global_seqlen/balanced_max:84177.000 - global_seqlen/mean:82963.000 - actor/entropy_loss:1.370 - training/rollout_probs_diff_max:0.967 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.040 - actor/kl_coef:0.010 - actor/pg_loss:0.125 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.423 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:121.896 - actor/lr:0.000 - training/global_step:69.000 - training/epoch:1.000 - critic/score/mean:0.634 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.634 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.018 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.018 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:189.359 - response_length/max:2048.000 - response_length/min:50.000 - response_length/clip_ratio:0.001 - prompt_length/mean:458.789 - prompt_length/max:511.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.748 - timing_s/reshard:4.003 - timing_s/gen:28.048 - timing_s/reward:0.160 - timing_s/old_log_prob:7.251 - timing_s/ref:7.123 - timing_s/adv:0.023 - timing_s/update_actor:22.508 - timing_s/dump_rollout_generations:0.274 - timing_s/step:65.436 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.145 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:663704.000 - perf/time_per_step:65.436 - perf/throughput:1267.854
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/70.jsonl
step:70 - global_seqlen/min:80615.000 - global_seqlen/max:86513.000 - global_seqlen/minmax_diff:5898.000 - global_seqlen/balanced_min:83156.000 - global_seqlen/balanced_max:83511.000 - global_seqlen/mean:83201.000 - actor/entropy_loss:1.374 - training/rollout_probs_diff_max:0.837 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.043 - actor/kl_coef:0.010 - actor/pg_loss:0.006 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.473 - perf/mfu/actor:0.183 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:123.463 - actor/lr:0.000 - training/global_step:70.000 - training/epoch:1.000 - critic/score/mean:0.621 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.621 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.000 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:191.438 - response_length/max:1006.000 - response_length/min:45.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.570 - prompt_length/max:497.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:17.300 - timing_s/reshard:4.115 - timing_s/gen:22.651 - timing_s/reward:0.162 - timing_s/old_log_prob:7.432 - timing_s/ref:7.106 - timing_s/adv:0.021 - timing_s/update_actor:21.877 - timing_s/dump_rollout_generations:0.292 - timing_s/step:59.576 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:665608.000 - perf/time_per_step:59.576 - perf/throughput:1396.541
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/71.jsonl
step:71 - global_seqlen/min:79745.000 - global_seqlen/max:84619.000 - global_seqlen/minmax_diff:4874.000 - global_seqlen/balanced_min:83143.000 - global_seqlen/balanced_max:83143.000 - global_seqlen/mean:83143.000 - actor/entropy_loss:1.352 - training/rollout_probs_diff_max:0.977 - training/rollout_probs_diff_mean:0.050 - training/rollout_probs_diff_std:0.080 - actor/kl_loss:0.036 - actor/kl_coef:0.010 - actor/pg_loss:-0.022 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.555 - perf/mfu/actor:0.181 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:124.453 - actor/lr:0.000 - training/global_step:71.000 - training/epoch:1.000 - critic/score/mean:0.625 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.625 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:190.188 - response_length/max:513.000 - response_length/min:48.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.367 - prompt_length/max:499.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.638 - timing_s/reshard:4.114 - timing_s/gen:19.967 - timing_s/reward:0.162 - timing_s/old_log_prob:7.411 - timing_s/ref:7.106 - timing_s/adv:0.022 - timing_s/update_actor:22.169 - timing_s/dump_rollout_generations:0.267 - timing_s/step:57.139 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:665144.000 - perf/time_per_step:57.139 - perf/throughput:1455.108
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/72.jsonl
step:72 - global_seqlen/min:82224.000 - global_seqlen/max:87383.000 - global_seqlen/minmax_diff:5159.000 - global_seqlen/balanced_min:84499.000 - global_seqlen/balanced_max:85821.000 - global_seqlen/mean:84665.000 - actor/entropy_loss:1.383 - training/rollout_probs_diff_max:0.994 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.044 - actor/kl_coef:0.010 - actor/pg_loss:0.102 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.469 - perf/mfu/actor:0.182 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:125.306 - actor/lr:0.000 - training/global_step:72.000 - training/epoch:1.000 - critic/score/mean:0.590 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.590 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.028 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.028 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:201.625 - response_length/max:2048.000 - response_length/min:27.000 - response_length/clip_ratio:0.001 - prompt_length/mean:459.820 - prompt_length/max:508.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:23.062 - timing_s/reshard:4.103 - timing_s/gen:27.732 - timing_s/reward:0.166 - timing_s/old_log_prob:7.280 - timing_s/ref:7.191 - timing_s/adv:0.025 - timing_s/update_actor:22.429 - timing_s/dump_rollout_generations:0.290 - timing_s/step:65.149 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.134 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:677320.000 - perf/time_per_step:65.149 - perf/throughput:1299.560
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/73.jsonl
step:73 - global_seqlen/min:82141.000 - global_seqlen/max:88942.000 - global_seqlen/minmax_diff:6801.000 - global_seqlen/balanced_min:84545.000 - global_seqlen/balanced_max:84546.000 - global_seqlen/mean:84545.500 - actor/entropy_loss:1.409 - training/rollout_probs_diff_max:0.934 - training/rollout_probs_diff_mean:0.050 - training/rollout_probs_diff_std:0.080 - actor/kl_loss:0.031 - actor/kl_coef:0.010 - actor/pg_loss:-0.060 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.444 - perf/mfu/actor:0.180 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:126.846 - actor/lr:0.000 - training/global_step:73.000 - training/epoch:1.000 - critic/score/mean:0.576 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.576 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:201.332 - response_length/max:483.000 - response_length/min:37.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.180 - prompt_length/max:501.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.756 - timing_s/reshard:4.136 - timing_s/gen:20.031 - timing_s/reward:0.164 - timing_s/old_log_prob:7.572 - timing_s/ref:7.426 - timing_s/adv:0.020 - timing_s/update_actor:22.530 - timing_s/dump_rollout_generations:0.271 - timing_s/step:58.054 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:676364.000 - perf/time_per_step:58.054 - perf/throughput:1456.329
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/74.jsonl
step:74 - global_seqlen/min:82545.000 - global_seqlen/max:87154.000 - global_seqlen/minmax_diff:4609.000 - global_seqlen/balanced_min:85330.000 - global_seqlen/balanced_max:85331.000 - global_seqlen/mean:85330.625 - actor/entropy_loss:1.430 - training/rollout_probs_diff_max:0.923 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.038 - actor/kl_coef:0.010 - actor/pg_loss:0.037 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.635 - perf/mfu/actor:0.183 - perf/max_memory_allocated_gb:27.982 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:128.121 - actor/lr:0.000 - training/global_step:74.000 - training/epoch:1.000 - critic/score/mean:0.581 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.581 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:206.841 - response_length/max:566.000 - response_length/min:55.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.805 - prompt_length/max:495.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.971 - timing_s/reshard:4.183 - timing_s/gen:20.355 - timing_s/reward:0.164 - timing_s/old_log_prob:7.395 - timing_s/ref:7.332 - timing_s/adv:0.020 - timing_s/update_actor:22.379 - timing_s/dump_rollout_generations:0.276 - timing_s/step:57.953 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.096 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:682645.000 - perf/time_per_step:57.953 - perf/throughput:1472.403
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/75.jsonl
step:75 - global_seqlen/min:83287.000 - global_seqlen/max:87790.000 - global_seqlen/minmax_diff:4503.000 - global_seqlen/balanced_min:85311.000 - global_seqlen/balanced_max:86573.000 - global_seqlen/mean:85511.000 - actor/entropy_loss:1.442 - training/rollout_probs_diff_max:0.847 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.080 - actor/kl_loss:0.049 - actor/kl_coef:0.010 - actor/pg_loss:0.079 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.288 - perf/mfu/actor:0.182 - perf/max_memory_allocated_gb:28.310 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:128.989 - actor/lr:0.000 - training/global_step:75.000 - training/epoch:1.000 - critic/score/mean:0.535 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.535 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.029 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.029 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:204.062 - response_length/max:2048.000 - response_length/min:43.000 - response_length/clip_ratio:0.001 - prompt_length/mean:463.992 - prompt_length/max:508.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.945 - timing_s/reshard:4.163 - timing_s/gen:27.618 - timing_s/reward:0.164 - timing_s/old_log_prob:7.405 - timing_s/ref:7.235 - timing_s/adv:0.021 - timing_s/update_actor:22.576 - timing_s/dump_rollout_generations:0.311 - timing_s/step:65.362 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.132 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:684088.000 - perf/time_per_step:65.362 - perf/throughput:1308.264
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/76.jsonl
step:76 - global_seqlen/min:81965.000 - global_seqlen/max:86842.000 - global_seqlen/minmax_diff:4877.000 - global_seqlen/balanced_min:85029.000 - global_seqlen/balanced_max:85029.000 - global_seqlen/mean:85029.000 - actor/entropy_loss:1.497 - training/rollout_probs_diff_max:0.975 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.036 - actor/kl_coef:0.010 - actor/pg_loss:0.012 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.559 - perf/mfu/actor:0.183 - perf/max_memory_allocated_gb:28.310 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:129.697 - actor/lr:0.000 - training/global_step:76.000 - training/epoch:1.000 - critic/score/mean:0.630 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.630 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:205.297 - response_length/max:529.000 - response_length/min:57.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.992 - prompt_length/max:493.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.256 - timing_s/reshard:4.138 - timing_s/gen:19.945 - timing_s/reward:0.164 - timing_s/old_log_prob:7.441 - timing_s/ref:7.175 - timing_s/adv:0.021 - timing_s/update_actor:22.302 - timing_s/dump_rollout_generations:0.276 - timing_s/step:57.354 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:680232.000 - perf/time_per_step:57.354 - perf/throughput:1482.538
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/77.jsonl
step:77 - global_seqlen/min:82836.000 - global_seqlen/max:87792.000 - global_seqlen/minmax_diff:4956.000 - global_seqlen/balanced_min:85042.000 - global_seqlen/balanced_max:85043.000 - global_seqlen/mean:85042.750 - actor/entropy_loss:1.493 - training/rollout_probs_diff_max:0.918 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.027 - actor/kl_coef:0.010 - actor/pg_loss:0.050 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.851 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.310 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:129.741 - actor/lr:0.000 - training/global_step:77.000 - training/epoch:1.000 - critic/score/mean:0.574 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.574 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.010 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:202.787 - response_length/max:571.000 - response_length/min:30.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.609 - prompt_length/max:521.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.243 - timing_s/reshard:4.135 - timing_s/gen:20.414 - timing_s/reward:0.164 - timing_s/old_log_prob:7.268 - timing_s/ref:7.090 - timing_s/adv:0.021 - timing_s/update_actor:22.960 - timing_s/dump_rollout_generations:0.273 - timing_s/step:58.221 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/ref:0.010 - perf/total_num_tokens:680342.000 - perf/time_per_step:58.221 - perf/throughput:1460.681
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/78.jsonl
step:78 - global_seqlen/min:83758.000 - global_seqlen/max:87939.000 - global_seqlen/minmax_diff:4181.000 - global_seqlen/balanced_min:86160.000 - global_seqlen/balanced_max:86355.000 - global_seqlen/mean:86184.375 - actor/entropy_loss:1.557 - training/rollout_probs_diff_max:0.986 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.024 - actor/kl_coef:0.010 - actor/pg_loss:-0.005 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.657 - perf/mfu/actor:0.180 - perf/max_memory_allocated_gb:28.310 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:129.816 - actor/lr:0.000 - training/global_step:78.000 - training/epoch:1.000 - critic/score/mean:0.611 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.611 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:210.870 - response_length/max:893.000 - response_length/min:52.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.445 - prompt_length/max:506.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:17.069 - timing_s/reshard:4.155 - timing_s/gen:21.765 - timing_s/reward:0.167 - timing_s/old_log_prob:7.512 - timing_s/ref:7.439 - timing_s/adv:0.019 - timing_s/update_actor:23.029 - timing_s/dump_rollout_generations:0.271 - timing_s/step:60.236 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:689475.000 - perf/time_per_step:60.236 - perf/throughput:1430.785
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/79.jsonl
step:79 - global_seqlen/min:82873.000 - global_seqlen/max:87010.000 - global_seqlen/minmax_diff:4137.000 - global_seqlen/balanced_min:85136.000 - global_seqlen/balanced_max:85137.000 - global_seqlen/mean:85136.250 - actor/entropy_loss:1.525 - training/rollout_probs_diff_max:0.997 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.080 - actor/kl_loss:0.024 - actor/kl_coef:0.010 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.564 - perf/mfu/actor:0.183 - perf/max_memory_allocated_gb:28.310 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:129.752 - actor/lr:0.000 - training/global_step:79.000 - training/epoch:1.000 - critic/score/mean:0.583 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.583 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.000 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:204.588 - response_length/max:463.000 - response_length/min:51.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.539 - prompt_length/max:506.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.878 - timing_s/reshard:4.085 - timing_s/gen:20.462 - timing_s/reward:0.163 - timing_s/old_log_prob:7.484 - timing_s/ref:7.279 - timing_s/adv:0.025 - timing_s/update_actor:22.415 - timing_s/dump_rollout_generations:0.275 - timing_s/step:58.134 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:681090.000 - perf/time_per_step:58.134 - perf/throughput:1464.474
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/80.jsonl
local_global_step_folder: ../ckpt/checkpoints/global_step_80
step:80 - global_seqlen/min:81491.000 - global_seqlen/max:86213.000 - global_seqlen/minmax_diff:4722.000 - global_seqlen/balanced_min:84079.000 - global_seqlen/balanced_max:84080.000 - global_seqlen/mean:84079.750 - actor/entropy_loss:1.485 - training/rollout_probs_diff_max:0.937 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.030 - actor/kl_coef:0.010 - actor/pg_loss:-0.072 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.488 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.310 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:129.884 - actor/lr:0.000 - training/global_step:80.000 - training/epoch:1.000 - critic/score/mean:0.576 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.576 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:195.865 - response_length/max:591.000 - response_length/min:47.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.008 - prompt_length/max:509.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.531 - timing_s/reshard:4.098 - timing_s/gen:20.896 - timing_s/reward:0.162 - timing_s/old_log_prob:7.344 - timing_s/ref:7.214 - timing_s/adv:0.021 - timing_s/update_actor:22.676 - timing_s/dump_rollout_generations:0.269 - timing_s/save_checkpoint:30.403 - timing_s/step:89.016 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.104 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:672638.000 - perf/time_per_step:89.016 - perf/throughput:944.550
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/81.jsonl
step:81 - global_seqlen/min:81057.000 - global_seqlen/max:87474.000 - global_seqlen/minmax_diff:6417.000 - global_seqlen/balanced_min:83535.000 - global_seqlen/balanced_max:84871.000 - global_seqlen/mean:83702.125 - actor/entropy_loss:1.542 - training/rollout_probs_diff_max:0.938 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.032 - actor/kl_coef:0.010 - actor/pg_loss:0.170 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.402 - perf/mfu/actor:0.182 - perf/max_memory_allocated_gb:28.310 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:144.301 - actor/lr:0.000 - training/global_step:81.000 - training/epoch:1.000 - critic/score/mean:0.594 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.594 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.026 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.026 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:194.720 - response_length/max:2048.000 - response_length/min:37.000 - response_length/clip_ratio:0.001 - prompt_length/mean:459.203 - prompt_length/max:521.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:25.034 - timing_s/reshard:4.399 - timing_s/gen:30.020 - timing_s/reward:0.164 - timing_s/old_log_prob:7.560 - timing_s/ref:7.324 - timing_s/adv:0.029 - timing_s/update_actor:22.136 - timing_s/dump_rollout_generations:0.274 - timing_s/step:67.557 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.151 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:669617.000 - perf/time_per_step:67.557 - perf/throughput:1238.980
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/82.jsonl
step:82 - global_seqlen/min:79719.000 - global_seqlen/max:86477.000 - global_seqlen/minmax_diff:6758.000 - global_seqlen/balanced_min:83556.000 - global_seqlen/balanced_max:83557.000 - global_seqlen/mean:83556.625 - actor/entropy_loss:1.501 - training/rollout_probs_diff_max:0.969 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.030 - actor/kl_coef:0.010 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.395 - perf/mfu/actor:0.182 - perf/max_memory_allocated_gb:28.310 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:131.360 - actor/lr:0.000 - training/global_step:82.000 - training/epoch:1.000 - critic/score/mean:0.569 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.569 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:191.067 - response_length/max:523.000 - response_length/min:42.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.719 - prompt_length/max:530.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.062 - timing_s/reshard:4.157 - timing_s/gen:19.768 - timing_s/reward:0.161 - timing_s/old_log_prob:7.359 - timing_s/ref:7.156 - timing_s/adv:0.021 - timing_s/update_actor:22.046 - timing_s/dump_rollout_generations:0.297 - timing_s/step:56.840 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:668453.000 - perf/time_per_step:56.840 - perf/throughput:1470.019
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/83.jsonl
step:83 - global_seqlen/min:79940.000 - global_seqlen/max:84596.000 - global_seqlen/minmax_diff:4656.000 - global_seqlen/balanced_min:82049.000 - global_seqlen/balanced_max:82050.000 - global_seqlen/mean:82049.250 - actor/entropy_loss:1.505 - training/rollout_probs_diff_max:0.935 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.029 - actor/kl_coef:0.010 - actor/pg_loss:-0.020 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.515 - perf/mfu/actor:0.181 - perf/max_memory_allocated_gb:28.310 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:129.782 - actor/lr:0.000 - training/global_step:83.000 - training/epoch:1.000 - critic/score/mean:0.645 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.645 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:182.072 - response_length/max:509.000 - response_length/min:49.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.938 - prompt_length/max:513.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.930 - timing_s/reshard:4.176 - timing_s/gen:19.666 - timing_s/reward:0.158 - timing_s/old_log_prob:7.292 - timing_s/ref:7.235 - timing_s/adv:0.021 - timing_s/update_actor:21.782 - timing_s/dump_rollout_generations:0.278 - timing_s/step:56.462 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.105 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:656394.000 - perf/time_per_step:56.462 - perf/throughput:1453.182
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/84.jsonl
step:84 - global_seqlen/min:78768.000 - global_seqlen/max:88285.000 - global_seqlen/minmax_diff:9517.000 - global_seqlen/balanced_min:83900.000 - global_seqlen/balanced_max:85265.000 - global_seqlen/mean:84071.375 - actor/entropy_loss:1.529 - training/rollout_probs_diff_max:0.840 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.024 - actor/kl_coef:0.010 - actor/pg_loss:0.025 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.488 - perf/mfu/actor:0.188 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:129.831 - actor/lr:0.000 - training/global_step:84.000 - training/epoch:1.000 - critic/score/mean:0.556 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.556 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.007 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.007 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:195.519 - response_length/max:2048.000 - response_length/min:35.000 - response_length/clip_ratio:0.001 - prompt_length/mean:461.289 - prompt_length/max:529.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:23.212 - timing_s/reshard:4.087 - timing_s/gen:27.861 - timing_s/reward:0.162 - timing_s/old_log_prob:7.376 - timing_s/ref:7.233 - timing_s/adv:0.022 - timing_s/update_actor:21.448 - timing_s/dump_rollout_generations:0.268 - timing_s/step:64.403 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.032 - timing_per_token_ms/gen:0.139 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:672571.000 - perf/time_per_step:64.403 - perf/throughput:1305.387
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/85.jsonl
step:85 - global_seqlen/min:82156.000 - global_seqlen/max:84542.000 - global_seqlen/minmax_diff:2386.000 - global_seqlen/balanced_min:83264.000 - global_seqlen/balanced_max:83348.000 - global_seqlen/mean:83274.625 - actor/entropy_loss:1.592 - training/rollout_probs_diff_max:0.990 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.019 - actor/kl_coef:0.010 - actor/pg_loss:-0.063 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.606 - perf/mfu/actor:0.197 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:130.200 - actor/lr:0.000 - training/global_step:85.000 - training/epoch:1.000 - critic/score/mean:0.581 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.581 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.008 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.008 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:187.903 - response_length/max:693.000 - response_length/min:39.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.680 - prompt_length/max:540.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.992 - timing_s/reshard:4.134 - timing_s/gen:20.678 - timing_s/reward:0.163 - timing_s/old_log_prob:7.299 - timing_s/ref:7.180 - timing_s/adv:0.021 - timing_s/update_actor:20.336 - timing_s/dump_rollout_generations:0.277 - timing_s/step:55.986 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.031 - timing_per_token_ms/gen:0.107 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:666197.000 - perf/time_per_step:55.986 - perf/throughput:1487.427
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/86.jsonl
step:86 - global_seqlen/min:79964.000 - global_seqlen/max:85948.000 - global_seqlen/minmax_diff:5984.000 - global_seqlen/balanced_min:83649.000 - global_seqlen/balanced_max:83654.000 - global_seqlen/mean:83650.125 - actor/entropy_loss:1.617 - training/rollout_probs_diff_max:0.950 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.029 - actor/kl_coef:0.010 - actor/pg_loss:-0.034 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.468 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:130.635 - actor/lr:0.000 - training/global_step:86.000 - training/epoch:1.000 - critic/score/mean:0.571 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.571 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:190.540 - response_length/max:718.000 - response_length/min:39.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.977 - prompt_length/max:507.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.873 - timing_s/reshard:4.036 - timing_s/gen:20.452 - timing_s/reward:0.189 - timing_s/old_log_prob:7.458 - timing_s/ref:7.309 - timing_s/adv:0.021 - timing_s/update_actor:22.573 - timing_s/dump_rollout_generations:0.268 - timing_s/step:58.299 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.105 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:669201.000 - perf/time_per_step:58.299 - perf/throughput:1434.847
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/87.jsonl
step:87 - global_seqlen/min:79866.000 - global_seqlen/max:84134.000 - global_seqlen/minmax_diff:4268.000 - global_seqlen/balanced_min:82458.000 - global_seqlen/balanced_max:82459.000 - global_seqlen/mean:82458.500 - actor/entropy_loss:1.606 - training/rollout_probs_diff_max:0.992 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.027 - actor/kl_coef:0.010 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.065 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:130.732 - actor/lr:0.000 - training/global_step:87.000 - training/epoch:1.000 - critic/score/mean:0.548 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.548 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.007 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:184.371 - response_length/max:441.000 - response_length/min:46.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.836 - prompt_length/max:502.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.958 - timing_s/reshard:4.130 - timing_s/gen:19.317 - timing_s/reward:0.159 - timing_s/old_log_prob:7.276 - timing_s/ref:7.048 - timing_s/adv:0.021 - timing_s/update_actor:22.223 - timing_s/dump_rollout_generations:0.265 - timing_s/step:56.343 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:659668.000 - perf/time_per_step:56.343 - perf/throughput:1463.504
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/88.jsonl
step:88 - global_seqlen/min:81049.000 - global_seqlen/max:88117.000 - global_seqlen/minmax_diff:7068.000 - global_seqlen/balanced_min:83432.000 - global_seqlen/balanced_max:83433.000 - global_seqlen/mean:83432.750 - actor/entropy_loss:1.658 - training/rollout_probs_diff_max:0.927 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.029 - actor/kl_coef:0.010 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.690 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:130.795 - actor/lr:0.000 - training/global_step:88.000 - training/epoch:1.000 - critic/score/mean:0.558 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.558 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:190.373 - response_length/max:479.000 - response_length/min:24.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.445 - prompt_length/max:516.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.462 - timing_s/reshard:4.149 - timing_s/gen:19.857 - timing_s/reward:0.187 - timing_s/old_log_prob:7.239 - timing_s/ref:7.023 - timing_s/adv:0.020 - timing_s/update_actor:22.570 - timing_s/dump_rollout_generations:0.273 - timing_s/step:57.203 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:667462.000 - perf/time_per_step:57.203 - perf/throughput:1458.548
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/89.jsonl
step:89 - global_seqlen/min:79737.000 - global_seqlen/max:85389.000 - global_seqlen/minmax_diff:5652.000 - global_seqlen/balanced_min:83513.000 - global_seqlen/balanced_max:83514.000 - global_seqlen/mean:83513.125 - actor/entropy_loss:1.547 - training/rollout_probs_diff_max:0.970 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.024 - actor/kl_coef:0.010 - actor/pg_loss:0.008 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.482 - perf/mfu/actor:0.188 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:131.282 - actor/lr:0.000 - training/global_step:89.000 - training/epoch:1.000 - critic/score/mean:0.621 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.621 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:190.829 - response_length/max:588.000 - response_length/min:38.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.617 - prompt_length/max:516.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.031 - timing_s/reshard:4.106 - timing_s/gen:20.354 - timing_s/reward:0.163 - timing_s/old_log_prob:7.387 - timing_s/ref:7.238 - timing_s/adv:0.019 - timing_s/update_actor:21.426 - timing_s/dump_rollout_generations:0.268 - timing_s/step:56.886 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.032 - timing_per_token_ms/gen:0.104 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:668105.000 - perf/time_per_step:56.886 - perf/throughput:1468.076
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/90.jsonl
step:90 - global_seqlen/min:81446.000 - global_seqlen/max:87230.000 - global_seqlen/minmax_diff:5784.000 - global_seqlen/balanced_min:83832.000 - global_seqlen/balanced_max:83846.000 - global_seqlen/mean:83834.125 - actor/entropy_loss:1.673 - training/rollout_probs_diff_max:0.986 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.031 - actor/kl_coef:0.010 - actor/pg_loss:0.078 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.558 - perf/mfu/actor:0.179 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:131.557 - actor/lr:0.000 - training/global_step:90.000 - training/epoch:1.000 - critic/score/mean:0.588 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.588 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:193.087 - response_length/max:645.000 - response_length/min:47.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.867 - prompt_length/max:509.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.188 - timing_s/reshard:4.795 - timing_s/gen:20.539 - timing_s/reward:0.162 - timing_s/old_log_prob:7.339 - timing_s/ref:7.140 - timing_s/adv:0.020 - timing_s/update_actor:22.529 - timing_s/dump_rollout_generations:0.273 - timing_s/step:58.033 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.104 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:670673.000 - perf/time_per_step:58.033 - perf/throughput:1444.597
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/91.jsonl
step:91 - global_seqlen/min:79677.000 - global_seqlen/max:85938.000 - global_seqlen/minmax_diff:6261.000 - global_seqlen/balanced_min:82386.000 - global_seqlen/balanced_max:82407.000 - global_seqlen/mean:82389.375 - actor/entropy_loss:1.637 - training/rollout_probs_diff_max:0.996 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.032 - actor/kl_coef:0.010 - actor/pg_loss:-0.038 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.752 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:131.600 - actor/lr:0.000 - training/global_step:91.000 - training/epoch:1.000 - critic/score/mean:0.567 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.567 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:183.347 - response_length/max:601.000 - response_length/min:33.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.320 - prompt_length/max:508.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.646 - timing_s/reshard:6.004 - timing_s/gen:21.208 - timing_s/reward:0.162 - timing_s/old_log_prob:7.228 - timing_s/ref:7.109 - timing_s/adv:0.021 - timing_s/update_actor:22.697 - timing_s/dump_rollout_generations:0.269 - timing_s/step:58.724 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:659115.000 - perf/time_per_step:58.724 - perf/throughput:1402.999
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/92.jsonl
step:92 - global_seqlen/min:81693.000 - global_seqlen/max:86413.000 - global_seqlen/minmax_diff:4720.000 - global_seqlen/balanced_min:83316.000 - global_seqlen/balanced_max:84695.000 - global_seqlen/mean:83491.875 - actor/entropy_loss:1.640 - training/rollout_probs_diff_max:0.972 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.026 - actor/kl_coef:0.010 - actor/pg_loss:-0.021 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.553 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:132.455 - actor/lr:0.000 - training/global_step:92.000 - training/epoch:1.000 - critic/score/mean:0.551 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.551 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:191.335 - response_length/max:2048.000 - response_length/min:54.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.945 - prompt_length/max:521.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.807 - timing_s/reshard:6.686 - timing_s/gen:30.789 - timing_s/reward:0.163 - timing_s/old_log_prob:7.356 - timing_s/ref:7.177 - timing_s/adv:0.026 - timing_s/update_actor:22.803 - timing_s/dump_rollout_generations:0.273 - timing_s/step:68.621 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.157 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:667935.000 - perf/time_per_step:68.621 - perf/throughput:1216.709
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/93.jsonl
step:93 - global_seqlen/min:80200.000 - global_seqlen/max:85228.000 - global_seqlen/minmax_diff:5028.000 - global_seqlen/balanced_min:82206.000 - global_seqlen/balanced_max:83113.000 - global_seqlen/mean:82320.000 - actor/entropy_loss:1.592 - training/rollout_probs_diff_max:0.860 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.016 - actor/kl_coef:0.010 - actor/pg_loss:-0.041 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.456 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:129.720 - actor/lr:0.000 - training/global_step:93.000 - training/epoch:1.000 - critic/score/mean:0.586 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.586 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.019 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.019 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:182.820 - response_length/max:1599.000 - response_length/min:36.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.305 - prompt_length/max:502.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:20.011 - timing_s/reshard:4.126 - timing_s/gen:24.690 - timing_s/reward:0.160 - timing_s/old_log_prob:7.199 - timing_s/ref:6.996 - timing_s/adv:0.020 - timing_s/update_actor:22.185 - timing_s/dump_rollout_generations:0.269 - timing_s/step:61.550 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.132 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:658560.000 - perf/time_per_step:61.550 - perf/throughput:1337.457
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/94.jsonl
step:94 - global_seqlen/min:81530.000 - global_seqlen/max:85739.000 - global_seqlen/minmax_diff:4209.000 - global_seqlen/balanced_min:82572.000 - global_seqlen/balanced_max:83897.000 - global_seqlen/mean:82741.875 - actor/entropy_loss:1.533 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.025 - actor/kl_coef:0.010 - actor/pg_loss:0.159 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.343 - perf/mfu/actor:0.181 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:127.236 - actor/lr:0.000 - training/global_step:94.000 - training/epoch:1.000 - critic/score/mean:0.621 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.621 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.032 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.032 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:186.382 - response_length/max:2048.000 - response_length/min:41.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.039 - prompt_length/max:497.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.248 - timing_s/reshard:4.141 - timing_s/gen:26.922 - timing_s/reward:0.159 - timing_s/old_log_prob:7.493 - timing_s/ref:7.322 - timing_s/adv:0.034 - timing_s/update_actor:22.010 - timing_s/dump_rollout_generations:0.271 - timing_s/step:64.242 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.141 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:661935.000 - perf/time_per_step:64.242 - perf/throughput:1287.963
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/95.jsonl
step:95 - global_seqlen/min:80422.000 - global_seqlen/max:84852.000 - global_seqlen/minmax_diff:4430.000 - global_seqlen/balanced_min:82537.000 - global_seqlen/balanced_max:83909.000 - global_seqlen/mean:82708.875 - actor/entropy_loss:1.561 - training/rollout_probs_diff_max:0.946 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.026 - actor/kl_coef:0.010 - actor/pg_loss:0.187 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.547 - perf/mfu/actor:0.181 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:127.151 - actor/lr:0.000 - training/global_step:95.000 - training/epoch:1.000 - critic/score/mean:0.619 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.619 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.035 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.035 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:184.515 - response_length/max:2048.000 - response_length/min:39.000 - response_length/clip_ratio:0.001 - prompt_length/mean:461.648 - prompt_length/max:515.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.886 - timing_s/reshard:4.184 - timing_s/gen:27.632 - timing_s/reward:0.160 - timing_s/old_log_prob:7.393 - timing_s/ref:7.345 - timing_s/adv:0.022 - timing_s/update_actor:21.930 - timing_s/dump_rollout_generations:0.268 - timing_s/step:64.783 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.146 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:661671.000 - perf/time_per_step:64.783 - perf/throughput:1276.713
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/96.jsonl
step:96 - global_seqlen/min:78825.000 - global_seqlen/max:83771.000 - global_seqlen/minmax_diff:4946.000 - global_seqlen/balanced_min:81482.000 - global_seqlen/balanced_max:81801.000 - global_seqlen/mean:81558.125 - actor/entropy_loss:1.538 - training/rollout_probs_diff_max:0.993 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.025 - actor/kl_coef:0.010 - actor/pg_loss:0.039 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.565 - perf/mfu/actor:0.181 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:127.241 - actor/lr:0.000 - training/global_step:96.000 - training/epoch:1.000 - critic/score/mean:0.618 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.618 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.008 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.008 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:179.657 - response_length/max:1090.000 - response_length/min:39.000 - response_length/clip_ratio:0.000 - prompt_length/mean:457.516 - prompt_length/max:509.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:17.583 - timing_s/reshard:4.650 - timing_s/gen:22.798 - timing_s/reward:0.158 - timing_s/old_log_prob:7.307 - timing_s/ref:7.189 - timing_s/adv:0.021 - timing_s/update_actor:21.658 - timing_s/dump_rollout_generations:0.267 - timing_s/step:59.430 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:652465.000 - perf/time_per_step:59.430 - perf/throughput:1372.331
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/97.jsonl
step:97 - global_seqlen/min:77027.000 - global_seqlen/max:83748.000 - global_seqlen/minmax_diff:6721.000 - global_seqlen/balanced_min:80833.000 - global_seqlen/balanced_max:81604.000 - global_seqlen/mean:80930.000 - actor/entropy_loss:1.471 - training/rollout_probs_diff_max:0.991 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.029 - actor/kl_coef:0.010 - actor/pg_loss:0.038 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.406 - perf/mfu/actor:0.183 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:123.874 - actor/lr:0.000 - training/global_step:97.000 - training/epoch:1.000 - critic/score/mean:0.638 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.638 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:173.938 - response_length/max:1430.000 - response_length/min:29.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.328 - prompt_length/max:519.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:19.359 - timing_s/reshard:4.690 - timing_s/gen:24.596 - timing_s/reward:0.156 - timing_s/old_log_prob:7.397 - timing_s/ref:7.227 - timing_s/adv:0.019 - timing_s/update_actor:21.296 - timing_s/dump_rollout_generations:0.267 - timing_s/step:60.990 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.138 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:647440.000 - perf/time_per_step:60.990 - perf/throughput:1326.938
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/98.jsonl
step:98 - global_seqlen/min:78913.000 - global_seqlen/max:84581.000 - global_seqlen/minmax_diff:5668.000 - global_seqlen/balanced_min:81214.000 - global_seqlen/balanced_max:82641.000 - global_seqlen/mean:81570.875 - actor/entropy_loss:1.412 - training/rollout_probs_diff_max:0.962 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.029 - actor/kl_coef:0.010 - actor/pg_loss:0.170 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.699 - perf/mfu/actor:0.182 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:123.202 - actor/lr:0.000 - training/global_step:98.000 - training/epoch:1.000 - critic/score/mean:0.612 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.612 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.049 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.049 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:177.585 - response_length/max:2048.000 - response_length/min:22.000 - response_length/clip_ratio:0.002 - prompt_length/mean:459.688 - prompt_length/max:523.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:23.732 - timing_s/reshard:5.269 - timing_s/gen:29.583 - timing_s/reward:0.162 - timing_s/old_log_prob:7.302 - timing_s/ref:7.231 - timing_s/adv:0.025 - timing_s/update_actor:21.556 - timing_s/dump_rollout_generations:0.293 - timing_s/step:66.185 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.163 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:652567.000 - perf/time_per_step:66.185 - perf/throughput:1232.474
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/99.jsonl
step:99 - global_seqlen/min:80241.000 - global_seqlen/max:87438.000 - global_seqlen/minmax_diff:7197.000 - global_seqlen/balanced_min:83019.000 - global_seqlen/balanced_max:83466.000 - global_seqlen/mean:83104.375 - actor/entropy_loss:1.516 - training/rollout_probs_diff_max:0.945 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.019 - actor/kl_coef:0.010 - actor/pg_loss:0.054 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.430 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:123.865 - actor/lr:0.000 - training/global_step:99.000 - training/epoch:1.000 - critic/score/mean:0.594 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.594 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.010 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:187.519 - response_length/max:1176.000 - response_length/min:29.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.734 - prompt_length/max:498.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:18.200 - timing_s/reshard:7.359 - timing_s/gen:26.125 - timing_s/reward:0.161 - timing_s/old_log_prob:7.281 - timing_s/ref:7.189 - timing_s/adv:0.021 - timing_s/update_actor:22.417 - timing_s/dump_rollout_generations:0.261 - timing_s/step:63.486 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.136 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:664835.000 - perf/time_per_step:63.486 - perf/throughput:1309.010
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/100.jsonl
step:100 - global_seqlen/min:79851.000 - global_seqlen/max:82491.000 - global_seqlen/minmax_diff:2640.000 - global_seqlen/balanced_min:81160.000 - global_seqlen/balanced_max:81161.000 - global_seqlen/mean:81160.625 - actor/entropy_loss:1.468 - training/rollout_probs_diff_max:0.998 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.045 - actor/kl_coef:0.010 - actor/pg_loss:0.036 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.530 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:124.407 - actor/lr:0.000 - training/global_step:100.000 - training/epoch:1.000 - critic/score/mean:0.661 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.661 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.012 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.012 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:175.356 - response_length/max:472.000 - response_length/min:36.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.711 - prompt_length/max:503.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.878 - timing_s/reshard:5.980 - timing_s/gen:20.411 - timing_s/reward:0.160 - timing_s/old_log_prob:7.276 - timing_s/ref:7.180 - timing_s/adv:0.021 - timing_s/update_actor:22.458 - timing_s/dump_rollout_generations:0.266 - timing_s/step:57.805 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.114 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:649285.000 - perf/time_per_step:57.805 - perf/throughput:1404.040
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/101.jsonl
step:101 - global_seqlen/min:78659.000 - global_seqlen/max:85231.000 - global_seqlen/minmax_diff:6572.000 - global_seqlen/balanced_min:81950.000 - global_seqlen/balanced_max:83391.000 - global_seqlen/mean:82130.250 - actor/entropy_loss:1.462 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.022 - actor/kl_coef:0.010 - actor/pg_loss:0.167 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.488 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:124.284 - actor/lr:0.000 - training/global_step:101.000 - training/epoch:1.000 - critic/score/mean:0.626 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.626 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.024 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.024 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:180.650 - response_length/max:2048.000 - response_length/min:48.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.992 - prompt_length/max:496.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.449 - timing_s/reshard:6.493 - timing_s/gen:30.188 - timing_s/reward:0.160 - timing_s/old_log_prob:7.151 - timing_s/ref:7.039 - timing_s/adv:0.022 - timing_s/update_actor:22.238 - timing_s/dump_rollout_generations:0.267 - timing_s/step:67.099 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.163 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:657042.000 - perf/time_per_step:67.099 - perf/throughput:1224.019
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/102.jsonl
step:102 - global_seqlen/min:79786.000 - global_seqlen/max:84835.000 - global_seqlen/minmax_diff:5049.000 - global_seqlen/balanced_min:81897.000 - global_seqlen/balanced_max:82493.000 - global_seqlen/mean:81971.875 - actor/entropy_loss:1.423 - training/rollout_probs_diff_max:0.996 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.032 - actor/kl_coef:0.010 - actor/pg_loss:-0.010 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.521 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:125.130 - actor/lr:0.000 - training/global_step:102.000 - training/epoch:1.000 - critic/score/mean:0.560 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.560 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:180.374 - response_length/max:1308.000 - response_length/min:23.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.031 - prompt_length/max:490.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:18.549 - timing_s/reshard:4.062 - timing_s/gen:23.826 - timing_s/reward:0.158 - timing_s/old_log_prob:7.454 - timing_s/ref:7.364 - timing_s/adv:0.026 - timing_s/update_actor:22.543 - timing_s/dump_rollout_generations:0.265 - timing_s/step:61.668 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.129 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:655775.000 - perf/time_per_step:61.668 - perf/throughput:1329.249
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/103.jsonl
step:103 - global_seqlen/min:77219.000 - global_seqlen/max:83284.000 - global_seqlen/minmax_diff:6065.000 - global_seqlen/balanced_min:80159.000 - global_seqlen/balanced_max:81595.000 - global_seqlen/mean:80338.875 - actor/entropy_loss:1.395 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.036 - actor/kl_coef:0.010 - actor/pg_loss:0.074 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.436 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:125.219 - actor/lr:0.000 - training/global_step:103.000 - training/epoch:1.000 - critic/score/mean:0.596 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.596 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.025 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.025 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:168.749 - response_length/max:2048.000 - response_length/min:41.000 - response_length/clip_ratio:0.001 - prompt_length/mean:458.898 - prompt_length/max:520.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.432 - timing_s/reshard:4.132 - timing_s/gen:27.134 - timing_s/reward:0.156 - timing_s/old_log_prob:7.307 - timing_s/ref:7.217 - timing_s/adv:0.024 - timing_s/update_actor:22.467 - timing_s/dump_rollout_generations:0.293 - timing_s/step:64.631 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.157 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:642711.000 - perf/time_per_step:64.631 - perf/throughput:1243.034
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/104.jsonl
step:104 - global_seqlen/min:77480.000 - global_seqlen/max:82528.000 - global_seqlen/minmax_diff:5048.000 - global_seqlen/balanced_min:80504.000 - global_seqlen/balanced_max:80505.000 - global_seqlen/mean:80504.375 - actor/entropy_loss:1.384 - training/rollout_probs_diff_max:0.956 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.034 - actor/kl_coef:0.010 - actor/pg_loss:0.068 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.409 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:125.549 - actor/lr:0.000 - training/global_step:104.000 - training/epoch:1.000 - critic/score/mean:0.652 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.652 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:167.862 - response_length/max:512.000 - response_length/min:34.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.078 - prompt_length/max:524.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.537 - timing_s/reshard:4.128 - timing_s/gen:19.464 - timing_s/reward:0.156 - timing_s/old_log_prob:7.213 - timing_s/ref:7.084 - timing_s/adv:0.021 - timing_s/update_actor:22.554 - timing_s/dump_rollout_generations:0.272 - timing_s/step:56.796 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:644035.000 - perf/time_per_step:56.796 - perf/throughput:1417.422
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/105.jsonl
step:105 - global_seqlen/min:78402.000 - global_seqlen/max:83292.000 - global_seqlen/minmax_diff:4890.000 - global_seqlen/balanced_min:81138.000 - global_seqlen/balanced_max:82485.000 - global_seqlen/mean:81306.500 - actor/entropy_loss:1.392 - training/rollout_probs_diff_max:0.992 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.039 - actor/kl_coef:0.010 - actor/pg_loss:0.132 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.704 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:124.947 - actor/lr:0.000 - training/global_step:105.000 - training/epoch:1.000 - critic/score/mean:0.574 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.574 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.023 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.023 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:171.043 - response_length/max:2048.000 - response_length/min:19.000 - response_length/clip_ratio:0.001 - prompt_length/mean:464.164 - prompt_length/max:535.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.930 - timing_s/reshard:4.114 - timing_s/gen:26.581 - timing_s/reward:0.157 - timing_s/old_log_prob:7.343 - timing_s/ref:7.128 - timing_s/adv:0.021 - timing_s/update_actor:22.768 - timing_s/dump_rollout_generations:0.264 - timing_s/step:64.295 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.152 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:650452.000 - perf/time_per_step:64.295 - perf/throughput:1264.584
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/106.jsonl
step:106 - global_seqlen/min:76417.000 - global_seqlen/max:83280.000 - global_seqlen/minmax_diff:6863.000 - global_seqlen/balanced_min:79489.000 - global_seqlen/balanced_max:79490.000 - global_seqlen/mean:79489.875 - actor/entropy_loss:1.354 - training/rollout_probs_diff_max:0.997 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.028 - actor/kl_coef:0.010 - actor/pg_loss:0.017 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.448 - perf/mfu/actor:0.182 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:125.869 - actor/lr:0.000 - training/global_step:106.000 - training/epoch:1.000 - critic/score/mean:0.697 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.697 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:163.624 - response_length/max:454.000 - response_length/min:27.000 - response_length/clip_ratio:0.000 - prompt_length/mean:457.391 - prompt_length/max:509.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.362 - timing_s/reshard:4.059 - timing_s/gen:18.967 - timing_s/reward:0.153 - timing_s/old_log_prob:7.240 - timing_s/ref:7.152 - timing_s/adv:0.021 - timing_s/update_actor:21.075 - timing_s/dump_rollout_generations:0.269 - timing_s/step:54.906 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:635919.000 - perf/time_per_step:54.906 - perf/throughput:1447.739
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/107.jsonl
step:107 - global_seqlen/min:77967.000 - global_seqlen/max:84840.000 - global_seqlen/minmax_diff:6873.000 - global_seqlen/balanced_min:80467.000 - global_seqlen/balanced_max:80468.000 - global_seqlen/mean:80467.375 - actor/entropy_loss:1.342 - training/rollout_probs_diff_max:0.989 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.033 - actor/kl_coef:0.010 - actor/pg_loss:0.009 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.722 - perf/mfu/actor:0.187 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:127.400 - actor/lr:0.000 - training/global_step:107.000 - training/epoch:1.000 - critic/score/mean:0.609 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.609 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.010 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:167.167 - response_length/max:574.000 - response_length/min:22.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.484 - prompt_length/max:519.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.579 - timing_s/reshard:4.170 - timing_s/gen:19.991 - timing_s/reward:0.155 - timing_s/old_log_prob:7.276 - timing_s/ref:7.125 - timing_s/adv:0.020 - timing_s/update_actor:20.703 - timing_s/dump_rollout_generations:0.263 - timing_s/step:55.565 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.032 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:643739.000 - perf/time_per_step:55.565 - perf/throughput:1448.172
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/108.jsonl
step:108 - global_seqlen/min:76859.000 - global_seqlen/max:80907.000 - global_seqlen/minmax_diff:4048.000 - global_seqlen/balanced_min:78862.000 - global_seqlen/balanced_max:78863.000 - global_seqlen/mean:78862.875 - actor/entropy_loss:1.270 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.037 - actor/kl_coef:0.010 - actor/pg_loss:0.047 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.417 - perf/mfu/actor:0.179 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:127.212 - actor/lr:0.000 - training/global_step:108.000 - training/epoch:1.000 - critic/score/mean:0.621 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.621 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:156.468 - response_length/max:524.000 - response_length/min:41.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.648 - prompt_length/max:495.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.866 - timing_s/reshard:4.087 - timing_s/gen:19.152 - timing_s/reward:0.177 - timing_s/old_log_prob:7.253 - timing_s/ref:6.975 - timing_s/adv:0.021 - timing_s/update_actor:21.150 - timing_s/dump_rollout_generations:0.293 - timing_s/step:55.055 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.120 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:630903.000 - perf/time_per_step:55.055 - perf/throughput:1432.429
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/109.jsonl
step:109 - global_seqlen/min:77375.000 - global_seqlen/max:84003.000 - global_seqlen/minmax_diff:6628.000 - global_seqlen/balanced_min:79391.000 - global_seqlen/balanced_max:80849.000 - global_seqlen/mean:79573.250 - actor/entropy_loss:1.286 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.029 - actor/kl_coef:0.010 - actor/pg_loss:0.087 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.364 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:127.221 - actor/lr:0.000 - training/global_step:109.000 - training/epoch:1.000 - critic/score/mean:0.588 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.588 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.028 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.028 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:161.869 - response_length/max:2048.000 - response_length/min:30.000 - response_length/clip_ratio:0.001 - prompt_length/mean:459.797 - prompt_length/max:508.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.596 - timing_s/reshard:4.779 - timing_s/gen:28.729 - timing_s/reward:0.156 - timing_s/old_log_prob:7.147 - timing_s/ref:7.005 - timing_s/adv:0.021 - timing_s/update_actor:21.795 - timing_s/dump_rollout_generations:0.265 - timing_s/step:65.154 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.173 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:636586.000 - perf/time_per_step:65.154 - perf/throughput:1221.309
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/110.jsonl
step:110 - global_seqlen/min:77022.000 - global_seqlen/max:80913.000 - global_seqlen/minmax_diff:3891.000 - global_seqlen/balanced_min:78661.000 - global_seqlen/balanced_max:80125.000 - global_seqlen/mean:79027.500 - actor/entropy_loss:1.234 - training/rollout_probs_diff_max:0.998 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.028 - actor/kl_coef:0.010 - actor/pg_loss:0.097 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.925 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:127.412 - actor/lr:0.000 - training/global_step:110.000 - training/epoch:1.000 - critic/score/mean:0.669 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.669 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.057 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.057 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:158.598 - response_length/max:2048.000 - response_length/min:15.000 - response_length/clip_ratio:0.002 - prompt_length/mean:458.805 - prompt_length/max:507.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.340 - timing_s/reshard:4.134 - timing_s/gen:27.006 - timing_s/reward:0.152 - timing_s/old_log_prob:7.382 - timing_s/ref:7.284 - timing_s/adv:0.022 - timing_s/update_actor:21.642 - timing_s/dump_rollout_generations:0.261 - timing_s/step:63.778 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.166 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:632220.000 - perf/time_per_step:63.778 - perf/throughput:1239.096
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/111.jsonl
step:111 - global_seqlen/min:76698.000 - global_seqlen/max:81026.000 - global_seqlen/minmax_diff:4328.000 - global_seqlen/balanced_min:78280.000 - global_seqlen/balanced_max:79744.000 - global_seqlen/mean:78463.750 - actor/entropy_loss:1.182 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.027 - actor/kl_coef:0.010 - actor/pg_loss:0.058 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.509 - perf/mfu/actor:0.168 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:127.381 - actor/lr:0.000 - training/global_step:111.000 - training/epoch:1.000 - critic/score/mean:0.578 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.578 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.027 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.027 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:152.896 - response_length/max:2048.000 - response_length/min:39.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.102 - prompt_length/max:503.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.782 - timing_s/reshard:4.176 - timing_s/gen:26.496 - timing_s/reward:0.152 - timing_s/old_log_prob:7.342 - timing_s/ref:7.189 - timing_s/adv:0.022 - timing_s/update_actor:22.459 - timing_s/dump_rollout_generations:0.264 - timing_s/step:63.955 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.169 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:627710.000 - perf/time_per_step:63.955 - perf/throughput:1226.868
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/112.jsonl
step:112 - global_seqlen/min:76267.000 - global_seqlen/max:82547.000 - global_seqlen/minmax_diff:6280.000 - global_seqlen/balanced_min:79029.000 - global_seqlen/balanced_max:79030.000 - global_seqlen/mean:79029.500 - actor/entropy_loss:1.205 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.028 - actor/kl_coef:0.010 - actor/pg_loss:0.017 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.615 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:127.649 - actor/lr:0.000 - training/global_step:112.000 - training/epoch:1.000 - critic/score/mean:0.562 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.562 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:156.598 - response_length/max:415.000 - response_length/min:32.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.820 - prompt_length/max:512.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.497 - timing_s/reshard:4.079 - timing_s/gen:18.126 - timing_s/reward:0.152 - timing_s/old_log_prob:7.066 - timing_s/ref:7.061 - timing_s/adv:0.020 - timing_s/update_actor:21.998 - timing_s/dump_rollout_generations:0.295 - timing_s/step:54.750 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:632236.000 - perf/time_per_step:54.750 - perf/throughput:1443.461
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/113.jsonl
step:113 - global_seqlen/min:76606.000 - global_seqlen/max:79976.000 - global_seqlen/minmax_diff:3370.000 - global_seqlen/balanced_min:77881.000 - global_seqlen/balanced_max:77882.000 - global_seqlen/mean:77881.750 - actor/entropy_loss:1.207 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.032 - actor/kl_coef:0.010 - actor/pg_loss:-0.002 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.471 - perf/mfu/actor:0.168 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:127.803 - actor/lr:0.000 - training/global_step:113.000 - training/epoch:1.000 - critic/score/mean:0.557 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.557 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:146.662 - response_length/max:417.000 - response_length/min:31.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.789 - prompt_length/max:504.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.991 - timing_s/reshard:4.077 - timing_s/gen:18.312 - timing_s/reward:0.559 - timing_s/old_log_prob:7.378 - timing_s/ref:7.113 - timing_s/adv:0.020 - timing_s/update_actor:22.267 - timing_s/dump_rollout_generations:0.265 - timing_s/step:55.944 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.122 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:623054.000 - perf/time_per_step:55.944 - perf/throughput:1392.138
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/114.jsonl
step:114 - global_seqlen/min:75646.000 - global_seqlen/max:81767.000 - global_seqlen/minmax_diff:6121.000 - global_seqlen/balanced_min:78899.000 - global_seqlen/balanced_max:78900.000 - global_seqlen/mean:78899.500 - actor/entropy_loss:1.179 - training/rollout_probs_diff_max:0.985 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.027 - actor/kl_coef:0.010 - actor/pg_loss:0.011 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.463 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:127.723 - actor/lr:0.000 - training/global_step:114.000 - training/epoch:1.000 - critic/score/mean:0.547 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.547 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:154.301 - response_length/max:477.000 - response_length/min:32.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.102 - prompt_length/max:517.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.452 - timing_s/reshard:4.110 - timing_s/gen:18.815 - timing_s/reward:0.154 - timing_s/old_log_prob:7.196 - timing_s/ref:7.037 - timing_s/adv:0.020 - timing_s/update_actor:22.169 - timing_s/dump_rollout_generations:0.256 - timing_s/step:55.677 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.119 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:631196.000 - perf/time_per_step:55.677 - perf/throughput:1417.095
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/115.jsonl
step:115 - global_seqlen/min:74325.000 - global_seqlen/max:80732.000 - global_seqlen/minmax_diff:6407.000 - global_seqlen/balanced_min:78349.000 - global_seqlen/balanced_max:78350.000 - global_seqlen/mean:78349.375 - actor/entropy_loss:1.151 - training/rollout_probs_diff_max:0.993 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.036 - actor/kl_coef:0.010 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.613 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:128.485 - actor/lr:0.000 - training/global_step:115.000 - training/epoch:1.000 - critic/score/mean:0.543 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.543 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:151.558 - response_length/max:396.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.547 - prompt_length/max:491.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.137 - timing_s/reshard:4.483 - timing_s/gen:18.200 - timing_s/reward:0.152 - timing_s/old_log_prob:7.212 - timing_s/ref:6.955 - timing_s/adv:0.020 - timing_s/update_actor:21.434 - timing_s/dump_rollout_generations:0.264 - timing_s/step:54.270 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:626795.000 - perf/time_per_step:54.270 - perf/throughput:1443.685
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/116.jsonl
step:116 - global_seqlen/min:74571.000 - global_seqlen/max:80400.000 - global_seqlen/minmax_diff:5829.000 - global_seqlen/balanced_min:77044.000 - global_seqlen/balanced_max:77045.000 - global_seqlen/mean:77044.500 - actor/entropy_loss:1.166 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.031 - actor/kl_coef:0.010 - actor/pg_loss:0.024 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.681 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:128.427 - actor/lr:0.000 - training/global_step:116.000 - training/epoch:1.000 - critic/score/mean:0.579 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.579 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.008 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.008 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:143.363 - response_length/max:439.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.547 - prompt_length/max:517.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.407 - timing_s/reshard:7.623 - timing_s/gen:21.589 - timing_s/reward:0.149 - timing_s/old_log_prob:7.322 - timing_s/ref:7.235 - timing_s/adv:0.020 - timing_s/update_actor:21.612 - timing_s/dump_rollout_generations:0.284 - timing_s/step:58.245 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.147 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:616356.000 - perf/time_per_step:58.245 - perf/throughput:1322.762
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/117.jsonl
step:117 - global_seqlen/min:76793.000 - global_seqlen/max:82665.000 - global_seqlen/minmax_diff:5872.000 - global_seqlen/balanced_min:79419.000 - global_seqlen/balanced_max:80851.000 - global_seqlen/mean:79598.250 - actor/entropy_loss:1.139 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.031 - actor/kl_coef:0.010 - actor/pg_loss:0.108 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.492 - perf/mfu/actor:0.179 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:129.835 - actor/lr:0.000 - training/global_step:117.000 - training/epoch:1.000 - critic/score/mean:0.529 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.529 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.031 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.031 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:158.643 - response_length/max:2048.000 - response_length/min:46.000 - response_length/clip_ratio:0.001 - prompt_length/mean:463.219 - prompt_length/max:511.000 - prompt_length/min:436.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.248 - timing_s/reshard:7.950 - timing_s/gen:31.476 - timing_s/reward:0.154 - timing_s/old_log_prob:7.117 - timing_s/ref:7.067 - timing_s/adv:0.022 - timing_s/update_actor:21.438 - timing_s/dump_rollout_generations:0.268 - timing_s/step:67.570 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.194 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:636786.000 - perf/time_per_step:67.570 - perf/throughput:1178.007
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/118.jsonl
step:118 - global_seqlen/min:73204.000 - global_seqlen/max:81017.000 - global_seqlen/minmax_diff:7813.000 - global_seqlen/balanced_min:77701.000 - global_seqlen/balanced_max:77702.000 - global_seqlen/mean:77701.375 - actor/entropy_loss:1.174 - training/rollout_probs_diff_max:0.996 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.042 - actor/kl_coef:0.010 - actor/pg_loss:0.028 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.838 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:130.270 - actor/lr:0.000 - training/global_step:118.000 - training/epoch:1.000 - critic/score/mean:0.627 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.627 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:146.261 - response_length/max:407.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.781 - prompt_length/max:526.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.927 - timing_s/reshard:4.102 - timing_s/gen:17.583 - timing_s/reward:0.150 - timing_s/old_log_prob:7.368 - timing_s/ref:7.200 - timing_s/adv:0.019 - timing_s/update_actor:21.280 - timing_s/dump_rollout_generations:0.260 - timing_s/step:53.894 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:621611.000 - perf/time_per_step:53.894 - perf/throughput:1441.741
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/119.jsonl
step:119 - global_seqlen/min:75669.000 - global_seqlen/max:80602.000 - global_seqlen/minmax_diff:4933.000 - global_seqlen/balanced_min:77433.000 - global_seqlen/balanced_max:78900.000 - global_seqlen/mean:77616.875 - actor/entropy_loss:1.132 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.029 - actor/kl_coef:0.010 - actor/pg_loss:0.072 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.549 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:130.362 - actor/lr:0.000 - training/global_step:119.000 - training/epoch:1.000 - critic/score/mean:0.654 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.654 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.034 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.034 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:148.249 - response_length/max:2048.000 - response_length/min:43.000 - response_length/clip_ratio:0.001 - prompt_length/mean:458.133 - prompt_length/max:514.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.897 - timing_s/reshard:6.740 - timing_s/gen:29.894 - timing_s/reward:0.152 - timing_s/old_log_prob:7.142 - timing_s/ref:6.939 - timing_s/adv:0.038 - timing_s/update_actor:21.026 - timing_s/dump_rollout_generations:0.262 - timing_s/step:65.482 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.197 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:620935.000 - perf/time_per_step:65.482 - perf/throughput:1185.314
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/120.jsonl
local_global_step_folder: ../ckpt/checkpoints/global_step_120
step:120 - global_seqlen/min:76223.000 - global_seqlen/max:79148.000 - global_seqlen/minmax_diff:2925.000 - global_seqlen/balanced_min:78154.000 - global_seqlen/balanced_max:78154.000 - global_seqlen/mean:78154.000 - actor/entropy_loss:1.206 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.034 - actor/kl_coef:0.010 - actor/pg_loss:-0.008 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.607 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:131.412 - actor/lr:0.000 - training/global_step:120.000 - training/epoch:1.000 - critic/score/mean:0.612 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.612 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.000 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:148.773 - response_length/max:409.000 - response_length/min:41.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.805 - prompt_length/max:506.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.201 - timing_s/reshard:4.137 - timing_s/gen:17.882 - timing_s/reward:0.153 - timing_s/old_log_prob:7.044 - timing_s/ref:7.010 - timing_s/adv:0.020 - timing_s/update_actor:21.526 - timing_s/dump_rollout_generations:0.260 - timing_s/save_checkpoint:29.914 - timing_s/step:83.840 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:625232.000 - perf/time_per_step:83.840 - perf/throughput:932.181
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/121.jsonl
step:121 - global_seqlen/min:75196.000 - global_seqlen/max:80273.000 - global_seqlen/minmax_diff:5077.000 - global_seqlen/balanced_min:77410.000 - global_seqlen/balanced_max:77411.000 - global_seqlen/mean:77410.750 - actor/entropy_loss:1.159 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.045 - actor/kl_coef:0.010 - actor/pg_loss:0.067 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.930 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:140.928 - actor/lr:0.000 - training/global_step:121.000 - training/epoch:1.000 - critic/score/mean:0.638 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.638 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:145.357 - response_length/max:395.000 - response_length/min:35.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.414 - prompt_length/max:499.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.218 - timing_s/reshard:6.318 - timing_s/gen:22.074 - timing_s/reward:0.150 - timing_s/old_log_prob:7.305 - timing_s/ref:7.246 - timing_s/adv:0.020 - timing_s/update_actor:20.872 - timing_s/dump_rollout_generations:0.260 - timing_s/step:57.973 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.148 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:619286.000 - perf/time_per_step:57.973 - perf/throughput:1335.285
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/122.jsonl
step:122 - global_seqlen/min:76578.000 - global_seqlen/max:80460.000 - global_seqlen/minmax_diff:3882.000 - global_seqlen/balanced_min:77716.000 - global_seqlen/balanced_max:77717.000 - global_seqlen/mean:77716.375 - actor/entropy_loss:1.181 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.032 - actor/kl_coef:0.010 - actor/pg_loss:-0.046 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.518 - perf/mfu/actor:0.169 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:133.793 - actor/lr:0.000 - training/global_step:122.000 - training/epoch:1.000 - critic/score/mean:0.619 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.619 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.007 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:147.237 - response_length/max:407.000 - response_length/min:33.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.922 - prompt_length/max:517.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.330 - timing_s/reshard:7.639 - timing_s/gen:21.519 - timing_s/reward:0.175 - timing_s/old_log_prob:7.170 - timing_s/ref:7.015 - timing_s/adv:0.020 - timing_s/update_actor:22.088 - timing_s/dump_rollout_generations:0.262 - timing_s/step:58.281 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.143 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:621731.000 - perf/time_per_step:58.281 - perf/throughput:1333.467
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/123.jsonl
step:123 - global_seqlen/min:74406.000 - global_seqlen/max:81324.000 - global_seqlen/minmax_diff:6918.000 - global_seqlen/balanced_min:77944.000 - global_seqlen/balanced_max:77945.000 - global_seqlen/mean:77944.750 - actor/entropy_loss:1.160 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.030 - actor/kl_coef:0.010 - actor/pg_loss:0.021 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.859 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:132.290 - actor/lr:0.000 - training/global_step:123.000 - training/epoch:1.000 - critic/score/mean:0.574 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.574 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.010 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:147.076 - response_length/max:435.000 - response_length/min:27.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.867 - prompt_length/max:500.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.128 - timing_s/reshard:8.373 - timing_s/gen:22.052 - timing_s/reward:0.151 - timing_s/old_log_prob:7.062 - timing_s/ref:6.819 - timing_s/adv:0.020 - timing_s/update_actor:22.016 - timing_s/dump_rollout_generations:0.263 - timing_s/step:58.418 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.146 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:623558.000 - perf/time_per_step:58.418 - perf/throughput:1334.257
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/124.jsonl
step:124 - global_seqlen/min:75878.000 - global_seqlen/max:79695.000 - global_seqlen/minmax_diff:3817.000 - global_seqlen/balanced_min:77666.000 - global_seqlen/balanced_max:77667.000 - global_seqlen/mean:77666.250 - actor/entropy_loss:1.137 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.037 - actor/kl_coef:0.010 - actor/pg_loss:-0.008 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.691 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:132.290 - actor/lr:0.000 - training/global_step:124.000 - training/epoch:1.000 - critic/score/mean:0.608 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.608 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.000 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:144.533 - response_length/max:399.000 - response_length/min:32.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.234 - prompt_length/max:526.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.024 - timing_s/reshard:8.437 - timing_s/gen:22.013 - timing_s/reward:0.149 - timing_s/old_log_prob:7.149 - timing_s/ref:7.102 - timing_s/adv:0.021 - timing_s/update_actor:21.436 - timing_s/dump_rollout_generations:0.264 - timing_s/step:58.167 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.149 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:621330.000 - perf/time_per_step:58.167 - perf/throughput:1335.220
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/125.jsonl
step:125 - global_seqlen/min:75921.000 - global_seqlen/max:80178.000 - global_seqlen/minmax_diff:4257.000 - global_seqlen/balanced_min:78182.000 - global_seqlen/balanced_max:78183.000 - global_seqlen/mean:78182.625 - actor/entropy_loss:1.125 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.030 - actor/kl_coef:0.010 - actor/pg_loss:-0.017 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.537 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:132.287 - actor/lr:0.000 - training/global_step:125.000 - training/epoch:1.000 - critic/score/mean:0.597 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.597 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:146.974 - response_length/max:513.000 - response_length/min:19.000 - response_length/clip_ratio:0.000 - prompt_length/mean:463.828 - prompt_length/max:505.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.048 - timing_s/reshard:5.973 - timing_s/gen:20.592 - timing_s/reward:0.150 - timing_s/old_log_prob:7.140 - timing_s/ref:7.056 - timing_s/adv:0.020 - timing_s/update_actor:21.681 - timing_s/dump_rollout_generations:0.261 - timing_s/step:56.932 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.137 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:625461.000 - perf/time_per_step:56.932 - perf/throughput:1373.268
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/126.jsonl
step:126 - global_seqlen/min:73790.000 - global_seqlen/max:79995.000 - global_seqlen/minmax_diff:6205.000 - global_seqlen/balanced_min:76219.000 - global_seqlen/balanced_max:76220.000 - global_seqlen/mean:76219.375 - actor/entropy_loss:1.097 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.030 - actor/kl_coef:0.010 - actor/pg_loss:0.019 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.387 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:132.572 - actor/lr:0.000 - training/global_step:126.000 - training/epoch:1.000 - critic/score/mean:0.595 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.595 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.005 - critic/advantages/max:0.540 - critic/advantages/min:-2.475 - critic/returns/mean:-0.005 - critic/returns/max:0.540 - critic/returns/min:-2.475 - response_length/mean:135.159 - response_length/max:389.000 - response_length/min:27.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.305 - prompt_length/max:540.000 - prompt_length/min:430.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.331 - timing_s/reshard:4.616 - timing_s/gen:18.517 - timing_s/reward:0.147 - timing_s/old_log_prob:7.285 - timing_s/ref:7.131 - timing_s/adv:0.019 - timing_s/update_actor:21.456 - timing_s/dump_rollout_generations:0.259 - timing_s/step:54.846 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.134 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:609755.000 - perf/time_per_step:54.846 - perf/throughput:1389.707
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/127.jsonl
step:127 - global_seqlen/min:74529.000 - global_seqlen/max:78326.000 - global_seqlen/minmax_diff:3797.000 - global_seqlen/balanced_min:76098.000 - global_seqlen/balanced_max:76099.000 - global_seqlen/mean:76098.875 - actor/entropy_loss:1.083 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.051 - actor/kl_coef:0.010 - actor/pg_loss:-0.009 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.549 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:132.746 - actor/lr:0.000 - training/global_step:127.000 - training/epoch:1.000 - critic/score/mean:0.667 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.667 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:132.327 - response_length/max:371.000 - response_length/min:37.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.195 - prompt_length/max:512.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.948 - timing_s/reshard:4.153 - timing_s/gen:18.275 - timing_s/reward:0.147 - timing_s/old_log_prob:7.110 - timing_s/ref:7.045 - timing_s/adv:0.020 - timing_s/update_actor:21.264 - timing_s/dump_rollout_generations:0.260 - timing_s/step:54.154 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.135 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:608791.000 - perf/time_per_step:54.154 - perf/throughput:1405.223
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/128.jsonl
step:128 - global_seqlen/min:76044.000 - global_seqlen/max:79336.000 - global_seqlen/minmax_diff:3292.000 - global_seqlen/balanced_min:76858.000 - global_seqlen/balanced_max:76859.000 - global_seqlen/mean:76858.875 - actor/entropy_loss:1.094 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.047 - actor/kl_coef:0.010 - actor/pg_loss:-0.026 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.814 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:132.421 - actor/lr:0.000 - training/global_step:128.000 - training/epoch:1.000 - critic/score/mean:0.619 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.619 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:138.593 - response_length/max:454.000 - response_length/min:37.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.867 - prompt_length/max:506.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.849 - timing_s/reshard:4.129 - timing_s/gen:18.200 - timing_s/reward:0.151 - timing_s/old_log_prob:7.239 - timing_s/ref:7.059 - timing_s/adv:0.022 - timing_s/update_actor:20.881 - timing_s/dump_rollout_generations:0.259 - timing_s/step:53.840 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.128 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:614871.000 - perf/time_per_step:53.840 - perf/throughput:1427.555
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/129.jsonl
step:129 - global_seqlen/min:74814.000 - global_seqlen/max:77312.000 - global_seqlen/minmax_diff:2498.000 - global_seqlen/balanced_min:76194.000 - global_seqlen/balanced_max:76195.000 - global_seqlen/mean:76194.125 - actor/entropy_loss:1.096 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.046 - actor/kl_coef:0.010 - actor/pg_loss:0.040 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.994 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:130.333 - actor/lr:0.000 - training/global_step:129.000 - training/epoch:1.000 - critic/score/mean:0.622 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.622 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:135.321 - response_length/max:410.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.945 - prompt_length/max:533.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.873 - timing_s/reshard:4.131 - timing_s/gen:17.538 - timing_s/reward:0.155 - timing_s/old_log_prob:7.244 - timing_s/ref:7.060 - timing_s/adv:0.020 - timing_s/update_actor:21.070 - timing_s/dump_rollout_generations:0.264 - timing_s/step:53.380 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.127 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:609553.000 - perf/time_per_step:53.380 - perf/throughput:1427.381
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/130.jsonl
step:130 - global_seqlen/min:73512.000 - global_seqlen/max:78699.000 - global_seqlen/minmax_diff:5187.000 - global_seqlen/balanced_min:76448.000 - global_seqlen/balanced_max:76448.000 - global_seqlen/mean:76448.000 - actor/entropy_loss:1.121 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.035 - actor/kl_coef:0.010 - actor/pg_loss:0.023 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.372 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:130.294 - actor/lr:0.000 - training/global_step:130.000 - training/epoch:1.000 - critic/score/mean:0.591 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.591 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.010 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.010 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:136.039 - response_length/max:380.000 - response_length/min:34.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.211 - prompt_length/max:509.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.070 - timing_s/reshard:7.844 - timing_s/gen:21.425 - timing_s/reward:0.149 - timing_s/old_log_prob:7.057 - timing_s/ref:7.005 - timing_s/adv:0.020 - timing_s/update_actor:20.780 - timing_s/dump_rollout_generations:0.259 - timing_s/step:56.724 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.154 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:611584.000 - perf/time_per_step:56.724 - perf/throughput:1347.722
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/131.jsonl
step:131 - global_seqlen/min:74423.000 - global_seqlen/max:78333.000 - global_seqlen/minmax_diff:3910.000 - global_seqlen/balanced_min:76731.000 - global_seqlen/balanced_max:76734.000 - global_seqlen/mean:76731.500 - actor/entropy_loss:1.082 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.024 - actor/kl_coef:0.010 - actor/pg_loss:-0.038 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.519 - perf/mfu/actor:0.166 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:130.244 - actor/lr:0.000 - training/global_step:131.000 - training/epoch:1.000 - critic/score/mean:0.580 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.580 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:136.957 - response_length/max:497.000 - response_length/min:22.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.508 - prompt_length/max:508.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.274 - timing_s/reshard:8.440 - timing_s/gen:22.292 - timing_s/reward:0.149 - timing_s/old_log_prob:7.260 - timing_s/ref:6.987 - timing_s/adv:0.020 - timing_s/update_actor:22.178 - timing_s/dump_rollout_generations:0.259 - timing_s/step:59.176 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.159 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:613852.000 - perf/time_per_step:59.176 - perf/throughput:1296.659
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/132.jsonl
step:132 - global_seqlen/min:74771.000 - global_seqlen/max:77153.000 - global_seqlen/minmax_diff:2382.000 - global_seqlen/balanced_min:76032.000 - global_seqlen/balanced_max:76033.000 - global_seqlen/mean:76032.375 - actor/entropy_loss:1.055 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.040 - actor/kl_coef:0.010 - actor/pg_loss:-0.018 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.825 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:130.039 - actor/lr:0.000 - training/global_step:132.000 - training/epoch:1.000 - critic/score/mean:0.594 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.594 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:133.776 - response_length/max:369.000 - response_length/min:32.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.227 - prompt_length/max:497.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.198 - timing_s/reshard:6.696 - timing_s/gen:20.474 - timing_s/reward:0.146 - timing_s/old_log_prob:7.039 - timing_s/ref:6.929 - timing_s/adv:0.020 - timing_s/update_actor:21.490 - timing_s/dump_rollout_generations:0.260 - timing_s/step:56.394 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.149 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:608259.000 - perf/time_per_step:56.394 - perf/throughput:1348.231
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/133.jsonl
step:133 - global_seqlen/min:74394.000 - global_seqlen/max:78502.000 - global_seqlen/minmax_diff:4108.000 - global_seqlen/balanced_min:76117.000 - global_seqlen/balanced_max:76118.000 - global_seqlen/mean:76117.125 - actor/entropy_loss:1.098 - training/rollout_probs_diff_max:0.996 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.038 - actor/kl_coef:0.010 - actor/pg_loss:0.060 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.747 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:129.954 - actor/lr:0.000 - training/global_step:133.000 - training/epoch:1.000 - critic/score/mean:0.556 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.556 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:134.485 - response_length/max:351.000 - response_length/min:29.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.180 - prompt_length/max:523.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.229 - timing_s/reshard:4.435 - timing_s/gen:18.223 - timing_s/reward:0.147 - timing_s/old_log_prob:7.161 - timing_s/ref:6.782 - timing_s/adv:0.020 - timing_s/update_actor:21.503 - timing_s/dump_rollout_generations:0.258 - timing_s/step:54.127 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.132 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:608937.000 - perf/time_per_step:54.127 - perf/throughput:1406.263
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/134.jsonl
step:134 - global_seqlen/min:75063.000 - global_seqlen/max:78742.000 - global_seqlen/minmax_diff:3679.000 - global_seqlen/balanced_min:76730.000 - global_seqlen/balanced_max:76731.000 - global_seqlen/mean:76730.625 - actor/entropy_loss:1.112 - training/rollout_probs_diff_max:0.996 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.025 - actor/kl_coef:0.010 - actor/pg_loss:0.022 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.660 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:129.921 - actor/lr:0.000 - training/global_step:134.000 - training/epoch:1.000 - critic/score/mean:0.568 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.568 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:138.380 - response_length/max:414.000 - response_length/min:20.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.078 - prompt_length/max:502.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.326 - timing_s/reshard:4.141 - timing_s/gen:18.679 - timing_s/reward:0.168 - timing_s/old_log_prob:7.038 - timing_s/ref:6.955 - timing_s/adv:0.020 - timing_s/update_actor:21.679 - timing_s/dump_rollout_generations:0.260 - timing_s/step:54.829 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.132 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:613845.000 - perf/time_per_step:54.829 - perf/throughput:1399.456
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/135.jsonl
step:135 - global_seqlen/min:73545.000 - global_seqlen/max:79973.000 - global_seqlen/minmax_diff:6428.000 - global_seqlen/balanced_min:77969.000 - global_seqlen/balanced_max:77970.000 - global_seqlen/mean:77969.250 - actor/entropy_loss:1.143 - training/rollout_probs_diff_max:0.997 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.031 - actor/kl_coef:0.010 - actor/pg_loss:-0.005 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.423 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:130.169 - actor/lr:0.000 - training/global_step:135.000 - training/epoch:1.000 - critic/score/mean:0.549 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.549 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:147.229 - response_length/max:431.000 - response_length/min:36.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.906 - prompt_length/max:517.000 - prompt_length/min:436.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.402 - timing_s/reshard:4.392 - timing_s/gen:20.285 - timing_s/reward:0.149 - timing_s/old_log_prob:7.130 - timing_s/ref:7.100 - timing_s/adv:0.020 - timing_s/update_actor:21.218 - timing_s/dump_rollout_generations:0.262 - timing_s/step:56.198 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.135 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:623754.000 - perf/time_per_step:56.198 - perf/throughput:1387.408
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/136.jsonl
step:136 - global_seqlen/min:74669.000 - global_seqlen/max:78841.000 - global_seqlen/minmax_diff:4172.000 - global_seqlen/balanced_min:77380.000 - global_seqlen/balanced_max:77381.000 - global_seqlen/mean:77380.875 - actor/entropy_loss:1.075 - training/rollout_probs_diff_max:0.980 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.030 - actor/kl_coef:0.010 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.517 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:130.619 - actor/lr:0.000 - training/global_step:136.000 - training/epoch:1.000 - critic/score/mean:0.716 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.716 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:144.452 - response_length/max:359.000 - response_length/min:45.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.086 - prompt_length/max:514.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.738 - timing_s/reshard:4.138 - timing_s/gen:17.437 - timing_s/reward:0.150 - timing_s/old_log_prob:7.022 - timing_s/ref:6.865 - timing_s/adv:0.027 - timing_s/update_actor:20.934 - timing_s/dump_rollout_generations:0.302 - timing_s/step:52.770 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.118 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:619047.000 - perf/time_per_step:52.770 - perf/throughput:1466.387
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/137.jsonl
step:137 - global_seqlen/min:76752.000 - global_seqlen/max:80239.000 - global_seqlen/minmax_diff:3487.000 - global_seqlen/balanced_min:78002.000 - global_seqlen/balanced_max:78808.000 - global_seqlen/mean:78103.375 - actor/entropy_loss:1.089 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.043 - actor/kl_coef:0.010 - actor/pg_loss:0.097 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.296 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:121.242 - actor/lr:0.000 - training/global_step:137.000 - training/epoch:2.000 - critic/score/mean:0.686 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.686 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.023 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.023 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:148.901 - response_length/max:1402.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.281 - prompt_length/max:499.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:18.458 - timing_s/reshard:4.061 - timing_s/gen:23.806 - timing_s/reward:0.149 - timing_s/old_log_prob:7.368 - timing_s/ref:7.122 - timing_s/adv:0.020 - timing_s/update_actor:21.830 - timing_s/dump_rollout_generations:0.260 - timing_s/step:60.611 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.156 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:624827.000 - perf/time_per_step:60.611 - perf/throughput:1288.610
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/138.jsonl
step:138 - global_seqlen/min:76157.000 - global_seqlen/max:80773.000 - global_seqlen/minmax_diff:4616.000 - global_seqlen/balanced_min:78074.000 - global_seqlen/balanced_max:78075.000 - global_seqlen/mean:78074.875 - actor/entropy_loss:1.099 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.021 - actor/kl_coef:0.010 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.619 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:121.848 - actor/lr:0.000 - training/global_step:138.000 - training/epoch:2.000 - critic/score/mean:0.638 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.638 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:149.054 - response_length/max:383.000 - response_length/min:27.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.906 - prompt_length/max:497.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.112 - timing_s/reshard:4.082 - timing_s/gen:17.728 - timing_s/reward:0.151 - timing_s/old_log_prob:7.420 - timing_s/ref:7.138 - timing_s/adv:0.021 - timing_s/update_actor:21.280 - timing_s/dump_rollout_generations:0.261 - timing_s/step:54.030 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:624599.000 - perf/time_per_step:54.030 - perf/throughput:1445.029
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/139.jsonl
step:139 - global_seqlen/min:77124.000 - global_seqlen/max:81155.000 - global_seqlen/minmax_diff:4031.000 - global_seqlen/balanced_min:78716.000 - global_seqlen/balanced_max:80206.000 - global_seqlen/mean:78902.375 - actor/entropy_loss:1.122 - training/rollout_probs_diff_max:0.993 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.027 - actor/kl_coef:0.010 - actor/pg_loss:0.099 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.324 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:122.240 - actor/lr:0.000 - training/global_step:139.000 - training/epoch:2.000 - critic/score/mean:0.618 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.618 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.027 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.027 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:157.378 - response_length/max:2048.000 - response_length/min:30.000 - response_length/clip_ratio:0.001 - prompt_length/mean:459.047 - prompt_length/max:506.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.978 - timing_s/reshard:6.256 - timing_s/gen:29.489 - timing_s/reward:0.175 - timing_s/old_log_prob:7.323 - timing_s/ref:7.204 - timing_s/adv:0.025 - timing_s/update_actor:21.262 - timing_s/dump_rollout_generations:0.263 - timing_s/step:65.775 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.183 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:631219.000 - perf/time_per_step:65.775 - perf/throughput:1199.584
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/140.jsonl
step:140 - global_seqlen/min:77466.000 - global_seqlen/max:80718.000 - global_seqlen/minmax_diff:3252.000 - global_seqlen/balanced_min:78595.000 - global_seqlen/balanced_max:78596.000 - global_seqlen/mean:78595.125 - actor/entropy_loss:1.111 - training/rollout_probs_diff_max:0.998 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.040 - actor/kl_coef:0.010 - actor/pg_loss:-0.046 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.482 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:122.349 - actor/lr:0.000 - training/global_step:140.000 - training/epoch:2.000 - critic/score/mean:0.643 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.643 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:153.813 - response_length/max:403.000 - response_length/min:45.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.211 - prompt_length/max:492.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.154 - timing_s/reshard:4.152 - timing_s/gen:17.850 - timing_s/reward:0.151 - timing_s/old_log_prob:7.252 - timing_s/ref:6.959 - timing_s/adv:0.019 - timing_s/update_actor:21.877 - timing_s/dump_rollout_generations:0.262 - timing_s/step:54.405 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:628761.000 - perf/time_per_step:54.405 - perf/throughput:1444.638
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/141.jsonl
step:141 - global_seqlen/min:77636.000 - global_seqlen/max:83606.000 - global_seqlen/minmax_diff:5970.000 - global_seqlen/balanced_min:80092.000 - global_seqlen/balanced_max:81590.000 - global_seqlen/mean:80280.000 - actor/entropy_loss:1.109 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.032 - actor/kl_coef:0.010 - actor/pg_loss:0.069 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.452 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:122.903 - actor/lr:0.000 - training/global_step:141.000 - training/epoch:2.000 - critic/score/mean:0.629 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.629 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.036 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.036 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:166.500 - response_length/max:2048.000 - response_length/min:30.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.688 - prompt_length/max:516.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.400 - timing_s/reshard:6.258 - timing_s/gen:29.974 - timing_s/reward:0.155 - timing_s/old_log_prob:7.476 - timing_s/ref:7.216 - timing_s/adv:0.021 - timing_s/update_actor:21.993 - timing_s/dump_rollout_generations:0.267 - timing_s/step:67.142 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.176 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:642240.000 - perf/time_per_step:67.142 - perf/throughput:1195.684
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/142.jsonl
step:142 - global_seqlen/min:77676.000 - global_seqlen/max:81170.000 - global_seqlen/minmax_diff:3494.000 - global_seqlen/balanced_min:79456.000 - global_seqlen/balanced_max:79457.000 - global_seqlen/mean:79456.625 - actor/entropy_loss:1.146 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.033 - actor/kl_coef:0.010 - actor/pg_loss:0.011 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.325 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:123.556 - actor/lr:0.000 - training/global_step:142.000 - training/epoch:2.000 - critic/score/mean:0.664 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.664 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.007 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.007 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:160.388 - response_length/max:447.000 - response_length/min:31.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.367 - prompt_length/max:526.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.194 - timing_s/reshard:4.162 - timing_s/gen:18.570 - timing_s/reward:0.154 - timing_s/old_log_prob:7.174 - timing_s/ref:6.968 - timing_s/adv:0.020 - timing_s/update_actor:21.820 - timing_s/dump_rollout_generations:0.263 - timing_s/step:55.002 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:635653.000 - perf/time_per_step:55.002 - perf/throughput:1444.610
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/143.jsonl
step:143 - global_seqlen/min:77742.000 - global_seqlen/max:82178.000 - global_seqlen/minmax_diff:4436.000 - global_seqlen/balanced_min:79506.000 - global_seqlen/balanced_max:79507.000 - global_seqlen/mean:79506.500 - actor/entropy_loss:1.129 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.056 - actor/kl_coef:0.010 - actor/pg_loss:-0.007 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.933 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:123.832 - actor/lr:0.000 - training/global_step:143.000 - training/epoch:2.000 - critic/score/mean:0.640 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.640 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:160.277 - response_length/max:470.000 - response_length/min:38.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.867 - prompt_length/max:526.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.702 - timing_s/reshard:4.806 - timing_s/gen:19.058 - timing_s/reward:0.155 - timing_s/old_log_prob:7.226 - timing_s/ref:7.126 - timing_s/adv:0.020 - timing_s/update_actor:21.748 - timing_s/dump_rollout_generations:0.261 - timing_s/step:55.625 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:636052.000 - perf/time_per_step:55.625 - perf/throughput:1429.338
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/144.jsonl
step:144 - global_seqlen/min:78410.000 - global_seqlen/max:85314.000 - global_seqlen/minmax_diff:6904.000 - global_seqlen/balanced_min:80878.000 - global_seqlen/balanced_max:80879.000 - global_seqlen/mean:80878.500 - actor/entropy_loss:1.180 - training/rollout_probs_diff_max:0.974 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.041 - actor/kl_coef:0.010 - actor/pg_loss:-0.014 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.305 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.596 - perf/cpu_memory_used_gb:124.248 - actor/lr:0.000 - training/global_step:144.000 - training/epoch:2.000 - critic/score/mean:0.611 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.611 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:170.457 - response_length/max:410.000 - response_length/min:39.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.406 - prompt_length/max:515.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.007 - timing_s/reshard:7.131 - timing_s/gen:21.695 - timing_s/reward:0.157 - timing_s/old_log_prob:7.226 - timing_s/ref:7.154 - timing_s/adv:0.021 - timing_s/update_actor:21.832 - timing_s/dump_rollout_generations:0.266 - timing_s/step:58.382 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:647028.000 - perf/time_per_step:58.382 - perf/throughput:1385.329
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/145.jsonl
step:145 - global_seqlen/min:76537.000 - global_seqlen/max:83266.000 - global_seqlen/minmax_diff:6729.000 - global_seqlen/balanced_min:80094.000 - global_seqlen/balanced_max:81504.000 - global_seqlen/mean:80270.750 - actor/entropy_loss:1.148 - training/rollout_probs_diff_max:0.995 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.050 - actor/kl_coef:0.010 - actor/pg_loss:0.097 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.420 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.670 - perf/cpu_memory_used_gb:124.607 - actor/lr:0.000 - training/global_step:145.000 - training/epoch:2.000 - critic/score/mean:0.595 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.595 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.033 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.033 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:166.021 - response_length/max:2048.000 - response_length/min:20.000 - response_length/clip_ratio:0.001 - prompt_length/mean:461.094 - prompt_length/max:529.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.658 - timing_s/reshard:6.877 - timing_s/gen:30.809 - timing_s/reward:0.153 - timing_s/old_log_prob:7.470 - timing_s/ref:7.316 - timing_s/adv:0.020 - timing_s/update_actor:22.302 - timing_s/dump_rollout_generations:0.268 - timing_s/step:68.369 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.181 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:642166.000 - perf/time_per_step:68.369 - perf/throughput:1174.088
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/146.jsonl
step:146 - global_seqlen/min:79339.000 - global_seqlen/max:81719.000 - global_seqlen/minmax_diff:2380.000 - global_seqlen/balanced_min:80299.000 - global_seqlen/balanced_max:80810.000 - global_seqlen/mean:80367.500 - actor/entropy_loss:1.223 - training/rollout_probs_diff_max:0.995 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.024 - actor/kl_coef:0.010 - actor/pg_loss:0.020 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.476 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.670 - perf/cpu_memory_used_gb:124.678 - actor/lr:0.000 - training/global_step:146.000 - training/epoch:2.000 - critic/score/mean:0.623 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.623 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:167.934 - response_length/max:1170.000 - response_length/min:41.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.938 - prompt_length/max:523.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:17.608 - timing_s/reshard:4.084 - timing_s/gen:22.933 - timing_s/reward:0.157 - timing_s/old_log_prob:7.449 - timing_s/ref:7.330 - timing_s/adv:0.020 - timing_s/update_actor:21.960 - timing_s/dump_rollout_generations:0.267 - timing_s/step:60.151 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.133 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:642940.000 - perf/time_per_step:60.151 - perf/throughput:1336.097
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/147.jsonl
step:147 - global_seqlen/min:78566.000 - global_seqlen/max:82018.000 - global_seqlen/minmax_diff:3452.000 - global_seqlen/balanced_min:80504.000 - global_seqlen/balanced_max:81534.000 - global_seqlen/mean:80633.375 - actor/entropy_loss:1.209 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.038 - actor/kl_coef:0.010 - actor/pg_loss:-0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.272 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.670 - perf/cpu_memory_used_gb:125.570 - actor/lr:0.000 - training/global_step:147.000 - training/epoch:2.000 - critic/score/mean:0.554 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.554 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:170.354 - response_length/max:1647.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.594 - prompt_length/max:506.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:20.222 - timing_s/reshard:4.107 - timing_s/gen:25.057 - timing_s/reward:0.157 - timing_s/old_log_prob:7.315 - timing_s/ref:7.106 - timing_s/adv:0.020 - timing_s/update_actor:22.317 - timing_s/dump_rollout_generations:0.265 - timing_s/step:62.268 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.144 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:645067.000 - perf/time_per_step:62.268 - perf/throughput:1294.951
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/148.jsonl
step:148 - global_seqlen/min:79502.000 - global_seqlen/max:83814.000 - global_seqlen/minmax_diff:4312.000 - global_seqlen/balanced_min:81408.000 - global_seqlen/balanced_max:81409.000 - global_seqlen/mean:81408.875 - actor/entropy_loss:1.230 - training/rollout_probs_diff_max:0.992 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.037 - actor/kl_coef:0.010 - actor/pg_loss:-0.008 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.512 - perf/mfu/actor:0.179 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.670 - perf/cpu_memory_used_gb:126.033 - actor/lr:0.000 - training/global_step:148.000 - training/epoch:2.000 - critic/score/mean:0.633 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.633 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:174.741 - response_length/max:437.000 - response_length/min:45.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.266 - prompt_length/max:509.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.619 - timing_s/reshard:4.102 - timing_s/gen:18.982 - timing_s/reward:0.158 - timing_s/old_log_prob:7.335 - timing_s/ref:7.191 - timing_s/adv:0.020 - timing_s/update_actor:21.901 - timing_s/dump_rollout_generations:0.265 - timing_s/step:55.884 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.106 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:651271.000 - perf/time_per_step:55.884 - perf/throughput:1456.756
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/149.jsonl
step:149 - global_seqlen/min:80005.000 - global_seqlen/max:81837.000 - global_seqlen/minmax_diff:1832.000 - global_seqlen/balanced_min:81124.000 - global_seqlen/balanced_max:81124.000 - global_seqlen/mean:81124.000 - actor/entropy_loss:1.217 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.030 - actor/kl_coef:0.010 - actor/pg_loss:0.021 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:6.387 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.670 - perf/cpu_memory_used_gb:126.546 - actor/lr:0.000 - training/global_step:149.000 - training/epoch:2.000 - critic/score/mean:0.512 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.512 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:171.594 - response_length/max:462.000 - response_length/min:47.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.188 - prompt_length/max:507.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.651 - timing_s/reshard:4.037 - timing_s/gen:18.411 - timing_s/reward:0.183 - timing_s/old_log_prob:7.378 - timing_s/ref:7.222 - timing_s/adv:0.020 - timing_s/update_actor:21.951 - timing_s/dump_rollout_generations:0.263 - timing_s/step:55.463 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.105 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:648992.000 - perf/time_per_step:55.463 - perf/throughput:1462.659
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/150.jsonl
step:150 - global_seqlen/min:79933.000 - global_seqlen/max:83517.000 - global_seqlen/minmax_diff:3584.000 - global_seqlen/balanced_min:81324.000 - global_seqlen/balanced_max:81325.000 - global_seqlen/mean:81324.125 - actor/entropy_loss:1.245 - training/rollout_probs_diff_max:0.998 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.021 - actor/kl_coef:0.010 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.260 - perf/mfu/actor:0.183 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.670 - perf/cpu_memory_used_gb:126.769 - actor/lr:0.000 - training/global_step:150.000 - training/epoch:2.000 - critic/score/mean:0.651 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.651 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:173.540 - response_length/max:471.000 - response_length/min:34.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.805 - prompt_length/max:497.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.668 - timing_s/reshard:5.410 - timing_s/gen:19.638 - timing_s/reward:0.157 - timing_s/old_log_prob:7.269 - timing_s/ref:7.133 - timing_s/adv:0.020 - timing_s/update_actor:21.306 - timing_s/dump_rollout_generations:0.281 - timing_s/step:55.840 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.111 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:650593.000 - perf/time_per_step:55.840 - perf/throughput:1456.387
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/151.jsonl
step:151 - global_seqlen/min:77078.000 - global_seqlen/max:82485.000 - global_seqlen/minmax_diff:5407.000 - global_seqlen/balanced_min:80189.000 - global_seqlen/balanced_max:81672.000 - global_seqlen/mean:80374.375 - actor/entropy_loss:1.242 - training/rollout_probs_diff_max:0.995 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.026 - actor/kl_coef:0.010 - actor/pg_loss:0.087 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.440 - perf/mfu/actor:0.181 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.670 - perf/cpu_memory_used_gb:127.371 - actor/lr:0.000 - training/global_step:151.000 - training/epoch:2.000 - critic/score/mean:0.613 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.613 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.034 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.034 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:170.800 - response_length/max:2048.000 - response_length/min:48.000 - response_length/clip_ratio:0.001 - prompt_length/mean:457.125 - prompt_length/max:511.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.505 - timing_s/reshard:7.470 - timing_s/gen:31.270 - timing_s/reward:0.154 - timing_s/old_log_prob:7.370 - timing_s/ref:7.220 - timing_s/adv:0.022 - timing_s/update_actor:21.327 - timing_s/dump_rollout_generations:0.263 - timing_s/step:67.656 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.179 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:642995.000 - perf/time_per_step:67.656 - perf/throughput:1187.982
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/152.jsonl
step:152 - global_seqlen/min:78578.000 - global_seqlen/max:81811.000 - global_seqlen/minmax_diff:3233.000 - global_seqlen/balanced_min:80142.000 - global_seqlen/balanced_max:80143.000 - global_seqlen/mean:80142.125 - actor/entropy_loss:1.236 - training/rollout_probs_diff_max:0.997 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.028 - actor/kl_coef:0.010 - actor/pg_loss:-0.062 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.594 - perf/mfu/actor:0.180 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.670 - perf/cpu_memory_used_gb:127.960 - actor/lr:0.000 - training/global_step:152.000 - training/epoch:2.000 - critic/score/mean:0.611 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.611 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.009 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.009 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:165.329 - response_length/max:449.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.781 - prompt_length/max:502.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.357 - timing_s/reshard:4.162 - timing_s/gen:18.075 - timing_s/reward:0.157 - timing_s/old_log_prob:7.265 - timing_s/ref:7.073 - timing_s/adv:0.020 - timing_s/update_actor:21.364 - timing_s/dump_rollout_generations:0.264 - timing_s/step:54.250 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.107 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:641137.000 - perf/time_per_step:54.250 - perf/throughput:1477.284
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/153.jsonl
step:153 - global_seqlen/min:78901.000 - global_seqlen/max:83901.000 - global_seqlen/minmax_diff:5000.000 - global_seqlen/balanced_min:81189.000 - global_seqlen/balanced_max:81190.000 - global_seqlen/mean:81189.500 - actor/entropy_loss:1.275 - training/rollout_probs_diff_max:0.992 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.055 - actor/kl_coef:0.010 - actor/pg_loss:-0.035 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.435 - perf/mfu/actor:0.181 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.670 - perf/cpu_memory_used_gb:129.300 - actor/lr:0.000 - training/global_step:153.000 - training/epoch:2.000 - critic/score/mean:0.605 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.605 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:172.246 - response_length/max:418.000 - response_length/min:43.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.047 - prompt_length/max:514.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.512 - timing_s/reshard:5.902 - timing_s/gen:19.957 - timing_s/reward:0.155 - timing_s/old_log_prob:7.301 - timing_s/ref:7.329 - timing_s/adv:0.020 - timing_s/update_actor:21.551 - timing_s/dump_rollout_generations:0.266 - timing_s/step:56.608 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:649516.000 - perf/time_per_step:56.608 - perf/throughput:1434.253
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/154.jsonl
step:154 - global_seqlen/min:77566.000 - global_seqlen/max:81662.000 - global_seqlen/minmax_diff:4096.000 - global_seqlen/balanced_min:80218.000 - global_seqlen/balanced_max:80219.000 - global_seqlen/mean:80218.250 - actor/entropy_loss:1.288 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.035 - actor/kl_coef:0.010 - actor/pg_loss:-0.068 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.866 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.670 - perf/cpu_memory_used_gb:130.079 - actor/lr:0.000 - training/global_step:154.000 - training/epoch:2.000 - critic/score/mean:0.647 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.647 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:165.900 - response_length/max:392.000 - response_length/min:34.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.805 - prompt_length/max:540.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.265 - timing_s/reshard:7.372 - timing_s/gen:21.174 - timing_s/reward:0.154 - timing_s/old_log_prob:7.527 - timing_s/ref:7.332 - timing_s/adv:0.020 - timing_s/update_actor:21.901 - timing_s/dump_rollout_generations:0.267 - timing_s/step:58.407 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:641746.000 - perf/time_per_step:58.407 - perf/throughput:1373.429
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/155.jsonl
step:155 - global_seqlen/min:78576.000 - global_seqlen/max:82517.000 - global_seqlen/minmax_diff:3941.000 - global_seqlen/balanced_min:80657.000 - global_seqlen/balanced_max:80658.000 - global_seqlen/mean:80657.500 - actor/entropy_loss:1.288 - training/rollout_probs_diff_max:0.979 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.034 - actor/kl_coef:0.010 - actor/pg_loss:-0.019 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.775 - perf/mfu/actor:0.179 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.670 - perf/cpu_memory_used_gb:131.179 - actor/lr:0.000 - training/global_step:155.000 - training/epoch:2.000 - critic/score/mean:0.678 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.678 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:169.309 - response_length/max:454.000 - response_length/min:23.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.828 - prompt_length/max:495.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.297 - timing_s/reshard:8.135 - timing_s/gen:21.959 - timing_s/reward:0.155 - timing_s/old_log_prob:7.219 - timing_s/ref:7.172 - timing_s/adv:0.020 - timing_s/update_actor:21.634 - timing_s/dump_rollout_generations:0.265 - timing_s/step:58.458 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.127 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:645260.000 - perf/time_per_step:58.458 - perf/throughput:1379.757
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/156.jsonl
step:156 - global_seqlen/min:77736.000 - global_seqlen/max:84164.000 - global_seqlen/minmax_diff:6428.000 - global_seqlen/balanced_min:80720.000 - global_seqlen/balanced_max:81787.000 - global_seqlen/mean:80853.750 - actor/entropy_loss:1.262 - training/rollout_probs_diff_max:0.997 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.025 - actor/kl_coef:0.010 - actor/pg_loss:-0.002 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.222 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.670 - perf/cpu_memory_used_gb:132.314 - actor/lr:0.000 - training/global_step:156.000 - training/epoch:2.000 - critic/score/mean:0.618 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.618 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:168.928 - response_length/max:1673.000 - response_length/min:23.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.742 - prompt_length/max:531.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:19.680 - timing_s/reshard:8.559 - timing_s/gen:28.796 - timing_s/reward:0.158 - timing_s/old_log_prob:7.320 - timing_s/ref:7.258 - timing_s/adv:0.020 - timing_s/update_actor:22.034 - timing_s/dump_rollout_generations:0.293 - timing_s/step:65.910 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.166 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:646830.000 - perf/time_per_step:65.910 - perf/throughput:1226.729
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/157.jsonl
step:157 - global_seqlen/min:77715.000 - global_seqlen/max:82205.000 - global_seqlen/minmax_diff:4490.000 - global_seqlen/balanced_min:80227.000 - global_seqlen/balanced_max:80228.000 - global_seqlen/mean:80227.625 - actor/entropy_loss:1.280 - training/rollout_probs_diff_max:0.995 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.042 - actor/kl_coef:0.010 - actor/pg_loss:-0.011 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.455 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.670 - perf/cpu_memory_used_gb:133.707 - actor/lr:0.000 - training/global_step:157.000 - training/epoch:2.000 - critic/score/mean:0.664 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.664 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:164.200 - response_length/max:422.000 - response_length/min:38.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.578 - prompt_length/max:509.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.453 - timing_s/reshard:5.938 - timing_s/gen:19.932 - timing_s/reward:0.164 - timing_s/old_log_prob:7.191 - timing_s/ref:6.966 - timing_s/adv:0.022 - timing_s/update_actor:22.037 - timing_s/dump_rollout_generations:0.270 - timing_s/step:56.615 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.119 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:641821.000 - perf/time_per_step:56.615 - perf/throughput:1417.063
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/158.jsonl
step:158 - global_seqlen/min:76732.000 - global_seqlen/max:81943.000 - global_seqlen/minmax_diff:5211.000 - global_seqlen/balanced_min:79235.000 - global_seqlen/balanced_max:79236.000 - global_seqlen/mean:79235.875 - actor/entropy_loss:1.316 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.033 - actor/kl_coef:0.010 - actor/pg_loss:0.034 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.856 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.670 - perf/cpu_memory_used_gb:133.719 - actor/lr:0.000 - training/global_step:158.000 - training/epoch:2.000 - critic/score/mean:0.569 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.569 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:159.210 - response_length/max:441.000 - response_length/min:26.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.820 - prompt_length/max:499.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.372 - timing_s/reshard:7.623 - timing_s/gen:21.545 - timing_s/reward:0.153 - timing_s/old_log_prob:7.211 - timing_s/ref:7.039 - timing_s/adv:0.021 - timing_s/update_actor:21.554 - timing_s/dump_rollout_generations:0.285 - timing_s/step:57.838 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.132 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:633887.000 - perf/time_per_step:57.838 - perf/throughput:1369.961
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/159.jsonl
step:159 - global_seqlen/min:76372.000 - global_seqlen/max:81494.000 - global_seqlen/minmax_diff:5122.000 - global_seqlen/balanced_min:78991.000 - global_seqlen/balanced_max:78992.000 - global_seqlen/mean:78991.375 - actor/entropy_loss:1.352 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.024 - actor/kl_coef:0.010 - actor/pg_loss:-0.007 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.339 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.670 - perf/cpu_memory_used_gb:135.352 - actor/lr:0.000 - training/global_step:159.000 - training/epoch:2.000 - critic/score/mean:0.594 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.594 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:157.401 - response_length/max:460.000 - response_length/min:39.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.719 - prompt_length/max:506.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.553 - timing_s/reshard:8.326 - timing_s/gen:22.448 - timing_s/reward:0.157 - timing_s/old_log_prob:7.208 - timing_s/ref:7.101 - timing_s/adv:0.020 - timing_s/update_actor:21.982 - timing_s/dump_rollout_generations:0.265 - timing_s/step:59.212 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.139 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:631931.000 - perf/time_per_step:59.212 - perf/throughput:1334.042
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/160.jsonl
local_global_step_folder: ../ckpt/checkpoints/global_step_160
step:160 - global_seqlen/min:76226.000 - global_seqlen/max:83084.000 - global_seqlen/minmax_diff:6858.000 - global_seqlen/balanced_min:79681.000 - global_seqlen/balanced_max:79682.000 - global_seqlen/mean:79681.250 - actor/entropy_loss:1.340 - training/rollout_probs_diff_max:0.998 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.031 - actor/kl_coef:0.010 - actor/pg_loss:-0.008 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.282 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:51.670 - perf/cpu_memory_used_gb:136.732 - actor/lr:0.000 - training/global_step:160.000 - training/epoch:2.000 - critic/score/mean:0.677 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.677 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:161.408 - response_length/max:408.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.102 - prompt_length/max:509.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.409 - timing_s/reshard:8.658 - timing_s/gen:22.634 - timing_s/reward:0.158 - timing_s/old_log_prob:7.284 - timing_s/ref:7.196 - timing_s/adv:0.021 - timing_s/update_actor:21.587 - timing_s/dump_rollout_generations:0.263 - timing_s/save_checkpoint:28.769 - timing_s/step:87.945 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.137 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:637450.000 - perf/time_per_step:87.945 - perf/throughput:906.038
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/161.jsonl
step:161 - global_seqlen/min:76657.000 - global_seqlen/max:82011.000 - global_seqlen/minmax_diff:5354.000 - global_seqlen/balanced_min:79181.000 - global_seqlen/balanced_max:80668.000 - global_seqlen/mean:79367.125 - actor/entropy_loss:1.355 - training/rollout_probs_diff_max:0.997 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.025 - actor/kl_coef:0.010 - actor/pg_loss:0.085 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.260 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:146.176 - actor/lr:0.000 - training/global_step:161.000 - training/epoch:2.000 - critic/score/mean:0.593 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.593 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.031 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.031 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:159.556 - response_length/max:2048.000 - response_length/min:39.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.500 - prompt_length/max:495.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:24.130 - timing_s/reshard:8.480 - timing_s/gen:33.810 - timing_s/reward:0.151 - timing_s/old_log_prob:7.575 - timing_s/ref:7.245 - timing_s/adv:0.022 - timing_s/update_actor:22.268 - timing_s/dump_rollout_generations:0.262 - timing_s/step:71.371 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.207 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:634937.000 - perf/time_per_step:71.371 - perf/throughput:1112.030
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/162.jsonl
step:162 - global_seqlen/min:78014.000 - global_seqlen/max:82110.000 - global_seqlen/minmax_diff:4096.000 - global_seqlen/balanced_min:79430.000 - global_seqlen/balanced_max:79431.000 - global_seqlen/mean:79430.750 - actor/entropy_loss:1.306 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.022 - actor/kl_coef:0.010 - actor/pg_loss:0.022 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.111 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:138.429 - actor/lr:0.000 - training/global_step:162.000 - training/epoch:2.000 - critic/score/mean:0.595 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.595 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:159.365 - response_length/max:461.000 - response_length/min:36.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.188 - prompt_length/max:519.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.254 - timing_s/reshard:4.072 - timing_s/gen:18.295 - timing_s/reward:0.158 - timing_s/old_log_prob:7.437 - timing_s/ref:7.156 - timing_s/adv:0.020 - timing_s/update_actor:22.019 - timing_s/dump_rollout_generations:0.264 - timing_s/step:55.390 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:635446.000 - perf/time_per_step:55.390 - perf/throughput:1434.016
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/163.jsonl
step:163 - global_seqlen/min:77559.000 - global_seqlen/max:80871.000 - global_seqlen/minmax_diff:3312.000 - global_seqlen/balanced_min:78843.000 - global_seqlen/balanced_max:78871.000 - global_seqlen/mean:78846.500 - actor/entropy_loss:1.355 - training/rollout_probs_diff_max:0.998 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.043 - actor/kl_coef:0.010 - actor/pg_loss:0.027 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.442 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.597 - actor/lr:0.000 - training/global_step:163.000 - training/epoch:2.000 - critic/score/mean:0.611 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.611 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:155.598 - response_length/max:549.000 - response_length/min:44.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.391 - prompt_length/max:504.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.907 - timing_s/reshard:4.992 - timing_s/gen:19.443 - timing_s/reward:0.151 - timing_s/old_log_prob:7.210 - timing_s/ref:7.036 - timing_s/adv:0.020 - timing_s/update_actor:21.253 - timing_s/dump_rollout_generations:0.265 - timing_s/step:55.413 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.122 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:630772.000 - perf/time_per_step:55.413 - perf/throughput:1422.895
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/164.jsonl
step:164 - global_seqlen/min:73963.000 - global_seqlen/max:81705.000 - global_seqlen/minmax_diff:7742.000 - global_seqlen/balanced_min:79103.000 - global_seqlen/balanced_max:79104.000 - global_seqlen/mean:79103.375 - actor/entropy_loss:1.307 - training/rollout_probs_diff_max:0.997 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.036 - actor/kl_coef:0.010 - actor/pg_loss:0.042 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.399 - perf/mfu/actor:0.183 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.642 - actor/lr:0.000 - training/global_step:164.000 - training/epoch:2.000 - critic/score/mean:0.651 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.651 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.007 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.007 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:157.253 - response_length/max:441.000 - response_length/min:29.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.742 - prompt_length/max:502.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.099 - timing_s/reshard:7.417 - timing_s/gen:21.075 - timing_s/reward:0.152 - timing_s/old_log_prob:7.085 - timing_s/ref:7.093 - timing_s/adv:0.020 - timing_s/update_actor:20.818 - timing_s/dump_rollout_generations:0.270 - timing_s/step:56.542 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.131 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:632827.000 - perf/time_per_step:56.542 - perf/throughput:1399.014
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/165.jsonl
step:165 - global_seqlen/min:76663.000 - global_seqlen/max:79990.000 - global_seqlen/minmax_diff:3327.000 - global_seqlen/balanced_min:78414.000 - global_seqlen/balanced_max:78415.000 - global_seqlen/mean:78414.375 - actor/entropy_loss:1.402 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.044 - actor/kl_coef:0.010 - actor/pg_loss:0.018 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.408 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.766 - actor/lr:0.000 - training/global_step:165.000 - training/epoch:2.000 - critic/score/mean:0.654 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.654 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.007 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.007 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:153.503 - response_length/max:459.000 - response_length/min:37.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.109 - prompt_length/max:505.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.194 - timing_s/reshard:9.796 - timing_s/gen:23.556 - timing_s/reward:0.153 - timing_s/old_log_prob:7.211 - timing_s/ref:6.993 - timing_s/adv:0.020 - timing_s/update_actor:21.793 - timing_s/dump_rollout_generations:0.262 - timing_s/step:60.020 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.150 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:627315.000 - perf/time_per_step:60.020 - perf/throughput:1306.466
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/166.jsonl
step:166 - global_seqlen/min:77027.000 - global_seqlen/max:80069.000 - global_seqlen/minmax_diff:3042.000 - global_seqlen/balanced_min:78465.000 - global_seqlen/balanced_max:79958.000 - global_seqlen/mean:78651.750 - actor/entropy_loss:1.283 - training/rollout_probs_diff_max:0.921 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.028 - actor/kl_coef:0.010 - actor/pg_loss:0.091 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.408 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.932 - actor/lr:0.000 - training/global_step:166.000 - training/epoch:2.000 - critic/score/mean:0.622 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.622 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.034 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.034 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:153.670 - response_length/max:2048.000 - response_length/min:39.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.797 - prompt_length/max:517.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.948 - timing_s/reshard:8.759 - timing_s/gen:31.993 - timing_s/reward:0.154 - timing_s/old_log_prob:7.472 - timing_s/ref:6.979 - timing_s/adv:0.022 - timing_s/update_actor:21.642 - timing_s/dump_rollout_generations:0.264 - timing_s/step:68.560 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.203 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:629214.000 - perf/time_per_step:68.560 - perf/throughput:1147.188
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/167.jsonl
step:167 - global_seqlen/min:77024.000 - global_seqlen/max:80954.000 - global_seqlen/minmax_diff:3930.000 - global_seqlen/balanced_min:79108.000 - global_seqlen/balanced_max:79109.000 - global_seqlen/mean:79108.375 - actor/entropy_loss:1.304 - training/rollout_probs_diff_max:0.994 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.028 - actor/kl_coef:0.010 - actor/pg_loss:-0.007 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.555 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.230 - actor/lr:0.000 - training/global_step:167.000 - training/epoch:2.000 - critic/score/mean:0.626 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.626 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.008 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:154.073 - response_length/max:417.000 - response_length/min:39.000 - response_length/clip_ratio:0.000 - prompt_length/mean:463.961 - prompt_length/max:524.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.430 - timing_s/reshard:4.508 - timing_s/gen:18.505 - timing_s/reward:0.153 - timing_s/old_log_prob:7.056 - timing_s/ref:7.037 - timing_s/adv:0.021 - timing_s/update_actor:21.433 - timing_s/dump_rollout_generations:0.263 - timing_s/step:54.502 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:632867.000 - perf/time_per_step:54.502 - perf/throughput:1451.488
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/168.jsonl
step:168 - global_seqlen/min:74013.000 - global_seqlen/max:79343.000 - global_seqlen/minmax_diff:5330.000 - global_seqlen/balanced_min:77517.000 - global_seqlen/balanced_max:77518.000 - global_seqlen/mean:77517.250 - actor/entropy_loss:1.269 - training/rollout_probs_diff_max:0.996 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.033 - actor/kl_coef:0.010 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.256 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.307 - actor/lr:0.000 - training/global_step:168.000 - training/epoch:2.000 - critic/score/mean:0.645 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.645 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:146.158 - response_length/max:355.000 - response_length/min:46.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.445 - prompt_length/max:506.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.327 - timing_s/reshard:7.445 - timing_s/gen:21.336 - timing_s/reward:0.153 - timing_s/old_log_prob:7.213 - timing_s/ref:7.007 - timing_s/adv:0.020 - timing_s/update_actor:21.560 - timing_s/dump_rollout_generations:0.260 - timing_s/step:57.582 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.143 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:620138.000 - perf/time_per_step:57.582 - perf/throughput:1346.214
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/169.jsonl
step:169 - global_seqlen/min:75058.000 - global_seqlen/max:79152.000 - global_seqlen/minmax_diff:4094.000 - global_seqlen/balanced_min:77832.000 - global_seqlen/balanced_max:77832.000 - global_seqlen/mean:77832.000 - actor/entropy_loss:1.298 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.019 - actor/kl_coef:0.010 - actor/pg_loss:0.015 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.516 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.628 - actor/lr:0.000 - training/global_step:169.000 - training/epoch:2.000 - critic/score/mean:0.541 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.541 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:147.391 - response_length/max:471.000 - response_length/min:41.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.672 - prompt_length/max:497.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.209 - timing_s/reshard:7.400 - timing_s/gen:21.156 - timing_s/reward:0.151 - timing_s/old_log_prob:7.329 - timing_s/ref:7.136 - timing_s/adv:0.019 - timing_s/update_actor:21.763 - timing_s/dump_rollout_generations:0.263 - timing_s/step:57.846 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.140 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:622656.000 - perf/time_per_step:57.846 - perf/throughput:1345.498
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/170.jsonl
step:170 - global_seqlen/min:74923.000 - global_seqlen/max:79255.000 - global_seqlen/minmax_diff:4332.000 - global_seqlen/balanced_min:76920.000 - global_seqlen/balanced_max:76921.000 - global_seqlen/mean:76920.500 - actor/entropy_loss:1.228 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.021 - actor/kl_coef:0.010 - actor/pg_loss:0.031 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.393 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.325 - actor/lr:0.000 - training/global_step:170.000 - training/epoch:2.000 - critic/score/mean:0.620 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.620 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.009 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:140.270 - response_length/max:374.000 - response_length/min:16.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.672 - prompt_length/max:508.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.446 - timing_s/reshard:8.914 - timing_s/gen:21.888 - timing_s/reward:0.149 - timing_s/old_log_prob:7.242 - timing_s/ref:7.102 - timing_s/adv:0.020 - timing_s/update_actor:21.784 - timing_s/dump_rollout_generations:0.309 - timing_s/step:58.532 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.152 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:615364.000 - perf/time_per_step:58.532 - perf/throughput:1314.162
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/171.jsonl
step:171 - global_seqlen/min:74287.000 - global_seqlen/max:79235.000 - global_seqlen/minmax_diff:4948.000 - global_seqlen/balanced_min:77431.000 - global_seqlen/balanced_max:77432.000 - global_seqlen/mean:77431.500 - actor/entropy_loss:1.205 - training/rollout_probs_diff_max:0.993 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.023 - actor/kl_coef:0.010 - actor/pg_loss:-0.002 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.489 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.727 - actor/lr:0.000 - training/global_step:171.000 - training/epoch:2.000 - critic/score/mean:0.604 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.604 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.005 - critic/advantages/max:2.475 - critic/advantages/min:-1.208 - critic/returns/mean:-0.005 - critic/returns/max:2.475 - critic/returns/min:-1.208 - response_length/mean:143.793 - response_length/max:426.000 - response_length/min:30.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.141 - prompt_length/max:535.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.259 - timing_s/reshard:8.424 - timing_s/gen:22.248 - timing_s/reward:0.150 - timing_s/old_log_prob:7.302 - timing_s/ref:7.193 - timing_s/adv:0.020 - timing_s/update_actor:21.660 - timing_s/dump_rollout_generations:0.265 - timing_s/step:58.867 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.151 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:619452.000 - perf/time_per_step:58.867 - perf/throughput:1315.372
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/172.jsonl
step:172 - global_seqlen/min:75274.000 - global_seqlen/max:79777.000 - global_seqlen/minmax_diff:4503.000 - global_seqlen/balanced_min:77441.000 - global_seqlen/balanced_max:77823.000 - global_seqlen/mean:77489.375 - actor/entropy_loss:1.201 - training/rollout_probs_diff_max:0.982 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.022 - actor/kl_coef:0.010 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.415 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.520 - actor/lr:0.000 - training/global_step:172.000 - training/epoch:2.000 - critic/score/mean:0.673 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.673 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:143.683 - response_length/max:886.000 - response_length/min:27.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.703 - prompt_length/max:517.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.285 - timing_s/reshard:6.571 - timing_s/gen:22.428 - timing_s/reward:0.150 - timing_s/old_log_prob:7.225 - timing_s/ref:7.060 - timing_s/adv:0.020 - timing_s/update_actor:21.247 - timing_s/dump_rollout_generations:0.260 - timing_s/step:58.425 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.152 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:619915.000 - perf/time_per_step:58.425 - perf/throughput:1326.316
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/173.jsonl
step:173 - global_seqlen/min:75462.000 - global_seqlen/max:77667.000 - global_seqlen/minmax_diff:2205.000 - global_seqlen/balanced_min:76434.000 - global_seqlen/balanced_max:76435.000 - global_seqlen/mean:76434.250 - actor/entropy_loss:1.214 - training/rollout_probs_diff_max:0.990 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.028 - actor/kl_coef:0.010 - actor/pg_loss:-0.036 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.416 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.460 - actor/lr:0.000 - training/global_step:173.000 - training/epoch:2.000 - critic/score/mean:0.674 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.674 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.000 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.000 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:137.619 - response_length/max:358.000 - response_length/min:30.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.523 - prompt_length/max:508.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.948 - timing_s/reshard:5.193 - timing_s/gen:18.696 - timing_s/reward:0.171 - timing_s/old_log_prob:7.037 - timing_s/ref:6.888 - timing_s/adv:0.020 - timing_s/update_actor:20.611 - timing_s/dump_rollout_generations:0.264 - timing_s/step:53.720 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.133 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:611474.000 - perf/time_per_step:53.720 - perf/throughput:1422.836
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/174.jsonl
step:174 - global_seqlen/min:74831.000 - global_seqlen/max:78124.000 - global_seqlen/minmax_diff:3293.000 - global_seqlen/balanced_min:76497.000 - global_seqlen/balanced_max:76498.000 - global_seqlen/mean:76497.250 - actor/entropy_loss:1.221 - training/rollout_probs_diff_max:0.997 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.028 - actor/kl_coef:0.010 - actor/pg_loss:0.030 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.622 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.476 - actor/lr:0.000 - training/global_step:174.000 - training/epoch:2.000 - critic/score/mean:0.592 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.592 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.000 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.000 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:136.971 - response_length/max:417.000 - response_length/min:28.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.664 - prompt_length/max:512.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.097 - timing_s/reshard:4.162 - timing_s/gen:18.141 - timing_s/reward:0.147 - timing_s/old_log_prob:7.034 - timing_s/ref:6.739 - timing_s/adv:0.020 - timing_s/update_actor:21.071 - timing_s/dump_rollout_generations:0.285 - timing_s/step:53.468 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.129 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:611978.000 - perf/time_per_step:53.468 - perf/throughput:1430.717
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/175.jsonl
step:175 - global_seqlen/min:73177.000 - global_seqlen/max:78415.000 - global_seqlen/minmax_diff:5238.000 - global_seqlen/balanced_min:75204.000 - global_seqlen/balanced_max:75205.000 - global_seqlen/mean:75204.375 - actor/entropy_loss:1.184 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.057 - actor/kl_coef:0.010 - actor/pg_loss:-0.060 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.505 - perf/mfu/actor:0.189 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.477 - actor/lr:0.000 - training/global_step:175.000 - training/epoch:2.000 - critic/score/mean:0.683 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.683 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:129.886 - response_length/max:426.000 - response_length/min:28.000 - response_length/clip_ratio:0.000 - prompt_length/mean:457.648 - prompt_length/max:519.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.139 - timing_s/reshard:4.105 - timing_s/gen:19.336 - timing_s/reward:0.172 - timing_s/old_log_prob:7.463 - timing_s/ref:6.753 - timing_s/adv:0.027 - timing_s/update_actor:19.092 - timing_s/dump_rollout_generations:0.262 - timing_s/step:53.137 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.032 - timing_per_token_ms/gen:0.145 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:601635.000 - perf/time_per_step:53.137 - perf/throughput:1415.283
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/176.jsonl
step:176 - global_seqlen/min:75107.000 - global_seqlen/max:78979.000 - global_seqlen/minmax_diff:3872.000 - global_seqlen/balanced_min:76570.000 - global_seqlen/balanced_max:76571.000 - global_seqlen/mean:76570.875 - actor/entropy_loss:1.163 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.033 - actor/kl_coef:0.010 - actor/pg_loss:0.025 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.521 - perf/mfu/actor:0.169 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.664 - actor/lr:0.000 - training/global_step:176.000 - training/epoch:2.000 - critic/score/mean:0.650 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.650 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:137.390 - response_length/max:452.000 - response_length/min:33.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.820 - prompt_length/max:499.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.105 - timing_s/reshard:5.323 - timing_s/gen:18.967 - timing_s/reward:0.148 - timing_s/old_log_prob:6.992 - timing_s/ref:6.826 - timing_s/adv:0.021 - timing_s/update_actor:21.701 - timing_s/dump_rollout_generations:0.261 - timing_s/step:54.949 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.135 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:612567.000 - perf/time_per_step:54.949 - perf/throughput:1393.502
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/177.jsonl
step:177 - global_seqlen/min:75224.000 - global_seqlen/max:80096.000 - global_seqlen/minmax_diff:4872.000 - global_seqlen/balanced_min:77140.000 - global_seqlen/balanced_max:77141.000 - global_seqlen/mean:77140.750 - actor/entropy_loss:1.229 - training/rollout_probs_diff_max:0.978 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.031 - actor/kl_coef:0.010 - actor/pg_loss:0.048 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.483 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.947 - actor/lr:0.000 - training/global_step:177.000 - training/epoch:2.000 - critic/score/mean:0.662 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.662 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:140.561 - response_length/max:424.000 - response_length/min:32.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.102 - prompt_length/max:517.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.005 - timing_s/reshard:7.089 - timing_s/gen:20.631 - timing_s/reward:0.150 - timing_s/old_log_prob:7.090 - timing_s/ref:6.963 - timing_s/adv:0.020 - timing_s/update_actor:21.633 - timing_s/dump_rollout_generations:0.260 - timing_s/step:56.778 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.143 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:617126.000 - perf/time_per_step:56.778 - perf/throughput:1358.638
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/178.jsonl
step:178 - global_seqlen/min:74440.000 - global_seqlen/max:77152.000 - global_seqlen/minmax_diff:2712.000 - global_seqlen/balanced_min:76017.000 - global_seqlen/balanced_max:76038.000 - global_seqlen/mean:76020.375 - actor/entropy_loss:1.210 - training/rollout_probs_diff_max:0.996 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.029 - actor/kl_coef:0.010 - actor/pg_loss:-0.026 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.549 - perf/mfu/actor:0.169 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.639 - actor/lr:0.000 - training/global_step:178.000 - training/epoch:2.000 - critic/score/mean:0.680 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.680 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:133.675 - response_length/max:435.000 - response_length/min:33.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.234 - prompt_length/max:521.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.087 - timing_s/reshard:8.238 - timing_s/gen:21.868 - timing_s/reward:0.147 - timing_s/old_log_prob:7.299 - timing_s/ref:7.167 - timing_s/adv:0.020 - timing_s/update_actor:21.656 - timing_s/dump_rollout_generations:0.260 - timing_s/step:58.449 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.160 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:608163.000 - perf/time_per_step:58.449 - perf/throughput:1300.618
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/179.jsonl
step:179 - global_seqlen/min:74774.000 - global_seqlen/max:78174.000 - global_seqlen/minmax_diff:3400.000 - global_seqlen/balanced_min:76180.000 - global_seqlen/balanced_max:77705.000 - global_seqlen/mean:76370.750 - actor/entropy_loss:1.196 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.013 - actor/kl_coef:0.010 - actor/pg_loss:0.100 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.365 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.800 - actor/lr:0.000 - training/global_step:179.000 - training/epoch:2.000 - critic/score/mean:0.698 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.698 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.037 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.037 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:137.521 - response_length/max:2048.000 - response_length/min:25.000 - response_length/clip_ratio:0.001 - prompt_length/mean:459.125 - prompt_length/max:530.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.829 - timing_s/reshard:8.489 - timing_s/gen:31.600 - timing_s/reward:0.172 - timing_s/old_log_prob:7.402 - timing_s/ref:7.209 - timing_s/adv:0.022 - timing_s/update_actor:21.157 - timing_s/dump_rollout_generations:0.259 - timing_s/step:67.850 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.224 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:610966.000 - perf/time_per_step:67.850 - perf/throughput:1125.576
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/180.jsonl
step:180 - global_seqlen/min:76115.000 - global_seqlen/max:78846.000 - global_seqlen/minmax_diff:2731.000 - global_seqlen/balanced_min:76916.000 - global_seqlen/balanced_max:76917.000 - global_seqlen/mean:76916.375 - actor/entropy_loss:1.231 - training/rollout_probs_diff_max:0.996 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.074 - actor/kl_loss:0.024 - actor/kl_coef:0.010 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.360 - perf/mfu/actor:0.169 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.757 - actor/lr:0.000 - training/global_step:180.000 - training/epoch:2.000 - critic/score/mean:0.647 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.647 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.004 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:140.667 - response_length/max:395.000 - response_length/min:34.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.242 - prompt_length/max:509.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.728 - timing_s/reshard:5.004 - timing_s/gen:18.290 - timing_s/reward:0.150 - timing_s/old_log_prob:7.238 - timing_s/ref:7.014 - timing_s/adv:0.020 - timing_s/update_actor:21.920 - timing_s/dump_rollout_generations:0.260 - timing_s/step:54.924 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.127 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:615331.000 - perf/time_per_step:54.924 - perf/throughput:1400.422
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/181.jsonl
step:181 - global_seqlen/min:75326.000 - global_seqlen/max:78896.000 - global_seqlen/minmax_diff:3570.000 - global_seqlen/balanced_min:77137.000 - global_seqlen/balanced_max:77138.000 - global_seqlen/mean:77137.250 - actor/entropy_loss:1.212 - training/rollout_probs_diff_max:0.998 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.031 - actor/kl_coef:0.010 - actor/pg_loss:0.064 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.531 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.561 - actor/lr:0.000 - training/global_step:181.000 - training/epoch:2.000 - critic/score/mean:0.641 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.641 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.008 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.008 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:140.783 - response_length/max:481.000 - response_length/min:17.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.852 - prompt_length/max:522.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.642 - timing_s/reshard:7.640 - timing_s/gen:20.840 - timing_s/reward:0.149 - timing_s/old_log_prob:7.214 - timing_s/ref:7.124 - timing_s/adv:0.019 - timing_s/update_actor:21.675 - timing_s/dump_rollout_generations:0.265 - timing_s/step:57.320 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.145 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:617098.000 - perf/time_per_step:57.320 - perf/throughput:1345.723
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/182.jsonl
step:182 - global_seqlen/min:75580.000 - global_seqlen/max:80120.000 - global_seqlen/minmax_diff:4540.000 - global_seqlen/balanced_min:77409.000 - global_seqlen/balanced_max:77410.000 - global_seqlen/mean:77409.875 - actor/entropy_loss:1.190 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.041 - actor/kl_coef:0.010 - actor/pg_loss:-0.036 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.523 - perf/mfu/actor:0.180 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.711 - actor/lr:0.000 - training/global_step:182.000 - training/epoch:2.000 - critic/score/mean:0.614 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.614 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:143.202 - response_length/max:369.000 - response_length/min:32.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.562 - prompt_length/max:508.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.503 - timing_s/reshard:8.684 - timing_s/gen:21.753 - timing_s/reward:0.150 - timing_s/old_log_prob:7.136 - timing_s/ref:7.006 - timing_s/adv:0.020 - timing_s/update_actor:20.639 - timing_s/dump_rollout_generations:0.288 - timing_s/step:57.023 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.148 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:619279.000 - perf/time_per_step:57.023 - perf/throughput:1357.521
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/183.jsonl
step:183 - global_seqlen/min:74266.000 - global_seqlen/max:76840.000 - global_seqlen/minmax_diff:2574.000 - global_seqlen/balanced_min:75616.000 - global_seqlen/balanced_max:75616.000 - global_seqlen/mean:75616.000 - actor/entropy_loss:1.211 - training/rollout_probs_diff_max:0.994 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.017 - actor/kl_coef:0.010 - actor/pg_loss:-0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.506 - perf/mfu/actor:0.184 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.776 - actor/lr:0.000 - training/global_step:183.000 - training/epoch:2.000 - critic/score/mean:0.677 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.677 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.007 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.007 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:133.844 - response_length/max:372.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:456.906 - prompt_length/max:540.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.589 - timing_s/reshard:5.293 - timing_s/gen:18.500 - timing_s/reward:0.145 - timing_s/old_log_prob:6.910 - timing_s/ref:6.865 - timing_s/adv:0.020 - timing_s/update_actor:19.800 - timing_s/dump_rollout_generations:0.260 - timing_s/step:52.538 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.135 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:604928.000 - perf/time_per_step:52.538 - perf/throughput:1439.268
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/184.jsonl
step:184 - global_seqlen/min:74562.000 - global_seqlen/max:80543.000 - global_seqlen/minmax_diff:5981.000 - global_seqlen/balanced_min:77662.000 - global_seqlen/balanced_max:77663.000 - global_seqlen/mean:77662.625 - actor/entropy_loss:1.261 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.039 - actor/kl_coef:0.010 - actor/pg_loss:-0.010 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.247 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.046 - actor/lr:0.000 - training/global_step:184.000 - training/epoch:2.000 - critic/score/mean:0.596 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.596 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.006 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:145.966 - response_length/max:423.000 - response_length/min:39.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.773 - prompt_length/max:504.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.733 - timing_s/reshard:4.063 - timing_s/gen:19.024 - timing_s/reward:0.151 - timing_s/old_log_prob:7.070 - timing_s/ref:6.871 - timing_s/adv:0.020 - timing_s/update_actor:21.606 - timing_s/dump_rollout_generations:0.262 - timing_s/step:55.039 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.127 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:621301.000 - perf/time_per_step:55.039 - perf/throughput:1411.034
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/185.jsonl
step:185 - global_seqlen/min:76477.000 - global_seqlen/max:81307.000 - global_seqlen/minmax_diff:4830.000 - global_seqlen/balanced_min:78281.000 - global_seqlen/balanced_max:78282.000 - global_seqlen/mean:78281.625 - actor/entropy_loss:1.190 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.028 - actor/kl_coef:0.010 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.549 - perf/mfu/actor:0.167 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.112 - actor/lr:0.000 - training/global_step:185.000 - training/epoch:2.000 - critic/score/mean:0.672 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.672 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.005 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:148.271 - response_length/max:418.000 - response_length/min:28.000 - response_length/clip_ratio:0.000 - prompt_length/mean:463.305 - prompt_length/max:533.000 - prompt_length/min:430.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.514 - timing_s/reshard:4.152 - timing_s/gen:19.035 - timing_s/reward:0.151 - timing_s/old_log_prob:7.356 - timing_s/ref:7.221 - timing_s/adv:0.024 - timing_s/update_actor:22.431 - timing_s/dump_rollout_generations:0.261 - timing_s/step:56.509 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:626253.000 - perf/time_per_step:56.509 - perf/throughput:1385.307
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/186.jsonl
step:186 - global_seqlen/min:75807.000 - global_seqlen/max:80086.000 - global_seqlen/minmax_diff:4279.000 - global_seqlen/balanced_min:78829.000 - global_seqlen/balanced_max:78830.000 - global_seqlen/mean:78829.250 - actor/entropy_loss:1.261 - training/rollout_probs_diff_max:0.994 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.044 - actor/kl_coef:0.010 - actor/pg_loss:-0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.599 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:133.381 - actor/lr:0.000 - training/global_step:186.000 - training/epoch:2.000 - critic/score/mean:0.598 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.598 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.002 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:0.002 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:155.557 - response_length/max:390.000 - response_length/min:38.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.297 - prompt_length/max:504.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.226 - timing_s/reshard:4.196 - timing_s/gen:18.663 - timing_s/reward:0.156 - timing_s/old_log_prob:7.446 - timing_s/ref:7.292 - timing_s/adv:0.020 - timing_s/update_actor:22.255 - timing_s/dump_rollout_generations:0.290 - timing_s/step:56.159 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:630634.000 - perf/time_per_step:56.159 - perf/throughput:1403.681
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/187.jsonl
step:187 - global_seqlen/min:77041.000 - global_seqlen/max:80422.000 - global_seqlen/minmax_diff:3381.000 - global_seqlen/balanced_min:78711.000 - global_seqlen/balanced_max:78712.000 - global_seqlen/mean:78711.750 - actor/entropy_loss:1.239 - training/rollout_probs_diff_max:0.978 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.027 - actor/kl_coef:0.010 - actor/pg_loss:0.011 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.428 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:133.335 - actor/lr:0.000 - training/global_step:187.000 - training/epoch:2.000 - critic/score/mean:0.609 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.609 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:154.428 - response_length/max:425.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.508 - prompt_length/max:514.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.383 - timing_s/reshard:4.060 - timing_s/gen:17.988 - timing_s/reward:0.154 - timing_s/old_log_prob:7.291 - timing_s/ref:7.070 - timing_s/adv:0.020 - timing_s/update_actor:21.574 - timing_s/dump_rollout_generations:0.262 - timing_s/step:54.387 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.114 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:629694.000 - perf/time_per_step:54.387 - perf/throughput:1447.240
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/188.jsonl
step:188 - global_seqlen/min:77178.000 - global_seqlen/max:80756.000 - global_seqlen/minmax_diff:3578.000 - global_seqlen/balanced_min:78921.000 - global_seqlen/balanced_max:78922.000 - global_seqlen/mean:78921.250 - actor/entropy_loss:1.258 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.047 - actor/kl_coef:0.010 - actor/pg_loss:-0.017 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.406 - perf/mfu/actor:0.182 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:133.434 - actor/lr:0.000 - training/global_step:188.000 - training/epoch:2.000 - critic/score/mean:0.643 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.643 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:153.275 - response_length/max:451.000 - response_length/min:28.000 - response_length/clip_ratio:0.000 - prompt_length/mean:463.297 - prompt_length/max:518.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.410 - timing_s/reshard:7.088 - timing_s/gen:21.015 - timing_s/reward:0.154 - timing_s/old_log_prob:7.161 - timing_s/ref:7.004 - timing_s/adv:0.020 - timing_s/update_actor:20.871 - timing_s/dump_rollout_generations:0.265 - timing_s/step:56.526 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.134 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:631370.000 - perf/time_per_step:56.526 - perf/throughput:1396.205
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/189.jsonl
step:189 - global_seqlen/min:77472.000 - global_seqlen/max:81460.000 - global_seqlen/minmax_diff:3988.000 - global_seqlen/balanced_min:79034.000 - global_seqlen/balanced_max:79035.000 - global_seqlen/mean:79034.125 - actor/entropy_loss:1.282 - training/rollout_probs_diff_max:0.998 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.023 - actor/kl_coef:0.010 - actor/pg_loss:-0.020 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.512 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:133.304 - actor/lr:0.000 - training/global_step:189.000 - training/epoch:2.000 - critic/score/mean:0.603 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.603 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:154.970 - response_length/max:370.000 - response_length/min:31.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.484 - prompt_length/max:500.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.934 - timing_s/reshard:8.618 - timing_s/gen:22.074 - timing_s/reward:0.153 - timing_s/old_log_prob:7.149 - timing_s/ref:7.034 - timing_s/adv:0.021 - timing_s/update_actor:22.054 - timing_s/dump_rollout_generations:0.265 - timing_s/step:58.784 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.139 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:632273.000 - perf/time_per_step:58.784 - perf/throughput:1344.483
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/190.jsonl
step:190 - global_seqlen/min:76316.000 - global_seqlen/max:79801.000 - global_seqlen/minmax_diff:3485.000 - global_seqlen/balanced_min:78384.000 - global_seqlen/balanced_max:78385.000 - global_seqlen/mean:78384.500 - actor/entropy_loss:1.321 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.024 - actor/kl_coef:0.010 - actor/pg_loss:0.010 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.385 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:133.293 - actor/lr:0.000 - training/global_step:190.000 - training/epoch:2.000 - critic/score/mean:0.649 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.649 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:149.379 - response_length/max:401.000 - response_length/min:35.000 - response_length/clip_ratio:0.000 - prompt_length/mean:463.000 - prompt_length/max:521.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.015 - timing_s/reshard:8.496 - timing_s/gen:22.070 - timing_s/reward:0.151 - timing_s/old_log_prob:7.101 - timing_s/ref:6.967 - timing_s/adv:0.020 - timing_s/update_actor:21.193 - timing_s/dump_rollout_generations:0.264 - timing_s/step:57.796 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.144 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:627076.000 - perf/time_per_step:57.796 - perf/throughput:1356.217
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/191.jsonl
step:191 - global_seqlen/min:77624.000 - global_seqlen/max:80581.000 - global_seqlen/minmax_diff:2957.000 - global_seqlen/balanced_min:78911.000 - global_seqlen/balanced_max:80370.000 - global_seqlen/mean:79094.000 - actor/entropy_loss:1.316 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.032 - actor/kl_coef:0.010 - actor/pg_loss:-0.156 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.458 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:133.399 - actor/lr:0.000 - training/global_step:191.000 - training/epoch:2.000 - critic/score/mean:0.591 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.591 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.027 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.027 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:157.281 - response_length/max:2048.000 - response_length/min:36.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.641 - prompt_length/max:495.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.297 - timing_s/reshard:6.256 - timing_s/gen:29.150 - timing_s/reward:0.153 - timing_s/old_log_prob:7.121 - timing_s/ref:6.988 - timing_s/adv:0.021 - timing_s/update_actor:21.502 - timing_s/dump_rollout_generations:0.288 - timing_s/step:65.252 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.181 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:632752.000 - perf/time_per_step:65.252 - perf/throughput:1212.130
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/192.jsonl
step:192 - global_seqlen/min:76744.000 - global_seqlen/max:80525.000 - global_seqlen/minmax_diff:3781.000 - global_seqlen/balanced_min:78743.000 - global_seqlen/balanced_max:78744.000 - global_seqlen/mean:78743.500 - actor/entropy_loss:1.339 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.030 - actor/kl_coef:0.010 - actor/pg_loss:0.024 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.521 - perf/mfu/actor:0.195 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:133.622 - actor/lr:0.000 - training/global_step:192.000 - training/epoch:2.000 - critic/score/mean:0.612 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.612 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:154.816 - response_length/max:449.000 - response_length/min:24.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.367 - prompt_length/max:509.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.380 - timing_s/reshard:7.569 - timing_s/gen:21.507 - timing_s/reward:0.154 - timing_s/old_log_prob:7.201 - timing_s/ref:7.150 - timing_s/adv:0.020 - timing_s/update_actor:19.408 - timing_s/dump_rollout_generations:0.265 - timing_s/step:55.738 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.031 - timing_per_token_ms/gen:0.136 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:629948.000 - perf/time_per_step:55.738 - perf/throughput:1412.741
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/193.jsonl
step:193 - global_seqlen/min:76057.000 - global_seqlen/max:79212.000 - global_seqlen/minmax_diff:3155.000 - global_seqlen/balanced_min:77697.000 - global_seqlen/balanced_max:79151.000 - global_seqlen/mean:77879.125 - actor/entropy_loss:1.295 - training/rollout_probs_diff_max:0.993 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.040 - actor/kl_coef:0.010 - actor/pg_loss:0.110 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.508 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:133.839 - actor/lr:0.000 - training/global_step:193.000 - training/epoch:2.000 - critic/score/mean:0.662 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.662 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.039 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.039 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:149.728 - response_length/max:2048.000 - response_length/min:48.000 - response_length/clip_ratio:0.001 - prompt_length/mean:458.703 - prompt_length/max:507.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.855 - timing_s/reshard:8.594 - timing_s/gen:31.710 - timing_s/reward:0.151 - timing_s/old_log_prob:7.391 - timing_s/ref:7.282 - timing_s/adv:0.021 - timing_s/update_actor:21.508 - timing_s/dump_rollout_generations:0.286 - timing_s/step:68.378 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.207 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:623033.000 - perf/time_per_step:68.378 - perf/throughput:1138.957
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/194.jsonl
step:194 - global_seqlen/min:75140.000 - global_seqlen/max:79899.000 - global_seqlen/minmax_diff:4759.000 - global_seqlen/balanced_min:77596.000 - global_seqlen/balanced_max:77597.000 - global_seqlen/mean:77596.250 - actor/entropy_loss:1.325 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.030 - actor/kl_coef:0.010 - actor/pg_loss:0.020 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.405 - perf/mfu/actor:0.169 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.081 - actor/lr:0.000 - training/global_step:194.000 - training/epoch:2.000 - critic/score/mean:0.618 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.618 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.007 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:146.525 - response_length/max:433.000 - response_length/min:18.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.695 - prompt_length/max:504.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.882 - timing_s/reshard:4.798 - timing_s/gen:18.213 - timing_s/reward:0.169 - timing_s/old_log_prob:7.406 - timing_s/ref:7.207 - timing_s/adv:0.019 - timing_s/update_actor:22.011 - timing_s/dump_rollout_generations:0.264 - timing_s/step:55.327 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.121 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:620770.000 - perf/time_per_step:55.327 - perf/throughput:1402.497
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/195.jsonl
step:195 - global_seqlen/min:75930.000 - global_seqlen/max:80390.000 - global_seqlen/minmax_diff:4460.000 - global_seqlen/balanced_min:78100.000 - global_seqlen/balanced_max:78625.000 - global_seqlen/mean:78165.625 - actor/entropy_loss:1.297 - training/rollout_probs_diff_max:0.995 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.039 - actor/kl_coef:0.010 - actor/pg_loss:0.025 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.450 - perf/mfu/actor:0.169 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.286 - actor/lr:0.000 - training/global_step:195.000 - training/epoch:2.000 - critic/score/mean:0.660 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.660 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:149.481 - response_length/max:1040.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.188 - prompt_length/max:496.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:16.531 - timing_s/reshard:7.111 - timing_s/gen:24.177 - timing_s/reward:0.151 - timing_s/old_log_prob:7.408 - timing_s/ref:7.150 - timing_s/adv:0.022 - timing_s/update_actor:22.192 - timing_s/dump_rollout_generations:0.284 - timing_s/step:61.414 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.158 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:625325.000 - perf/time_per_step:61.414 - perf/throughput:1272.761
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/196.jsonl
step:196 - global_seqlen/min:75509.000 - global_seqlen/max:82113.000 - global_seqlen/minmax_diff:6604.000 - global_seqlen/balanced_min:77710.000 - global_seqlen/balanced_max:77711.000 - global_seqlen/mean:77710.250 - actor/entropy_loss:1.330 - training/rollout_probs_diff_max:0.972 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.035 - actor/kl_coef:0.010 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.427 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.565 - actor/lr:0.000 - training/global_step:196.000 - training/epoch:2.000 - critic/score/mean:0.640 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.640 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.007 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:149.260 - response_length/max:357.000 - response_length/min:37.000 - response_length/clip_ratio:0.000 - prompt_length/mean:457.852 - prompt_length/max:508.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.737 - timing_s/reshard:6.577 - timing_s/gen:19.864 - timing_s/reward:0.151 - timing_s/old_log_prob:7.201 - timing_s/ref:7.111 - timing_s/adv:0.020 - timing_s/update_actor:21.112 - timing_s/dump_rollout_generations:0.264 - timing_s/step:55.756 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.130 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:621682.000 - perf/time_per_step:55.756 - perf/throughput:1393.758
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/197.jsonl
step:197 - global_seqlen/min:74141.000 - global_seqlen/max:77720.000 - global_seqlen/minmax_diff:3579.000 - global_seqlen/balanced_min:76504.000 - global_seqlen/balanced_max:76505.000 - global_seqlen/mean:76504.750 - actor/entropy_loss:1.271 - training/rollout_probs_diff_max:0.980 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.051 - actor/kl_coef:0.010 - actor/pg_loss:0.013 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.337 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.321 - actor/lr:0.000 - training/global_step:197.000 - training/epoch:2.000 - critic/score/mean:0.695 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.695 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.009 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.009 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:139.021 - response_length/max:381.000 - response_length/min:46.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.672 - prompt_length/max:513.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.724 - timing_s/reshard:8.114 - timing_s/gen:21.371 - timing_s/reward:0.148 - timing_s/old_log_prob:7.045 - timing_s/ref:7.003 - timing_s/adv:0.019 - timing_s/update_actor:21.615 - timing_s/dump_rollout_generations:0.261 - timing_s/step:57.495 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.150 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:612038.000 - perf/time_per_step:57.495 - perf/throughput:1330.640
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/198.jsonl
step:198 - global_seqlen/min:77153.000 - global_seqlen/max:79904.000 - global_seqlen/minmax_diff:2751.000 - global_seqlen/balanced_min:78201.000 - global_seqlen/balanced_max:78202.000 - global_seqlen/mean:78201.750 - actor/entropy_loss:1.293 - training/rollout_probs_diff_max:0.934 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.029 - actor/kl_coef:0.010 - actor/pg_loss:0.040 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.376 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.348 - actor/lr:0.000 - training/global_step:198.000 - training/epoch:2.000 - critic/score/mean:0.575 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.575 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.013 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.013 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:147.607 - response_length/max:436.000 - response_length/min:38.000 - response_length/clip_ratio:0.000 - prompt_length/mean:463.344 - prompt_length/max:521.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.295 - timing_s/reshard:6.964 - timing_s/gen:20.822 - timing_s/reward:0.176 - timing_s/old_log_prob:7.043 - timing_s/ref:6.998 - timing_s/adv:0.021 - timing_s/update_actor:21.731 - timing_s/dump_rollout_generations:0.265 - timing_s/step:57.089 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.138 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:625614.000 - perf/time_per_step:57.089 - perf/throughput:1369.827
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/199.jsonl
step:199 - global_seqlen/min:76705.000 - global_seqlen/max:80468.000 - global_seqlen/minmax_diff:3763.000 - global_seqlen/balanced_min:77788.000 - global_seqlen/balanced_max:77789.000 - global_seqlen/mean:77788.625 - actor/entropy_loss:1.293 - training/rollout_probs_diff_max:0.998 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.030 - actor/kl_coef:0.010 - actor/pg_loss:0.030 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.447 - perf/mfu/actor:0.168 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.522 - actor/lr:0.000 - training/global_step:199.000 - training/epoch:2.000 - critic/score/mean:0.600 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.600 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:147.052 - response_length/max:349.000 - response_length/min:19.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.672 - prompt_length/max:523.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.283 - timing_s/reshard:4.735 - timing_s/gen:18.588 - timing_s/reward:0.150 - timing_s/old_log_prob:7.117 - timing_s/ref:7.003 - timing_s/adv:0.021 - timing_s/update_actor:22.183 - timing_s/dump_rollout_generations:0.263 - timing_s/step:55.362 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.123 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:622309.000 - perf/time_per_step:55.362 - perf/throughput:1405.096
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/200.jsonl
local_global_step_folder: ../ckpt/checkpoints/global_step_200
step:200 - global_seqlen/min:76865.000 - global_seqlen/max:79749.000 - global_seqlen/minmax_diff:2884.000 - global_seqlen/balanced_min:78100.000 - global_seqlen/balanced_max:79580.000 - global_seqlen/mean:78285.625 - actor/entropy_loss:1.256 - training/rollout_probs_diff_max:0.913 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.037 - actor/kl_coef:0.010 - actor/pg_loss:0.052 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.502 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.598 - actor/lr:0.000 - training/global_step:200.000 - training/epoch:2.000 - critic/score/mean:0.618 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.618 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.034 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.034 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:150.505 - response_length/max:2048.000 - response_length/min:32.000 - response_length/clip_ratio:0.001 - prompt_length/mean:461.102 - prompt_length/max:507.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.990 - timing_s/reshard:4.138 - timing_s/gen:26.671 - timing_s/reward:0.151 - timing_s/old_log_prob:7.157 - timing_s/ref:7.150 - timing_s/adv:0.023 - timing_s/update_actor:21.139 - timing_s/dump_rollout_generations:0.264 - timing_s/save_checkpoint:31.144 - timing_s/step:93.729 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.173 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:626285.000 - perf/time_per_step:93.729 - perf/throughput:835.232
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/201.jsonl
step:201 - global_seqlen/min:74104.000 - global_seqlen/max:79361.000 - global_seqlen/minmax_diff:5257.000 - global_seqlen/balanced_min:77429.000 - global_seqlen/balanced_max:77430.000 - global_seqlen/mean:77429.375 - actor/entropy_loss:1.251 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.032 - actor/kl_coef:0.010 - actor/pg_loss:0.017 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.006 - perf/mfu/actor:0.188 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:151.129 - actor/lr:0.000 - training/global_step:201.000 - training/epoch:2.000 - critic/score/mean:0.672 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.672 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:146.104 - response_length/max:364.000 - response_length/min:36.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.812 - prompt_length/max:494.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.444 - timing_s/reshard:4.997 - timing_s/gen:20.993 - timing_s/reward:0.159 - timing_s/old_log_prob:7.225 - timing_s/ref:6.956 - timing_s/adv:0.020 - timing_s/update_actor:20.011 - timing_s/dump_rollout_generations:0.265 - timing_s/step:55.670 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.032 - timing_per_token_ms/gen:0.140 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:619435.000 - perf/time_per_step:55.670 - perf/throughput:1390.862
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/202.jsonl
step:202 - global_seqlen/min:74154.000 - global_seqlen/max:78149.000 - global_seqlen/minmax_diff:3995.000 - global_seqlen/balanced_min:77183.000 - global_seqlen/balanced_max:77238.000 - global_seqlen/mean:77190.250 - actor/entropy_loss:1.199 - training/rollout_probs_diff_max:0.933 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.025 - actor/kl_coef:0.010 - actor/pg_loss:-0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.239 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.453 - actor/lr:0.000 - training/global_step:202.000 - training/epoch:2.000 - critic/score/mean:0.693 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.693 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.009 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.009 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:143.721 - response_length/max:545.000 - response_length/min:24.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.328 - prompt_length/max:503.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.085 - timing_s/reshard:4.509 - timing_s/gen:19.146 - timing_s/reward:0.149 - timing_s/old_log_prob:7.092 - timing_s/ref:7.306 - timing_s/adv:0.020 - timing_s/update_actor:20.941 - timing_s/dump_rollout_generations:0.261 - timing_s/step:54.949 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.130 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:617522.000 - perf/time_per_step:54.949 - perf/throughput:1404.763
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/203.jsonl
step:203 - global_seqlen/min:75282.000 - global_seqlen/max:80410.000 - global_seqlen/minmax_diff:5128.000 - global_seqlen/balanced_min:77459.000 - global_seqlen/balanced_max:77460.000 - global_seqlen/mean:77459.750 - actor/entropy_loss:1.230 - training/rollout_probs_diff_max:0.995 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.029 - actor/kl_coef:0.010 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.431 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:135.373 - actor/lr:0.000 - training/global_step:203.000 - training/epoch:2.000 - critic/score/mean:0.597 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.597 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:144.545 - response_length/max:396.000 - response_length/min:39.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.609 - prompt_length/max:504.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.316 - timing_s/reshard:4.168 - timing_s/gen:18.790 - timing_s/reward:0.150 - timing_s/old_log_prob:7.210 - timing_s/ref:7.103 - timing_s/adv:0.020 - timing_s/update_actor:21.762 - timing_s/dump_rollout_generations:0.294 - timing_s/step:55.359 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.127 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:619678.000 - perf/time_per_step:55.359 - perf/throughput:1399.220
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/204.jsonl
step:204 - global_seqlen/min:75501.000 - global_seqlen/max:79721.000 - global_seqlen/minmax_diff:4220.000 - global_seqlen/balanced_min:77478.000 - global_seqlen/balanced_max:77479.000 - global_seqlen/mean:77478.750 - actor/entropy_loss:1.239 - training/rollout_probs_diff_max:0.990 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.037 - actor/kl_coef:0.010 - actor/pg_loss:0.025 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.310 - perf/mfu/actor:0.168 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.348 - actor/lr:0.000 - training/global_step:204.000 - training/epoch:2.000 - critic/score/mean:0.581 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.581 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.008 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.008 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:144.881 - response_length/max:481.000 - response_length/min:35.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.422 - prompt_length/max:526.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.021 - timing_s/reshard:4.119 - timing_s/gen:18.165 - timing_s/reward:0.149 - timing_s/old_log_prob:7.120 - timing_s/ref:6.949 - timing_s/adv:0.020 - timing_s/update_actor:22.064 - timing_s/dump_rollout_generations:0.261 - timing_s/step:54.764 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.122 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:619830.000 - perf/time_per_step:54.764 - perf/throughput:1414.785
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/205.jsonl
step:205 - global_seqlen/min:76175.000 - global_seqlen/max:79807.000 - global_seqlen/minmax_diff:3632.000 - global_seqlen/balanced_min:77840.000 - global_seqlen/balanced_max:79378.000 - global_seqlen/mean:78033.000 - actor/entropy_loss:1.196 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.019 - actor/kl_coef:0.010 - actor/pg_loss:0.130 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.445 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:123.208 - actor/lr:0.000 - training/global_step:205.000 - training/epoch:3.000 - critic/score/mean:0.601 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.601 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.033 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.033 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:148.758 - response_length/max:2048.000 - response_length/min:30.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.875 - prompt_length/max:533.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.669 - timing_s/reshard:3.986 - timing_s/gen:26.267 - timing_s/reward:0.151 - timing_s/old_log_prob:7.384 - timing_s/ref:7.314 - timing_s/adv:0.024 - timing_s/update_actor:21.868 - timing_s/dump_rollout_generations:0.279 - timing_s/step:63.338 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.172 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:624264.000 - perf/time_per_step:63.338 - perf/throughput:1232.014
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/206.jsonl
step:206 - global_seqlen/min:75102.000 - global_seqlen/max:79977.000 - global_seqlen/minmax_diff:4875.000 - global_seqlen/balanced_min:77637.000 - global_seqlen/balanced_max:77694.000 - global_seqlen/mean:77644.750 - actor/entropy_loss:1.213 - training/rollout_probs_diff_max:0.994 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.024 - actor/kl_coef:0.010 - actor/pg_loss:0.020 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.209 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:123.287 - actor/lr:0.000 - training/global_step:206.000 - training/epoch:3.000 - critic/score/mean:0.710 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.710 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:145.592 - response_length/max:559.000 - response_length/min:25.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.008 - prompt_length/max:529.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.923 - timing_s/reshard:4.137 - timing_s/gen:19.298 - timing_s/reward:0.152 - timing_s/old_log_prob:7.315 - timing_s/ref:7.140 - timing_s/adv:0.020 - timing_s/update_actor:21.535 - timing_s/dump_rollout_generations:0.260 - timing_s/step:55.750 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.129 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:621158.000 - perf/time_per_step:55.750 - perf/throughput:1392.730
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/207.jsonl
step:207 - global_seqlen/min:78313.000 - global_seqlen/max:81604.000 - global_seqlen/minmax_diff:3291.000 - global_seqlen/balanced_min:79602.000 - global_seqlen/balanced_max:79603.000 - global_seqlen/mean:79602.625 - actor/entropy_loss:1.183 - training/rollout_probs_diff_max:0.971 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.033 - actor/kl_coef:0.010 - actor/pg_loss:-0.022 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.299 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:123.354 - actor/lr:0.000 - training/global_step:207.000 - training/epoch:3.000 - critic/score/mean:0.561 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.561 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:159.739 - response_length/max:455.000 - response_length/min:45.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.156 - prompt_length/max:488.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.777 - timing_s/reshard:4.129 - timing_s/gen:19.132 - timing_s/reward:0.154 - timing_s/old_log_prob:7.209 - timing_s/ref:7.162 - timing_s/adv:0.020 - timing_s/update_actor:22.295 - timing_s/dump_rollout_generations:0.263 - timing_s/step:56.270 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:636821.000 - perf/time_per_step:56.270 - perf/throughput:1414.662
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/208.jsonl
step:208 - global_seqlen/min:75876.000 - global_seqlen/max:79836.000 - global_seqlen/minmax_diff:3960.000 - global_seqlen/balanced_min:77849.000 - global_seqlen/balanced_max:77850.000 - global_seqlen/mean:77849.250 - actor/entropy_loss:1.191 - training/rollout_probs_diff_max:0.995 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.032 - actor/kl_coef:0.010 - actor/pg_loss:0.011 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.479 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:123.872 - actor/lr:0.000 - training/global_step:208.000 - training/epoch:3.000 - critic/score/mean:0.621 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.621 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:149.408 - response_length/max:376.000 - response_length/min:24.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.789 - prompt_length/max:500.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.259 - timing_s/reshard:4.174 - timing_s/gen:18.001 - timing_s/reward:0.154 - timing_s/old_log_prob:7.362 - timing_s/ref:7.170 - timing_s/adv:0.020 - timing_s/update_actor:21.903 - timing_s/dump_rollout_generations:0.260 - timing_s/step:54.906 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.118 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:622794.000 - perf/time_per_step:54.906 - perf/throughput:1417.876
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/209.jsonl
step:209 - global_seqlen/min:76784.000 - global_seqlen/max:80635.000 - global_seqlen/minmax_diff:3851.000 - global_seqlen/balanced_min:78588.000 - global_seqlen/balanced_max:78633.000 - global_seqlen/mean:78594.000 - actor/entropy_loss:1.213 - training/rollout_probs_diff_max:0.998 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.043 - actor/kl_coef:0.010 - actor/pg_loss:0.013 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.490 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:124.340 - actor/lr:0.000 - training/global_step:209.000 - training/epoch:3.000 - critic/score/mean:0.664 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.664 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.011 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:152.727 - response_length/max:586.000 - response_length/min:49.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.289 - prompt_length/max:517.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.245 - timing_s/reshard:7.099 - timing_s/gen:21.880 - timing_s/reward:0.153 - timing_s/old_log_prob:7.358 - timing_s/ref:7.250 - timing_s/adv:0.020 - timing_s/update_actor:21.525 - timing_s/dump_rollout_generations:0.264 - timing_s/step:58.482 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.140 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:628752.000 - perf/time_per_step:58.482 - perf/throughput:1343.901
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/210.jsonl
step:210 - global_seqlen/min:77890.000 - global_seqlen/max:82011.000 - global_seqlen/minmax_diff:4121.000 - global_seqlen/balanced_min:79505.000 - global_seqlen/balanced_max:80971.000 - global_seqlen/mean:79688.875 - actor/entropy_loss:1.149 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.042 - actor/kl_coef:0.010 - actor/pg_loss:0.058 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.610 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:123.990 - actor/lr:0.000 - training/global_step:210.000 - training/epoch:3.000 - critic/score/mean:0.640 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.640 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.029 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.029 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:159.319 - response_length/max:2048.000 - response_length/min:26.000 - response_length/clip_ratio:0.001 - prompt_length/mean:463.250 - prompt_length/max:503.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.101 - timing_s/reshard:7.778 - timing_s/gen:31.146 - timing_s/reward:0.171 - timing_s/old_log_prob:7.449 - timing_s/ref:7.368 - timing_s/adv:0.022 - timing_s/update_actor:21.929 - timing_s/dump_rollout_generations:0.263 - timing_s/step:68.383 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.191 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:637511.000 - perf/time_per_step:68.383 - perf/throughput:1165.326
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/211.jsonl
step:211 - global_seqlen/min:76395.000 - global_seqlen/max:80932.000 - global_seqlen/minmax_diff:4537.000 - global_seqlen/balanced_min:78894.000 - global_seqlen/balanced_max:78895.000 - global_seqlen/mean:78894.500 - actor/entropy_loss:1.215 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.050 - actor/kl_coef:0.010 - actor/pg_loss:0.010 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.586 - perf/mfu/actor:0.179 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:124.012 - actor/lr:0.000 - training/global_step:211.000 - training/epoch:3.000 - critic/score/mean:0.589 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.589 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.011 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.011 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:153.793 - response_length/max:485.000 - response_length/min:23.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.570 - prompt_length/max:531.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.277 - timing_s/reshard:4.394 - timing_s/gen:18.257 - timing_s/reward:0.151 - timing_s/old_log_prob:7.333 - timing_s/ref:7.101 - timing_s/adv:0.020 - timing_s/update_actor:21.167 - timing_s/dump_rollout_generations:0.261 - timing_s/step:54.323 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:631156.000 - perf/time_per_step:54.323 - perf/throughput:1452.332
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/212.jsonl
step:212 - global_seqlen/min:74955.000 - global_seqlen/max:82390.000 - global_seqlen/minmax_diff:7435.000 - global_seqlen/balanced_min:78460.000 - global_seqlen/balanced_max:78461.000 - global_seqlen/mean:78460.750 - actor/entropy_loss:1.151 - training/rollout_probs_diff_max:0.997 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.025 - actor/kl_coef:0.010 - actor/pg_loss:-0.002 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.309 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:124.635 - actor/lr:0.000 - training/global_step:212.000 - training/epoch:3.000 - critic/score/mean:0.708 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.708 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.000 - critic/advantages/max:1.208 - critic/advantages/min:-2.475 - critic/returns/mean:-0.000 - critic/returns/max:1.208 - critic/returns/min:-2.475 - response_length/mean:152.451 - response_length/max:445.000 - response_length/min:43.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.523 - prompt_length/max:500.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.385 - timing_s/reshard:6.300 - timing_s/gen:20.250 - timing_s/reward:0.153 - timing_s/old_log_prob:7.130 - timing_s/ref:7.015 - timing_s/adv:0.020 - timing_s/update_actor:21.465 - timing_s/dump_rollout_generations:0.261 - timing_s/step:56.327 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.130 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:627686.000 - perf/time_per_step:56.327 - perf/throughput:1392.951
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/213.jsonl
step:213 - global_seqlen/min:78562.000 - global_seqlen/max:81591.000 - global_seqlen/minmax_diff:3029.000 - global_seqlen/balanced_min:79745.000 - global_seqlen/balanced_max:79746.000 - global_seqlen/mean:79745.250 - actor/entropy_loss:1.092 - training/rollout_probs_diff_max:0.990 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.075 - actor/kl_loss:0.018 - actor/kl_coef:0.010 - actor/pg_loss:0.011 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.486 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:125.277 - actor/lr:0.000 - training/global_step:213.000 - training/epoch:3.000 - critic/score/mean:0.619 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.619 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.001 - critic/advantages/max:1.620 - critic/advantages/min:-0.725 - critic/returns/mean:-0.001 - critic/returns/max:1.620 - critic/returns/min:-0.725 - response_length/mean:159.439 - response_length/max:389.000 - response_length/min:39.000 - response_length/clip_ratio:0.000 - prompt_length/mean:463.570 - prompt_length/max:519.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.192 - timing_s/reshard:6.942 - timing_s/gen:20.685 - timing_s/reward:0.153 - timing_s/old_log_prob:7.430 - timing_s/ref:7.135 - timing_s/adv:0.019 - timing_s/update_actor:21.943 - timing_s/dump_rollout_generations:0.264 - timing_s/step:57.656 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.127 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:637962.000 - perf/time_per_step:57.656 - perf/throughput:1383.116
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/214.jsonl
step:214 - global_seqlen/min:75939.000 - global_seqlen/max:80879.000 - global_seqlen/minmax_diff:4940.000 - global_seqlen/balanced_min:78306.000 - global_seqlen/balanced_max:78307.000 - global_seqlen/mean:78306.375 - actor/entropy_loss:1.143 - training/rollout_probs_diff_max:0.989 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.075 - actor/kl_loss:0.037 - actor/kl_coef:0.010 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.183 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:125.632 - actor/lr:0.000 - training/global_step:214.000 - training/epoch:3.000 - critic/score/mean:0.649 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.649 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:1.208 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:1.208 - critic/returns/min:-2.475 - response_length/mean:153.479 - response_length/max:496.000 - response_length/min:37.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.289 - prompt_length/max:499.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.247 - timing_s/reshard:8.081 - timing_s/gen:21.870 - timing_s/reward:0.150 - timing_s/old_log_prob:7.165 - timing_s/ref:7.099 - timing_s/adv:0.020 - timing_s/update_actor:21.419 - timing_s/dump_rollout_generations:0.261 - timing_s/step:58.015 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.139 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:626451.000 - perf/time_per_step:58.015 - perf/throughput:1349.759
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/215.jsonl
step:215 - global_seqlen/min:75898.000 - global_seqlen/max:80665.000 - global_seqlen/minmax_diff:4767.000 - global_seqlen/balanced_min:77937.000 - global_seqlen/balanced_max:77938.000 - global_seqlen/mean:77937.500 - actor/entropy_loss:1.134 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.041 - actor/kl_coef:0.010 - actor/pg_loss:0.006 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.280 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:125.931 - actor/lr:0.000 - training/global_step:215.000 - training/epoch:3.000 - critic/score/mean:0.678 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.678 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.001 - critic/advantages/max:2.475 - critic/advantages/min:-0.354 - critic/returns/mean:-0.001 - critic/returns/max:2.475 - critic/returns/min:-0.354 - response_length/mean:149.145 - response_length/max:397.000 - response_length/min:18.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.742 - prompt_length/max:526.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.084 - timing_s/reshard:8.312 - timing_s/gen:21.954 - timing_s/reward:0.151 - timing_s/old_log_prob:7.081 - timing_s/ref:6.892 - timing_s/adv:0.019 - timing_s/update_actor:21.025 - timing_s/dump_rollout_generations:0.262 - timing_s/step:57.419 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.144 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:623500.000 - perf/time_per_step:57.419 - perf/throughput:1357.350
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/216.jsonl
step:216 - global_seqlen/min:76047.000 - global_seqlen/max:83589.000 - global_seqlen/minmax_diff:7542.000 - global_seqlen/balanced_min:79428.000 - global_seqlen/balanced_max:79429.000 - global_seqlen/mean:79428.375 - actor/entropy_loss:1.173 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.060 - actor/kl_coef:0.010 - actor/pg_loss:0.070 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.448 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:126.391 - actor/lr:0.000 - training/global_step:216.000 - training/epoch:3.000 - critic/score/mean:0.631 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.631 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:160.839 - response_length/max:414.000 - response_length/min:38.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.695 - prompt_length/max:497.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.030 - timing_s/reshard:5.320 - timing_s/gen:19.924 - timing_s/reward:0.153 - timing_s/old_log_prob:6.931 - timing_s/ref:7.187 - timing_s/adv:0.021 - timing_s/update_actor:22.308 - timing_s/dump_rollout_generations:0.288 - timing_s/step:56.843 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.121 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:635427.000 - perf/time_per_step:56.843 - perf/throughput:1397.324
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/217.jsonl
step:217 - global_seqlen/min:75953.000 - global_seqlen/max:82192.000 - global_seqlen/minmax_diff:6239.000 - global_seqlen/balanced_min:79945.000 - global_seqlen/balanced_max:79946.000 - global_seqlen/mean:79945.375 - actor/entropy_loss:1.173 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.019 - actor/kl_coef:0.010 - actor/pg_loss:-0.014 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.504 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:126.635 - actor/lr:0.000 - training/global_step:217.000 - training/epoch:3.000 - critic/score/mean:0.660 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.660 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:162.964 - response_length/max:453.000 - response_length/min:30.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.609 - prompt_length/max:521.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.264 - timing_s/reshard:4.102 - timing_s/gen:18.892 - timing_s/reward:0.154 - timing_s/old_log_prob:7.277 - timing_s/ref:7.241 - timing_s/adv:0.021 - timing_s/update_actor:22.491 - timing_s/dump_rollout_generations:0.283 - timing_s/step:56.390 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:639563.000 - perf/time_per_step:56.390 - perf/throughput:1417.734
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/218.jsonl
step:218 - global_seqlen/min:77929.000 - global_seqlen/max:83369.000 - global_seqlen/minmax_diff:5440.000 - global_seqlen/balanced_min:79983.000 - global_seqlen/balanced_max:79984.000 - global_seqlen/mean:79983.250 - actor/entropy_loss:1.107 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.075 - actor/kl_loss:0.028 - actor/kl_coef:0.010 - actor/pg_loss:-0.006 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.304 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:127.193 - actor/lr:0.000 - training/global_step:218.000 - training/epoch:3.000 - critic/score/mean:0.553 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.553 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:163.775 - response_length/max:468.000 - response_length/min:38.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.094 - prompt_length/max:515.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.956 - timing_s/reshard:4.132 - timing_s/gen:18.641 - timing_s/reward:0.155 - timing_s/old_log_prob:7.114 - timing_s/ref:7.019 - timing_s/adv:0.021 - timing_s/update_actor:21.827 - timing_s/dump_rollout_generations:0.264 - timing_s/step:55.072 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.111 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:639866.000 - perf/time_per_step:55.072 - perf/throughput:1452.347
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/219.jsonl
step:219 - global_seqlen/min:77065.000 - global_seqlen/max:81109.000 - global_seqlen/minmax_diff:4044.000 - global_seqlen/balanced_min:79220.000 - global_seqlen/balanced_max:79221.000 - global_seqlen/mean:79220.750 - actor/entropy_loss:1.161 - training/rollout_probs_diff_max:0.997 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.043 - actor/kl_coef:0.010 - actor/pg_loss:0.017 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.137 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:126.962 - actor/lr:0.000 - training/global_step:219.000 - training/epoch:3.000 - critic/score/mean:0.674 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.674 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.006 - critic/advantages/max:0.540 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:0.540 - critic/returns/min:-2.475 - response_length/mean:158.092 - response_length/max:483.000 - response_length/min:29.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.820 - prompt_length/max:517.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.659 - timing_s/reshard:4.126 - timing_s/gen:19.029 - timing_s/reward:0.152 - timing_s/old_log_prob:7.140 - timing_s/ref:6.973 - timing_s/adv:0.020 - timing_s/update_actor:21.938 - timing_s/dump_rollout_generations:0.269 - timing_s/step:55.553 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.118 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:633766.000 - perf/time_per_step:55.553 - perf/throughput:1426.030
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/220.jsonl
step:220 - global_seqlen/min:78463.000 - global_seqlen/max:83623.000 - global_seqlen/minmax_diff:5160.000 - global_seqlen/balanced_min:80528.000 - global_seqlen/balanced_max:81983.000 - global_seqlen/mean:80710.625 - actor/entropy_loss:1.145 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.032 - actor/kl_coef:0.010 - actor/pg_loss:0.096 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.927 - perf/mfu/actor:0.182 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:126.810 - actor/lr:0.000 - training/global_step:220.000 - training/epoch:3.000 - critic/score/mean:0.678 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.678 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.030 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.030 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:168.442 - response_length/max:2048.000 - response_length/min:50.000 - response_length/clip_ratio:0.001 - prompt_length/mean:462.109 - prompt_length/max:516.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.740 - timing_s/reshard:4.163 - timing_s/gen:26.516 - timing_s/reward:0.155 - timing_s/old_log_prob:7.316 - timing_s/ref:7.083 - timing_s/adv:0.023 - timing_s/update_actor:21.297 - timing_s/dump_rollout_generations:0.264 - timing_s/step:62.693 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.154 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:645685.000 - perf/time_per_step:62.693 - perf/throughput:1287.394
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/221.jsonl
step:221 - global_seqlen/min:79034.000 - global_seqlen/max:80736.000 - global_seqlen/minmax_diff:1702.000 - global_seqlen/balanced_min:79905.000 - global_seqlen/balanced_max:79906.000 - global_seqlen/mean:79905.750 - actor/entropy_loss:1.208 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.019 - actor/kl_coef:0.010 - actor/pg_loss:-0.075 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.750 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:128.006 - actor/lr:0.000 - training/global_step:221.000 - training/epoch:3.000 - critic/score/mean:0.688 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.688 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.008 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.008 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:161.982 - response_length/max:402.000 - response_length/min:48.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.281 - prompt_length/max:508.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.465 - timing_s/reshard:4.104 - timing_s/gen:18.796 - timing_s/reward:0.152 - timing_s/old_log_prob:7.264 - timing_s/ref:7.197 - timing_s/adv:0.019 - timing_s/update_actor:21.683 - timing_s/dump_rollout_generations:0.264 - timing_s/step:55.404 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:639246.000 - perf/time_per_step:55.404 - perf/throughput:1442.234
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/222.jsonl
step:222 - global_seqlen/min:77383.000 - global_seqlen/max:82050.000 - global_seqlen/minmax_diff:4667.000 - global_seqlen/balanced_min:79635.000 - global_seqlen/balanced_max:79636.000 - global_seqlen/mean:79635.500 - actor/entropy_loss:1.229 - training/rollout_probs_diff_max:0.998 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.033 - actor/kl_coef:0.010 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.544 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:128.667 - actor/lr:0.000 - training/global_step:222.000 - training/epoch:3.000 - critic/score/mean:0.689 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.689 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:162.902 - response_length/max:437.000 - response_length/min:37.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.250 - prompt_length/max:506.000 - prompt_length/min:430.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.211 - timing_s/reshard:4.123 - timing_s/gen:17.876 - timing_s/reward:0.153 - timing_s/old_log_prob:7.304 - timing_s/ref:7.149 - timing_s/adv:0.019 - timing_s/update_actor:21.510 - timing_s/dump_rollout_generations:0.290 - timing_s/step:54.331 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.107 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:637084.000 - perf/time_per_step:54.331 - perf/throughput:1465.734
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/223.jsonl
step:223 - global_seqlen/min:77358.000 - global_seqlen/max:81058.000 - global_seqlen/minmax_diff:3700.000 - global_seqlen/balanced_min:78896.000 - global_seqlen/balanced_max:78897.000 - global_seqlen/mean:78896.250 - actor/entropy_loss:1.187 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.075 - actor/kl_loss:0.040 - actor/kl_coef:0.010 - actor/pg_loss:0.022 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.282 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:129.688 - actor/lr:0.000 - training/global_step:223.000 - training/epoch:3.000 - critic/score/mean:0.640 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.640 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:1.208 - critic/advantages/min:-2.475 - critic/returns/mean:-0.005 - critic/returns/max:1.208 - critic/returns/min:-2.475 - response_length/mean:156.885 - response_length/max:420.000 - response_length/min:46.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.492 - prompt_length/max:535.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.330 - timing_s/reshard:6.404 - timing_s/gen:20.305 - timing_s/reward:0.154 - timing_s/old_log_prob:7.303 - timing_s/ref:7.263 - timing_s/adv:0.020 - timing_s/update_actor:21.548 - timing_s/dump_rollout_generations:0.262 - timing_s/step:56.889 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.126 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:631170.000 - perf/time_per_step:56.889 - perf/throughput:1386.844
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/224.jsonl
step:224 - global_seqlen/min:78373.000 - global_seqlen/max:83689.000 - global_seqlen/minmax_diff:5316.000 - global_seqlen/balanced_min:80902.000 - global_seqlen/balanced_max:80902.000 - global_seqlen/mean:80902.000 - actor/entropy_loss:1.190 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.026 - actor/kl_coef:0.010 - actor/pg_loss:-0.023 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.532 - perf/mfu/actor:0.183 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:130.581 - actor/lr:0.000 - training/global_step:224.000 - training/epoch:3.000 - critic/score/mean:0.645 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.645 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.002 - critic/advantages/max:2.475 - critic/advantages/min:-1.620 - critic/returns/mean:0.002 - critic/returns/max:2.475 - critic/returns/min:-1.620 - response_length/mean:170.805 - response_length/max:412.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.242 - prompt_length/max:498.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.762 - timing_s/reshard:7.596 - timing_s/gen:21.915 - timing_s/reward:0.156 - timing_s/old_log_prob:7.284 - timing_s/ref:7.248 - timing_s/adv:0.020 - timing_s/update_actor:21.241 - timing_s/dump_rollout_generations:0.265 - timing_s/step:58.162 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:647216.000 - perf/time_per_step:58.162 - perf/throughput:1390.985
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/225.jsonl
step:225 - global_seqlen/min:77253.000 - global_seqlen/max:81701.000 - global_seqlen/minmax_diff:4448.000 - global_seqlen/balanced_min:79124.000 - global_seqlen/balanced_max:80577.000 - global_seqlen/mean:79308.125 - actor/entropy_loss:1.126 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.034 - actor/kl_coef:0.010 - actor/pg_loss:0.026 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.628 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:131.588 - actor/lr:0.000 - training/global_step:225.000 - training/epoch:3.000 - critic/score/mean:0.635 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.635 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.010 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:159.009 - response_length/max:2048.000 - response_length/min:43.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.586 - prompt_length/max:521.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.692 - timing_s/reshard:8.383 - timing_s/gen:31.344 - timing_s/reward:0.176 - timing_s/old_log_prob:7.263 - timing_s/ref:7.117 - timing_s/adv:0.020 - timing_s/update_actor:21.792 - timing_s/dump_rollout_generations:0.263 - timing_s/step:68.011 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.193 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:634465.000 - perf/time_per_step:68.011 - perf/throughput:1166.110
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/226.jsonl
step:226 - global_seqlen/min:77632.000 - global_seqlen/max:80528.000 - global_seqlen/minmax_diff:2896.000 - global_seqlen/balanced_min:79008.000 - global_seqlen/balanced_max:79009.000 - global_seqlen/mean:79008.750 - actor/entropy_loss:1.148 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.031 - actor/kl_coef:0.010 - actor/pg_loss:-0.018 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.230 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:132.642 - actor/lr:0.000 - training/global_step:226.000 - training/epoch:3.000 - critic/score/mean:0.701 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.701 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:157.623 - response_length/max:381.000 - response_length/min:43.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.633 - prompt_length/max:491.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.046 - timing_s/reshard:4.105 - timing_s/gen:17.697 - timing_s/reward:0.151 - timing_s/old_log_prob:7.002 - timing_s/ref:6.859 - timing_s/adv:0.020 - timing_s/update_actor:21.891 - timing_s/dump_rollout_generations:0.263 - timing_s/step:53.911 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.110 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:632070.000 - perf/time_per_step:53.911 - perf/throughput:1465.536
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/227.jsonl
step:227 - global_seqlen/min:77441.000 - global_seqlen/max:82362.000 - global_seqlen/minmax_diff:4921.000 - global_seqlen/balanced_min:79553.000 - global_seqlen/balanced_max:79726.000 - global_seqlen/mean:79574.750 - actor/entropy_loss:1.173 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.031 - actor/kl_coef:0.010 - actor/pg_loss:-0.024 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.425 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:133.584 - actor/lr:0.000 - training/global_step:227.000 - training/epoch:3.000 - critic/score/mean:0.619 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.619 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.007 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:162.061 - response_length/max:720.000 - response_length/min:47.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.617 - prompt_length/max:523.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.144 - timing_s/reshard:7.233 - timing_s/gen:22.930 - timing_s/reward:0.154 - timing_s/old_log_prob:7.302 - timing_s/ref:7.126 - timing_s/adv:0.021 - timing_s/update_actor:22.001 - timing_s/dump_rollout_generations:0.278 - timing_s/step:59.845 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.138 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:636598.000 - perf/time_per_step:59.845 - perf/throughput:1329.681
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/228.jsonl
step:228 - global_seqlen/min:77492.000 - global_seqlen/max:82465.000 - global_seqlen/minmax_diff:4973.000 - global_seqlen/balanced_min:79726.000 - global_seqlen/balanced_max:79727.000 - global_seqlen/mean:79726.750 - actor/entropy_loss:1.185 - training/rollout_probs_diff_max:0.991 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.023 - actor/kl_coef:0.010 - actor/pg_loss:-0.004 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.320 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.308 - actor/lr:0.000 - training/global_step:228.000 - training/epoch:3.000 - critic/score/mean:0.676 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.676 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.000 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:163.053 - response_length/max:453.000 - response_length/min:21.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.812 - prompt_length/max:516.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.695 - timing_s/reshard:7.402 - timing_s/gen:21.651 - timing_s/reward:0.156 - timing_s/old_log_prob:7.127 - timing_s/ref:7.069 - timing_s/adv:0.022 - timing_s/update_actor:22.153 - timing_s/dump_rollout_generations:0.265 - timing_s/step:58.477 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.130 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:637814.000 - perf/time_per_step:58.477 - perf/throughput:1363.385
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/229.jsonl
step:229 - global_seqlen/min:78159.000 - global_seqlen/max:82632.000 - global_seqlen/minmax_diff:4473.000 - global_seqlen/balanced_min:80188.000 - global_seqlen/balanced_max:80855.000 - global_seqlen/mean:80278.750 - actor/entropy_loss:1.179 - training/rollout_probs_diff_max:0.985 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.024 - actor/kl_coef:0.010 - actor/pg_loss:-0.008 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.843 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.801 - actor/lr:0.000 - training/global_step:229.000 - training/epoch:3.000 - critic/score/mean:0.663 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.663 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:166.959 - response_length/max:1252.000 - response_length/min:48.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.219 - prompt_length/max:495.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:17.672 - timing_s/reshard:7.364 - timing_s/gen:25.585 - timing_s/reward:0.154 - timing_s/old_log_prob:7.468 - timing_s/ref:7.248 - timing_s/adv:0.019 - timing_s/update_actor:21.865 - timing_s/dump_rollout_generations:0.262 - timing_s/step:62.628 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.150 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:642230.000 - perf/time_per_step:62.628 - perf/throughput:1281.828
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/230.jsonl
step:230 - global_seqlen/min:77858.000 - global_seqlen/max:81102.000 - global_seqlen/minmax_diff:3244.000 - global_seqlen/balanced_min:80007.000 - global_seqlen/balanced_max:80126.000 - global_seqlen/mean:80022.000 - actor/entropy_loss:1.245 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.028 - actor/kl_coef:0.010 - actor/pg_loss:0.038 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.538 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.668 - actor/lr:0.000 - training/global_step:230.000 - training/epoch:3.000 - critic/score/mean:0.685 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.685 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:165.078 - response_length/max:627.000 - response_length/min:43.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.094 - prompt_length/max:516.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.217 - timing_s/reshard:6.097 - timing_s/gen:20.861 - timing_s/reward:0.155 - timing_s/old_log_prob:7.203 - timing_s/ref:7.091 - timing_s/adv:0.020 - timing_s/update_actor:22.559 - timing_s/dump_rollout_generations:0.264 - timing_s/step:58.185 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.123 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:640176.000 - perf/time_per_step:58.185 - perf/throughput:1375.302
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/231.jsonl
step:231 - global_seqlen/min:76809.000 - global_seqlen/max:82727.000 - global_seqlen/minmax_diff:5918.000 - global_seqlen/balanced_min:80134.000 - global_seqlen/balanced_max:80135.000 - global_seqlen/mean:80134.375 - actor/entropy_loss:1.155 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.043 - actor/kl_coef:0.010 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.460 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.693 - actor/lr:0.000 - training/global_step:231.000 - training/epoch:3.000 - critic/score/mean:0.602 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.602 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:164.448 - response_length/max:427.000 - response_length/min:28.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.602 - prompt_length/max:497.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.229 - timing_s/reshard:7.080 - timing_s/gen:20.860 - timing_s/reward:0.174 - timing_s/old_log_prob:7.304 - timing_s/ref:7.145 - timing_s/adv:0.021 - timing_s/update_actor:21.613 - timing_s/dump_rollout_generations:0.289 - timing_s/step:57.438 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:641075.000 - perf/time_per_step:57.438 - perf/throughput:1395.142
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/232.jsonl
step:232 - global_seqlen/min:77003.000 - global_seqlen/max:80601.000 - global_seqlen/minmax_diff:3598.000 - global_seqlen/balanced_min:78995.000 - global_seqlen/balanced_max:78996.000 - global_seqlen/mean:78995.375 - actor/entropy_loss:1.130 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.020 - actor/kl_coef:0.010 - actor/pg_loss:0.008 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.303 - perf/mfu/actor:0.180 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.581 - actor/lr:0.000 - training/global_step:232.000 - training/epoch:3.000 - critic/score/mean:0.716 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.716 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.003 - critic/advantages/max:2.475 - critic/advantages/min:-0.540 - critic/returns/mean:0.003 - critic/returns/max:2.475 - critic/returns/min:-0.540 - response_length/mean:157.479 - response_length/max:462.000 - response_length/min:30.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.672 - prompt_length/max:521.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.124 - timing_s/reshard:7.885 - timing_s/gen:21.565 - timing_s/reward:0.154 - timing_s/old_log_prob:7.153 - timing_s/ref:7.254 - timing_s/adv:0.019 - timing_s/update_actor:21.112 - timing_s/dump_rollout_generations:0.281 - timing_s/step:57.570 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.134 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:631963.000 - perf/time_per_step:57.570 - perf/throughput:1372.155
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/233.jsonl
step:233 - global_seqlen/min:76908.000 - global_seqlen/max:82689.000 - global_seqlen/minmax_diff:5781.000 - global_seqlen/balanced_min:79461.000 - global_seqlen/balanced_max:80967.000 - global_seqlen/mean:79649.375 - actor/entropy_loss:1.174 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.025 - actor/kl_coef:0.010 - actor/pg_loss:0.080 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.180 - perf/mfu/actor:0.181 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.479 - actor/lr:0.000 - training/global_step:233.000 - training/epoch:3.000 - critic/score/mean:0.624 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.624 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.028 - critic/advantages/max:0.725 - critic/advantages/min:-2.475 - critic/returns/mean:-0.028 - critic/returns/max:0.725 - critic/returns/min:-2.475 - response_length/mean:163.222 - response_length/max:2048.000 - response_length/min:33.000 - response_length/clip_ratio:0.001 - prompt_length/mean:459.039 - prompt_length/max:512.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.843 - timing_s/reshard:8.871 - timing_s/gen:32.009 - timing_s/reward:0.154 - timing_s/old_log_prob:7.331 - timing_s/ref:7.186 - timing_s/adv:0.021 - timing_s/update_actor:21.222 - timing_s/dump_rollout_generations:0.265 - timing_s/step:68.222 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.192 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:637195.000 - perf/time_per_step:68.222 - perf/throughput:1167.502
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/234.jsonl
step:234 - global_seqlen/min:76350.000 - global_seqlen/max:81755.000 - global_seqlen/minmax_diff:5405.000 - global_seqlen/balanced_min:78902.000 - global_seqlen/balanced_max:78903.000 - global_seqlen/mean:78902.500 - actor/entropy_loss:1.214 - training/rollout_probs_diff_max:0.994 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.030 - actor/kl_coef:0.010 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.303 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.759 - actor/lr:0.000 - training/global_step:234.000 - training/epoch:3.000 - critic/score/mean:0.691 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.691 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:156.730 - response_length/max:449.000 - response_length/min:44.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.695 - prompt_length/max:499.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.377 - timing_s/reshard:4.859 - timing_s/gen:18.782 - timing_s/reward:0.152 - timing_s/old_log_prob:7.101 - timing_s/ref:7.051 - timing_s/adv:0.020 - timing_s/update_actor:21.502 - timing_s/dump_rollout_generations:0.260 - timing_s/step:54.898 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:631220.000 - perf/time_per_step:54.898 - perf/throughput:1437.250
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/235.jsonl
step:235 - global_seqlen/min:76952.000 - global_seqlen/max:79968.000 - global_seqlen/minmax_diff:3016.000 - global_seqlen/balanced_min:79198.000 - global_seqlen/balanced_max:79199.000 - global_seqlen/mean:79198.250 - actor/entropy_loss:1.249 - training/rollout_probs_diff_max:0.997 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.028 - actor/kl_coef:0.010 - actor/pg_loss:0.011 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.377 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.471 - actor/lr:0.000 - training/global_step:235.000 - training/epoch:3.000 - critic/score/mean:0.629 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.629 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.002 - critic/advantages/max:2.475 - critic/advantages/min:-1.620 - critic/returns/mean:0.002 - critic/returns/max:2.475 - critic/returns/min:-1.620 - response_length/mean:159.088 - response_length/max:429.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.648 - prompt_length/max:495.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.456 - timing_s/reshard:7.528 - timing_s/gen:21.548 - timing_s/reward:0.152 - timing_s/old_log_prob:7.143 - timing_s/ref:7.153 - timing_s/adv:0.019 - timing_s/update_actor:21.463 - timing_s/dump_rollout_generations:0.263 - timing_s/step:57.771 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.132 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:633586.000 - perf/time_per_step:57.771 - perf/throughput:1370.900
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/236.jsonl
step:236 - global_seqlen/min:77720.000 - global_seqlen/max:82289.000 - global_seqlen/minmax_diff:4569.000 - global_seqlen/balanced_min:80063.000 - global_seqlen/balanced_max:80064.000 - global_seqlen/mean:80063.375 - actor/entropy_loss:1.214 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.040 - actor/kl_coef:0.010 - actor/pg_loss:-0.006 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.534 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.493 - actor/lr:0.000 - training/global_step:236.000 - training/epoch:3.000 - critic/score/mean:0.611 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.611 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.354 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:0.354 - critic/returns/min:-2.475 - response_length/mean:162.190 - response_length/max:563.000 - response_length/min:35.000 - response_length/clip_ratio:0.000 - prompt_length/mean:463.305 - prompt_length/max:511.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.120 - timing_s/reshard:8.395 - timing_s/gen:23.087 - timing_s/reward:0.155 - timing_s/old_log_prob:7.201 - timing_s/ref:7.180 - timing_s/adv:0.021 - timing_s/update_actor:22.081 - timing_s/dump_rollout_generations:0.262 - timing_s/step:60.016 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.139 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:640507.000 - perf/time_per_step:60.016 - perf/throughput:1334.040
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/237.jsonl
step:237 - global_seqlen/min:77341.000 - global_seqlen/max:83700.000 - global_seqlen/minmax_diff:6359.000 - global_seqlen/balanced_min:79801.000 - global_seqlen/balanced_max:81278.000 - global_seqlen/mean:79986.375 - actor/entropy_loss:1.205 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.033 - actor/kl_coef:0.010 - actor/pg_loss:0.065 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.528 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.916 - actor/lr:0.000 - training/global_step:237.000 - training/epoch:3.000 - critic/score/mean:0.623 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.623 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.029 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.029 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:162.839 - response_length/max:2048.000 - response_length/min:42.000 - response_length/clip_ratio:0.001 - prompt_length/mean:462.055 - prompt_length/max:505.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.427 - timing_s/reshard:7.823 - timing_s/gen:31.507 - timing_s/reward:0.152 - timing_s/old_log_prob:7.465 - timing_s/ref:7.318 - timing_s/adv:0.021 - timing_s/update_actor:21.989 - timing_s/dump_rollout_generations:0.289 - timing_s/step:68.773 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.189 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:639891.000 - perf/time_per_step:68.773 - perf/throughput:1163.047
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/238.jsonl
step:238 - global_seqlen/min:77592.000 - global_seqlen/max:82038.000 - global_seqlen/minmax_diff:4446.000 - global_seqlen/balanced_min:79320.000 - global_seqlen/balanced_max:79321.000 - global_seqlen/mean:79320.250 - actor/entropy_loss:1.207 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.022 - actor/kl_coef:0.010 - actor/pg_loss:-0.014 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.388 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.991 - actor/lr:0.000 - training/global_step:238.000 - training/epoch:3.000 - critic/score/mean:0.640 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.640 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:159.650 - response_length/max:454.000 - response_length/min:17.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.039 - prompt_length/max:506.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.918 - timing_s/reshard:4.137 - timing_s/gen:19.040 - timing_s/reward:0.154 - timing_s/old_log_prob:7.434 - timing_s/ref:7.208 - timing_s/adv:0.020 - timing_s/update_actor:22.284 - timing_s/dump_rollout_generations:0.261 - timing_s/step:56.431 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:634562.000 - perf/time_per_step:56.431 - perf/throughput:1405.613
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/239.jsonl
step:239 - global_seqlen/min:75579.000 - global_seqlen/max:81988.000 - global_seqlen/minmax_diff:6409.000 - global_seqlen/balanced_min:78928.000 - global_seqlen/balanced_max:78929.000 - global_seqlen/mean:78928.250 - actor/entropy_loss:1.234 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.025 - actor/kl_coef:0.010 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.209 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.911 - actor/lr:0.000 - training/global_step:239.000 - training/epoch:3.000 - critic/score/mean:0.719 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.719 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.001 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:156.283 - response_length/max:426.000 - response_length/min:33.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.344 - prompt_length/max:523.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.151 - timing_s/reshard:4.987 - timing_s/gen:18.703 - timing_s/reward:0.152 - timing_s/old_log_prob:7.259 - timing_s/ref:7.084 - timing_s/adv:0.019 - timing_s/update_actor:22.234 - timing_s/dump_rollout_generations:0.263 - timing_s/step:55.742 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:631426.000 - perf/time_per_step:55.742 - perf/throughput:1415.967
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/240.jsonl
local_global_step_folder: ../ckpt/checkpoints/global_step_240
step:240 - global_seqlen/min:77397.000 - global_seqlen/max:81913.000 - global_seqlen/minmax_diff:4516.000 - global_seqlen/balanced_min:79389.000 - global_seqlen/balanced_max:79390.000 - global_seqlen/mean:79389.375 - actor/entropy_loss:1.252 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.049 - training/rollout_probs_diff_std:0.080 - actor/kl_loss:0.029 - actor/kl_coef:0.010 - actor/pg_loss:-0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.756 - perf/mfu/actor:0.179 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:135.036 - actor/lr:0.000 - training/global_step:240.000 - training/epoch:3.000 - critic/score/mean:0.618 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.618 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:159.714 - response_length/max:499.000 - response_length/min:51.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.516 - prompt_length/max:509.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.667 - timing_s/reshard:7.171 - timing_s/gen:21.387 - timing_s/reward:0.165 - timing_s/old_log_prob:7.162 - timing_s/ref:6.877 - timing_s/adv:0.019 - timing_s/update_actor:21.331 - timing_s/dump_rollout_generations:0.263 - timing_s/save_checkpoint:31.811 - timing_s/step:89.048 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.131 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:635115.000 - perf/time_per_step:89.048 - perf/throughput:891.534
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/241.jsonl
step:241 - global_seqlen/min:77839.000 - global_seqlen/max:82725.000 - global_seqlen/minmax_diff:4886.000 - global_seqlen/balanced_min:79805.000 - global_seqlen/balanced_max:79806.000 - global_seqlen/mean:79805.375 - actor/entropy_loss:1.263 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.028 - actor/kl_coef:0.010 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.261 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:142.458 - actor/lr:0.000 - training/global_step:241.000 - training/epoch:3.000 - critic/score/mean:0.637 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.637 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:161.839 - response_length/max:482.000 - response_length/min:45.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.641 - prompt_length/max:507.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.041 - timing_s/reshard:7.887 - timing_s/gen:23.494 - timing_s/reward:0.154 - timing_s/old_log_prob:7.456 - timing_s/ref:7.216 - timing_s/adv:0.020 - timing_s/update_actor:21.657 - timing_s/dump_rollout_generations:0.264 - timing_s/step:60.292 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.142 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:638443.000 - perf/time_per_step:60.292 - perf/throughput:1323.651
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/242.jsonl
step:242 - global_seqlen/min:76966.000 - global_seqlen/max:80965.000 - global_seqlen/minmax_diff:3999.000 - global_seqlen/balanced_min:79092.000 - global_seqlen/balanced_max:79093.000 - global_seqlen/mean:79092.875 - actor/entropy_loss:1.328 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.018 - actor/kl_coef:0.010 - actor/pg_loss:0.017 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.334 - perf/mfu/actor:0.183 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.289 - actor/lr:0.000 - training/global_step:242.000 - training/epoch:3.000 - critic/score/mean:0.621 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.621 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:1.208 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:1.208 - critic/returns/min:-2.475 - response_length/mean:157.679 - response_length/max:437.000 - response_length/min:37.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.234 - prompt_length/max:540.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.345 - timing_s/reshard:7.435 - timing_s/gen:21.338 - timing_s/reward:0.153 - timing_s/old_log_prob:7.180 - timing_s/ref:7.062 - timing_s/adv:0.020 - timing_s/update_actor:20.737 - timing_s/dump_rollout_generations:0.262 - timing_s/step:56.782 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.132 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:632743.000 - perf/time_per_step:56.782 - perf/throughput:1392.922
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/243.jsonl
step:243 - global_seqlen/min:76843.000 - global_seqlen/max:82669.000 - global_seqlen/minmax_diff:5826.000 - global_seqlen/balanced_min:80032.000 - global_seqlen/balanced_max:80033.000 - global_seqlen/mean:80032.875 - actor/entropy_loss:1.340 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.027 - actor/kl_coef:0.010 - actor/pg_loss:-0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.426 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.712 - actor/lr:0.000 - training/global_step:243.000 - training/epoch:3.000 - critic/score/mean:0.703 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.703 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.000 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:163.132 - response_length/max:456.000 - response_length/min:45.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.125 - prompt_length/max:509.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.623 - timing_s/reshard:8.511 - timing_s/gen:22.697 - timing_s/reward:0.154 - timing_s/old_log_prob:7.195 - timing_s/ref:7.070 - timing_s/adv:0.019 - timing_s/update_actor:22.097 - timing_s/dump_rollout_generations:0.262 - timing_s/step:59.523 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.136 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:640263.000 - perf/time_per_step:59.523 - perf/throughput:1344.574
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/244.jsonl
step:244 - global_seqlen/min:77528.000 - global_seqlen/max:81518.000 - global_seqlen/minmax_diff:3990.000 - global_seqlen/balanced_min:79407.000 - global_seqlen/balanced_max:79408.000 - global_seqlen/mean:79407.375 - actor/entropy_loss:1.348 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.044 - actor/kl_coef:0.010 - actor/pg_loss:-0.020 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.374 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.851 - actor/lr:0.000 - training/global_step:244.000 - training/epoch:3.000 - critic/score/mean:0.660 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.660 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:159.667 - response_length/max:395.000 - response_length/min:18.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.703 - prompt_length/max:512.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.123 - timing_s/reshard:8.405 - timing_s/gen:22.094 - timing_s/reward:0.155 - timing_s/old_log_prob:7.235 - timing_s/ref:7.105 - timing_s/adv:0.020 - timing_s/update_actor:21.855 - timing_s/dump_rollout_generations:0.285 - timing_s/step:58.784 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.135 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:635259.000 - perf/time_per_step:58.784 - perf/throughput:1350.822
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/245.jsonl
step:245 - global_seqlen/min:76414.000 - global_seqlen/max:81402.000 - global_seqlen/minmax_diff:4988.000 - global_seqlen/balanced_min:79839.000 - global_seqlen/balanced_max:79840.000 - global_seqlen/mean:79839.625 - actor/entropy_loss:1.361 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.031 - actor/kl_coef:0.010 - actor/pg_loss:0.021 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.260 - perf/mfu/actor:0.179 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.100 - actor/lr:0.000 - training/global_step:245.000 - training/epoch:3.000 - critic/score/mean:0.616 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.616 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:163.685 - response_length/max:418.000 - response_length/min:43.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.062 - prompt_length/max:519.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.609 - timing_s/reshard:8.382 - timing_s/gen:22.552 - timing_s/reward:0.153 - timing_s/old_log_prob:7.313 - timing_s/ref:7.098 - timing_s/adv:0.020 - timing_s/update_actor:21.436 - timing_s/dump_rollout_generations:0.262 - timing_s/step:58.863 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.135 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:638717.000 - perf/time_per_step:58.863 - perf/throughput:1356.365
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/246.jsonl
step:246 - global_seqlen/min:76938.000 - global_seqlen/max:81855.000 - global_seqlen/minmax_diff:4917.000 - global_seqlen/balanced_min:79376.000 - global_seqlen/balanced_max:79377.000 - global_seqlen/mean:79376.375 - actor/entropy_loss:1.372 - training/rollout_probs_diff_max:0.990 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.025 - actor/kl_coef:0.010 - actor/pg_loss:0.008 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.183 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.013 - actor/lr:0.000 - training/global_step:246.000 - training/epoch:3.000 - critic/score/mean:0.601 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.601 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:159.159 - response_length/max:435.000 - response_length/min:36.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.969 - prompt_length/max:501.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.420 - timing_s/reshard:8.966 - timing_s/gen:22.927 - timing_s/reward:0.154 - timing_s/old_log_prob:7.081 - timing_s/ref:7.028 - timing_s/adv:0.021 - timing_s/update_actor:21.634 - timing_s/dump_rollout_generations:0.265 - timing_s/step:59.143 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.141 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:635011.000 - perf/time_per_step:59.143 - perf/throughput:1342.117
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/247.jsonl
step:247 - global_seqlen/min:76663.000 - global_seqlen/max:80903.000 - global_seqlen/minmax_diff:4240.000 - global_seqlen/balanced_min:78863.000 - global_seqlen/balanced_max:78864.000 - global_seqlen/mean:78863.125 - actor/entropy_loss:1.367 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.022 - actor/kl_coef:0.010 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.123 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.033 - actor/lr:0.000 - training/global_step:247.000 - training/epoch:3.000 - critic/score/mean:0.636 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.636 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:1.208 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:1.208 - critic/returns/min:-2.475 - response_length/mean:156.829 - response_length/max:454.000 - response_length/min:23.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.289 - prompt_length/max:490.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.830 - timing_s/reshard:6.451 - timing_s/gen:20.865 - timing_s/reward:0.154 - timing_s/old_log_prob:7.211 - timing_s/ref:6.958 - timing_s/adv:0.019 - timing_s/update_actor:21.234 - timing_s/dump_rollout_generations:0.261 - timing_s/step:56.735 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.130 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:630905.000 - perf/time_per_step:56.735 - perf/throughput:1390.031
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/248.jsonl
step:248 - global_seqlen/min:77033.000 - global_seqlen/max:80683.000 - global_seqlen/minmax_diff:3650.000 - global_seqlen/balanced_min:78329.000 - global_seqlen/balanced_max:78330.000 - global_seqlen/mean:78329.500 - actor/entropy_loss:1.341 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.023 - actor/kl_coef:0.010 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.439 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:133.846 - actor/lr:0.000 - training/global_step:248.000 - training/epoch:3.000 - critic/score/mean:0.701 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.701 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:153.191 - response_length/max:418.000 - response_length/min:19.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.758 - prompt_length/max:503.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.676 - timing_s/reshard:4.252 - timing_s/gen:18.506 - timing_s/reward:0.155 - timing_s/old_log_prob:7.092 - timing_s/ref:6.959 - timing_s/adv:0.020 - timing_s/update_actor:21.986 - timing_s/dump_rollout_generations:0.263 - timing_s/step:55.013 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.118 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:626636.000 - perf/time_per_step:55.013 - perf/throughput:1423.840
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/249.jsonl
step:249 - global_seqlen/min:76812.000 - global_seqlen/max:81636.000 - global_seqlen/minmax_diff:4824.000 - global_seqlen/balanced_min:79228.000 - global_seqlen/balanced_max:80710.000 - global_seqlen/mean:79413.875 - actor/entropy_loss:1.292 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.021 - actor/kl_coef:0.010 - actor/pg_loss:0.106 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.400 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:133.739 - actor/lr:0.000 - training/global_step:249.000 - training/epoch:3.000 - critic/score/mean:0.628 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.628 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.034 - critic/advantages/max:0.933 - critic/advantages/min:-2.475 - critic/returns/mean:-0.034 - critic/returns/max:0.933 - critic/returns/min:-2.475 - response_length/mean:159.640 - response_length/max:2048.000 - response_length/min:39.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.781 - prompt_length/max:504.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.206 - timing_s/reshard:4.082 - timing_s/gen:26.839 - timing_s/reward:0.155 - timing_s/old_log_prob:7.434 - timing_s/ref:7.326 - timing_s/adv:0.022 - timing_s/update_actor:22.507 - timing_s/dump_rollout_generations:0.265 - timing_s/step:64.581 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.164 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:635311.000 - perf/time_per_step:64.581 - perf/throughput:1229.673
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/250.jsonl
step:250 - global_seqlen/min:77437.000 - global_seqlen/max:82149.000 - global_seqlen/minmax_diff:4712.000 - global_seqlen/balanced_min:79449.000 - global_seqlen/balanced_max:79450.000 - global_seqlen/mean:79449.625 - actor/entropy_loss:1.335 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.021 - actor/kl_coef:0.010 - actor/pg_loss:0.015 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.291 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:133.767 - actor/lr:0.000 - training/global_step:250.000 - training/epoch:3.000 - critic/score/mean:0.616 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.616 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:161.606 - response_length/max:472.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.094 - prompt_length/max:526.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.341 - timing_s/reshard:4.145 - timing_s/gen:19.035 - timing_s/reward:0.154 - timing_s/old_log_prob:7.314 - timing_s/ref:7.214 - timing_s/adv:0.021 - timing_s/update_actor:21.813 - timing_s/dump_rollout_generations:0.265 - timing_s/step:55.848 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.115 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:635597.000 - perf/time_per_step:55.848 - perf/throughput:1422.596
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/251.jsonl
step:251 - global_seqlen/min:78362.000 - global_seqlen/max:81675.000 - global_seqlen/minmax_diff:3313.000 - global_seqlen/balanced_min:79564.000 - global_seqlen/balanced_max:79564.000 - global_seqlen/mean:79564.000 - actor/entropy_loss:1.307 - training/rollout_probs_diff_max:0.962 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.029 - actor/kl_coef:0.010 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.084 - perf/mfu/actor:0.182 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.108 - actor/lr:0.000 - training/global_step:251.000 - training/epoch:3.000 - critic/score/mean:0.703 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.703 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.002 - critic/advantages/max:0.540 - critic/advantages/min:-1.620 - critic/returns/mean:-0.002 - critic/returns/max:0.540 - critic/returns/min:-1.620 - response_length/mean:160.359 - response_length/max:461.000 - response_length/min:33.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.234 - prompt_length/max:540.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.210 - timing_s/reshard:4.150 - timing_s/gen:18.919 - timing_s/reward:0.157 - timing_s/old_log_prob:7.260 - timing_s/ref:7.124 - timing_s/adv:0.020 - timing_s/update_actor:21.029 - timing_s/dump_rollout_generations:0.263 - timing_s/step:54.807 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.115 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:636512.000 - perf/time_per_step:54.807 - perf/throughput:1451.708
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/252.jsonl
step:252 - global_seqlen/min:76757.000 - global_seqlen/max:82322.000 - global_seqlen/minmax_diff:5565.000 - global_seqlen/balanced_min:79158.000 - global_seqlen/balanced_max:79159.000 - global_seqlen/mean:79158.375 - actor/entropy_loss:1.301 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.044 - actor/kl_coef:0.010 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.323 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.376 - actor/lr:0.000 - training/global_step:252.000 - training/epoch:3.000 - critic/score/mean:0.668 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.668 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.003 - critic/advantages/max:1.208 - critic/advantages/min:-2.475 - critic/returns/mean:0.003 - critic/returns/max:1.208 - critic/returns/min:-2.475 - response_length/mean:159.339 - response_length/max:407.000 - response_length/min:35.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.086 - prompt_length/max:499.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.464 - timing_s/reshard:4.092 - timing_s/gen:18.794 - timing_s/reward:0.152 - timing_s/old_log_prob:7.004 - timing_s/ref:6.937 - timing_s/adv:0.021 - timing_s/update_actor:21.887 - timing_s/dump_rollout_generations:0.260 - timing_s/step:55.088 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.115 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:633267.000 - perf/time_per_step:55.088 - perf/throughput:1436.931
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/253.jsonl
step:253 - global_seqlen/min:79429.000 - global_seqlen/max:82784.000 - global_seqlen/minmax_diff:3355.000 - global_seqlen/balanced_min:80674.000 - global_seqlen/balanced_max:80675.000 - global_seqlen/mean:80674.750 - actor/entropy_loss:1.299 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.032 - actor/kl_coef:0.010 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.407 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.783 - actor/lr:0.000 - training/global_step:253.000 - training/epoch:3.000 - critic/score/mean:0.647 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.647 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:166.014 - response_length/max:450.000 - response_length/min:48.000 - response_length/clip_ratio:0.000 - prompt_length/mean:464.258 - prompt_length/max:522.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.014 - timing_s/reshard:4.158 - timing_s/gen:19.453 - timing_s/reward:0.157 - timing_s/old_log_prob:7.273 - timing_s/ref:7.251 - timing_s/adv:0.019 - timing_s/update_actor:22.312 - timing_s/dump_rollout_generations:0.265 - timing_s/step:56.759 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.114 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:645398.000 - perf/time_per_step:56.759 - perf/throughput:1421.352
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/254.jsonl
step:254 - global_seqlen/min:76183.000 - global_seqlen/max:81186.000 - global_seqlen/minmax_diff:5003.000 - global_seqlen/balanced_min:78907.000 - global_seqlen/balanced_max:79655.000 - global_seqlen/mean:79000.875 - actor/entropy_loss:1.306 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.035 - actor/kl_coef:0.010 - actor/pg_loss:0.014 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.591 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:135.007 - actor/lr:0.000 - training/global_step:254.000 - training/epoch:3.000 - critic/score/mean:0.655 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.655 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.935 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:0.935 - critic/returns/min:-2.475 - response_length/mean:156.444 - response_length/max:1367.000 - response_length/min:28.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.750 - prompt_length/max:494.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:17.885 - timing_s/reshard:4.164 - timing_s/gen:23.300 - timing_s/reward:0.151 - timing_s/old_log_prob:7.253 - timing_s/ref:7.131 - timing_s/adv:0.020 - timing_s/update_actor:21.684 - timing_s/dump_rollout_generations:0.276 - timing_s/step:59.847 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.145 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:632007.000 - perf/time_per_step:59.847 - perf/throughput:1320.056
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/255.jsonl
step:255 - global_seqlen/min:77125.000 - global_seqlen/max:82290.000 - global_seqlen/minmax_diff:5165.000 - global_seqlen/balanced_min:79133.000 - global_seqlen/balanced_max:80567.000 - global_seqlen/mean:79313.000 - actor/entropy_loss:1.304 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.025 - actor/kl_coef:0.010 - actor/pg_loss:0.105 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.300 - perf/mfu/actor:0.185 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:135.236 - actor/lr:0.000 - training/global_step:255.000 - training/epoch:3.000 - critic/score/mean:0.733 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.733 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.029 - critic/advantages/max:1.208 - critic/advantages/min:-2.475 - critic/returns/mean:-0.029 - critic/returns/max:1.208 - critic/returns/min:-2.475 - response_length/mean:161.641 - response_length/max:2048.000 - response_length/min:33.000 - response_length/clip_ratio:0.001 - prompt_length/mean:457.992 - prompt_length/max:508.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.992 - timing_s/reshard:4.135 - timing_s/gen:27.415 - timing_s/reward:0.153 - timing_s/old_log_prob:7.290 - timing_s/ref:7.174 - timing_s/adv:0.022 - timing_s/update_actor:20.566 - timing_s/dump_rollout_generations:0.260 - timing_s/step:62.911 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.032 - timing_per_token_ms/gen:0.166 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:634504.000 - perf/time_per_step:62.911 - perf/throughput:1260.722
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/256.jsonl
step:256 - global_seqlen/min:78804.000 - global_seqlen/max:81536.000 - global_seqlen/minmax_diff:2732.000 - global_seqlen/balanced_min:80282.000 - global_seqlen/balanced_max:80322.000 - global_seqlen/mean:80287.250 - actor/entropy_loss:1.328 - training/rollout_probs_diff_max:0.993 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.024 - actor/kl_coef:0.010 - actor/pg_loss:0.013 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.598 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:135.721 - actor/lr:0.000 - training/global_step:256.000 - training/epoch:3.000 - critic/score/mean:0.584 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.584 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:165.096 - response_length/max:629.000 - response_length/min:38.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.148 - prompt_length/max:511.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.125 - timing_s/reshard:4.123 - timing_s/gen:21.723 - timing_s/reward:0.157 - timing_s/old_log_prob:7.165 - timing_s/ref:7.078 - timing_s/adv:0.021 - timing_s/update_actor:21.739 - timing_s/dump_rollout_generations:0.292 - timing_s/step:58.202 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.128 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:642298.000 - perf/time_per_step:58.202 - perf/throughput:1379.454
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/257.jsonl
step:257 - global_seqlen/min:79803.000 - global_seqlen/max:83884.000 - global_seqlen/minmax_diff:4081.000 - global_seqlen/balanced_min:80854.000 - global_seqlen/balanced_max:80855.000 - global_seqlen/mean:80854.750 - actor/entropy_loss:1.320 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.025 - actor/kl_coef:0.010 - actor/pg_loss:0.012 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.185 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:136.004 - actor/lr:0.000 - training/global_step:257.000 - training/epoch:3.000 - critic/score/mean:0.640 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.640 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.007 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.007 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:173.107 - response_length/max:491.000 - response_length/min:44.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.570 - prompt_length/max:496.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.956 - timing_s/reshard:4.192 - timing_s/gen:19.090 - timing_s/reward:0.158 - timing_s/old_log_prob:7.293 - timing_s/ref:7.051 - timing_s/adv:0.020 - timing_s/update_actor:22.305 - timing_s/dump_rollout_generations:0.263 - timing_s/step:56.213 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:646838.000 - perf/time_per_step:56.213 - perf/throughput:1438.373
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/258.jsonl
step:258 - global_seqlen/min:80581.000 - global_seqlen/max:83438.000 - global_seqlen/minmax_diff:2857.000 - global_seqlen/balanced_min:81629.000 - global_seqlen/balanced_max:83128.000 - global_seqlen/mean:81816.500 - actor/entropy_loss:1.354 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.046 - actor/kl_coef:0.010 - actor/pg_loss:0.131 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.453 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:135.357 - actor/lr:0.000 - training/global_step:258.000 - training/epoch:3.000 - critic/score/mean:0.646 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.646 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.030 - critic/advantages/max:2.460 - critic/advantages/min:-2.475 - critic/returns/mean:-0.030 - critic/returns/max:2.460 - critic/returns/min:-2.475 - response_length/mean:175.020 - response_length/max:2048.000 - response_length/min:35.000 - response_length/clip_ratio:0.001 - prompt_length/mean:464.172 - prompt_length/max:519.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.850 - timing_s/reshard:5.338 - timing_s/gen:28.441 - timing_s/reward:0.158 - timing_s/old_log_prob:7.345 - timing_s/ref:7.082 - timing_s/adv:0.021 - timing_s/update_actor:22.616 - timing_s/dump_rollout_generations:0.264 - timing_s/step:65.962 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.159 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:654532.000 - perf/time_per_step:65.962 - perf/throughput:1240.360
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/259.jsonl
step:259 - global_seqlen/min:77242.000 - global_seqlen/max:83588.000 - global_seqlen/minmax_diff:6346.000 - global_seqlen/balanced_min:80908.000 - global_seqlen/balanced_max:80909.000 - global_seqlen/mean:80908.250 - actor/entropy_loss:1.375 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.039 - actor/kl_coef:0.010 - actor/pg_loss:0.027 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.289 - perf/mfu/actor:0.180 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:135.410 - actor/lr:0.000 - training/global_step:259.000 - training/epoch:3.000 - critic/score/mean:0.632 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.632 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:171.682 - response_length/max:456.000 - response_length/min:26.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.414 - prompt_length/max:514.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.622 - timing_s/reshard:4.254 - timing_s/gen:19.139 - timing_s/reward:0.161 - timing_s/old_log_prob:7.321 - timing_s/ref:7.075 - timing_s/adv:0.020 - timing_s/update_actor:21.626 - timing_s/dump_rollout_generations:0.267 - timing_s/step:55.648 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.109 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:647266.000 - perf/time_per_step:55.648 - perf/throughput:1453.939
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/260.jsonl
step:260 - global_seqlen/min:77359.000 - global_seqlen/max:83232.000 - global_seqlen/minmax_diff:5873.000 - global_seqlen/balanced_min:80350.000 - global_seqlen/balanced_max:80351.000 - global_seqlen/mean:80350.125 - actor/entropy_loss:1.297 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.033 - actor/kl_coef:0.010 - actor/pg_loss:0.025 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.560 - perf/mfu/actor:0.179 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:135.358 - actor/lr:0.000 - training/global_step:260.000 - training/epoch:3.000 - critic/score/mean:0.625 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.625 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.009 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.009 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:169.556 - response_length/max:431.000 - response_length/min:30.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.180 - prompt_length/max:505.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.694 - timing_s/reshard:4.084 - timing_s/gen:18.330 - timing_s/reward:0.157 - timing_s/old_log_prob:7.285 - timing_s/ref:7.120 - timing_s/adv:0.019 - timing_s/update_actor:21.627 - timing_s/dump_rollout_generations:0.262 - timing_s/step:54.835 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.106 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:642801.000 - perf/time_per_step:54.835 - perf/throughput:1465.317
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/261.jsonl
step:261 - global_seqlen/min:79199.000 - global_seqlen/max:84874.000 - global_seqlen/minmax_diff:5675.000 - global_seqlen/balanced_min:81210.000 - global_seqlen/balanced_max:82605.000 - global_seqlen/mean:81560.375 - actor/entropy_loss:1.302 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.019 - actor/kl_coef:0.010 - actor/pg_loss:0.100 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.494 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.775 - actor/lr:0.000 - training/global_step:261.000 - training/epoch:3.000 - critic/score/mean:0.590 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.590 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.026 - critic/advantages/max:1.208 - critic/advantages/min:-2.475 - critic/returns/mean:-0.026 - critic/returns/max:1.208 - critic/returns/min:-2.475 - response_length/mean:176.581 - response_length/max:2048.000 - response_length/min:16.000 - response_length/clip_ratio:0.002 - prompt_length/mean:460.609 - prompt_length/max:517.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.979 - timing_s/reshard:6.279 - timing_s/gen:30.572 - timing_s/reward:0.158 - timing_s/old_log_prob:7.286 - timing_s/ref:7.281 - timing_s/adv:0.027 - timing_s/update_actor:22.919 - timing_s/dump_rollout_generations:0.288 - timing_s/step:68.561 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.169 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:652483.000 - perf/time_per_step:68.561 - perf/throughput:1189.598
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/262.jsonl
step:262 - global_seqlen/min:79266.000 - global_seqlen/max:85012.000 - global_seqlen/minmax_diff:5746.000 - global_seqlen/balanced_min:81240.000 - global_seqlen/balanced_max:82688.000 - global_seqlen/mean:81602.125 - actor/entropy_loss:1.264 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.075 - actor/kl_loss:0.026 - actor/kl_coef:0.010 - actor/pg_loss:-0.116 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.319 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.698 - actor/lr:0.000 - training/global_step:262.000 - training/epoch:3.000 - critic/score/mean:0.629 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.629 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.000 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:176.243 - response_length/max:2048.000 - response_length/min:32.000 - response_length/clip_ratio:0.002 - prompt_length/mean:461.273 - prompt_length/max:511.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.163 - timing_s/reshard:4.183 - timing_s/gen:26.866 - timing_s/reward:0.157 - timing_s/old_log_prob:7.383 - timing_s/ref:7.276 - timing_s/adv:0.022 - timing_s/update_actor:22.802 - timing_s/dump_rollout_generations:0.265 - timing_s/step:64.799 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.149 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:652817.000 - perf/time_per_step:64.799 - perf/throughput:1259.310
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/263.jsonl
step:263 - global_seqlen/min:78309.000 - global_seqlen/max:81727.000 - global_seqlen/minmax_diff:3418.000 - global_seqlen/balanced_min:80344.000 - global_seqlen/balanced_max:81807.000 - global_seqlen/mean:80526.875 - actor/entropy_loss:1.273 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.027 - actor/kl_coef:0.010 - actor/pg_loss:0.098 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.513 - perf/mfu/actor:0.179 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.637 - actor/lr:0.000 - training/global_step:263.000 - training/epoch:3.000 - critic/score/mean:0.666 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.666 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.031 - critic/advantages/max:1.208 - critic/advantages/min:-2.475 - critic/returns/mean:-0.031 - critic/returns/max:1.208 - critic/returns/min:-2.475 - response_length/mean:170.608 - response_length/max:2048.000 - response_length/min:44.000 - response_length/clip_ratio:0.001 - prompt_length/mean:458.508 - prompt_length/max:488.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.208 - timing_s/reshard:4.138 - timing_s/gen:26.889 - timing_s/reward:0.157 - timing_s/old_log_prob:7.202 - timing_s/ref:7.056 - timing_s/adv:0.021 - timing_s/update_actor:21.619 - timing_s/dump_rollout_generations:0.267 - timing_s/step:63.243 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.154 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:644215.000 - perf/time_per_step:63.243 - perf/throughput:1273.294
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/264.jsonl
step:264 - global_seqlen/min:80455.000 - global_seqlen/max:88024.000 - global_seqlen/minmax_diff:7569.000 - global_seqlen/balanced_min:82783.000 - global_seqlen/balanced_max:84227.000 - global_seqlen/mean:83097.750 - actor/entropy_loss:1.311 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.040 - actor/kl_coef:0.010 - actor/pg_loss:0.112 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.697 - perf/mfu/actor:0.191 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.669 - actor/lr:0.000 - training/global_step:264.000 - training/epoch:3.000 - critic/score/mean:0.536 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.536 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.023 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.023 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:185.389 - response_length/max:2048.000 - response_length/min:22.000 - response_length/clip_ratio:0.001 - prompt_length/mean:463.812 - prompt_length/max:513.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:23.915 - timing_s/reshard:4.762 - timing_s/gen:29.226 - timing_s/reward:0.161 - timing_s/old_log_prob:7.268 - timing_s/ref:7.128 - timing_s/adv:0.021 - timing_s/update_actor:20.935 - timing_s/dump_rollout_generations:0.269 - timing_s/step:65.042 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.031 - timing_per_token_ms/gen:0.154 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:664782.000 - perf/time_per_step:65.042 - perf/throughput:1277.603
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/265.jsonl
step:265 - global_seqlen/min:76888.000 - global_seqlen/max:83014.000 - global_seqlen/minmax_diff:6126.000 - global_seqlen/balanced_min:80335.000 - global_seqlen/balanced_max:80336.000 - global_seqlen/mean:80335.500 - actor/entropy_loss:1.302 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.032 - actor/kl_coef:0.010 - actor/pg_loss:-0.032 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.160 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.745 - actor/lr:0.000 - training/global_step:265.000 - training/epoch:3.000 - critic/score/mean:0.652 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.652 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.004 - critic/advantages/max:0.725 - critic/advantages/min:-2.475 - critic/returns/mean:0.004 - critic/returns/max:0.725 - critic/returns/min:-2.475 - response_length/mean:168.004 - response_length/max:538.000 - response_length/min:46.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.617 - prompt_length/max:509.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.235 - timing_s/reshard:6.360 - timing_s/gen:21.143 - timing_s/reward:0.154 - timing_s/old_log_prob:7.279 - timing_s/ref:7.124 - timing_s/adv:0.019 - timing_s/update_actor:21.728 - timing_s/dump_rollout_generations:0.263 - timing_s/step:57.743 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.123 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:642684.000 - perf/time_per_step:57.743 - perf/throughput:1391.267
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/266.jsonl
step:266 - global_seqlen/min:79152.000 - global_seqlen/max:81263.000 - global_seqlen/minmax_diff:2111.000 - global_seqlen/balanced_min:80625.000 - global_seqlen/balanced_max:80626.000 - global_seqlen/mean:80625.375 - actor/entropy_loss:1.309 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.035 - actor/kl_coef:0.010 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.278 - perf/mfu/actor:0.195 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.562 - actor/lr:0.000 - training/global_step:266.000 - training/epoch:3.000 - critic/score/mean:0.679 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.679 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:1.208 - critic/advantages/min:-0.725 - critic/returns/mean:-0.003 - critic/returns/max:1.208 - critic/returns/min:-0.725 - response_length/mean:170.612 - response_length/max:432.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.273 - prompt_length/max:506.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.055 - timing_s/reshard:4.414 - timing_s/gen:19.022 - timing_s/reward:0.158 - timing_s/old_log_prob:7.109 - timing_s/ref:7.063 - timing_s/adv:0.020 - timing_s/update_actor:19.861 - timing_s/dump_rollout_generations:0.265 - timing_s/step:53.528 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.031 - timing_per_token_ms/gen:0.109 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:645003.000 - perf/time_per_step:53.528 - perf/throughput:1506.217
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/267.jsonl
step:267 - global_seqlen/min:79176.000 - global_seqlen/max:84000.000 - global_seqlen/minmax_diff:4824.000 - global_seqlen/balanced_min:81066.000 - global_seqlen/balanced_max:81067.000 - global_seqlen/mean:81066.375 - actor/entropy_loss:1.262 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.022 - actor/kl_coef:0.010 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.045 - perf/mfu/actor:0.183 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:135.704 - actor/lr:0.000 - training/global_step:267.000 - training/epoch:3.000 - critic/score/mean:0.634 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.634 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.000 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:172.651 - response_length/max:444.000 - response_length/min:32.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.680 - prompt_length/max:494.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.750 - timing_s/reshard:4.195 - timing_s/gen:19.180 - timing_s/reward:0.156 - timing_s/old_log_prob:7.251 - timing_s/ref:7.119 - timing_s/adv:0.020 - timing_s/update_actor:21.242 - timing_s/dump_rollout_generations:0.267 - timing_s/step:55.268 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:648531.000 - perf/time_per_step:55.268 - perf/throughput:1466.789
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/268.jsonl
step:268 - global_seqlen/min:80461.000 - global_seqlen/max:83570.000 - global_seqlen/minmax_diff:3109.000 - global_seqlen/balanced_min:81904.000 - global_seqlen/balanced_max:81905.000 - global_seqlen/mean:81904.125 - actor/entropy_loss:1.297 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.023 - actor/kl_coef:0.010 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.336 - perf/mfu/actor:0.179 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:135.857 - actor/lr:0.000 - training/global_step:268.000 - training/epoch:3.000 - critic/score/mean:0.601 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.601 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:175.642 - response_length/max:471.000 - response_length/min:23.000 - response_length/clip_ratio:0.000 - prompt_length/mean:464.234 - prompt_length/max:520.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.230 - timing_s/reshard:4.132 - timing_s/gen:19.667 - timing_s/reward:0.158 - timing_s/old_log_prob:7.215 - timing_s/ref:7.104 - timing_s/adv:0.021 - timing_s/update_actor:22.029 - timing_s/dump_rollout_generations:0.267 - timing_s/step:56.491 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.109 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:655233.000 - perf/time_per_step:56.491 - perf/throughput:1449.871
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/269.jsonl
step:269 - global_seqlen/min:78338.000 - global_seqlen/max:84127.000 - global_seqlen/minmax_diff:5789.000 - global_seqlen/balanced_min:80743.000 - global_seqlen/balanced_max:80743.000 - global_seqlen/mean:80743.000 - actor/entropy_loss:1.310 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.036 - actor/kl_coef:0.010 - actor/pg_loss:0.010 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.879 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:135.910 - actor/lr:0.000 - training/global_step:269.000 - training/epoch:3.000 - critic/score/mean:0.670 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.670 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.002 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:0.002 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:173.305 - response_length/max:524.000 - response_length/min:36.000 - response_length/clip_ratio:0.000 - prompt_length/mean:457.500 - prompt_length/max:485.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.347 - timing_s/reshard:4.202 - timing_s/gen:19.942 - timing_s/reward:0.157 - timing_s/old_log_prob:7.257 - timing_s/ref:7.058 - timing_s/adv:0.019 - timing_s/update_actor:22.273 - timing_s/dump_rollout_generations:0.265 - timing_s/step:57.002 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:645944.000 - perf/time_per_step:57.002 - perf/throughput:1416.495
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/270.jsonl
step:270 - global_seqlen/min:79624.000 - global_seqlen/max:84902.000 - global_seqlen/minmax_diff:5278.000 - global_seqlen/balanced_min:80839.000 - global_seqlen/balanced_max:80840.000 - global_seqlen/mean:80839.875 - actor/entropy_loss:1.359 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.029 - actor/kl_coef:0.010 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.840 - perf/mfu/actor:0.184 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:136.026 - actor/lr:0.000 - training/global_step:270.000 - training/epoch:3.000 - critic/score/mean:0.626 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.626 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.002 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:170.038 - response_length/max:500.000 - response_length/min:34.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.523 - prompt_length/max:508.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.339 - timing_s/reshard:4.409 - timing_s/gen:19.280 - timing_s/reward:0.156 - timing_s/old_log_prob:7.272 - timing_s/ref:7.073 - timing_s/adv:0.019 - timing_s/update_actor:21.088 - timing_s/dump_rollout_generations:0.305 - timing_s/step:55.227 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.111 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:646719.000 - perf/time_per_step:55.227 - perf/throughput:1463.780
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/271.jsonl
step:271 - global_seqlen/min:79670.000 - global_seqlen/max:83029.000 - global_seqlen/minmax_diff:3359.000 - global_seqlen/balanced_min:81306.000 - global_seqlen/balanced_max:81306.000 - global_seqlen/mean:81306.000 - actor/entropy_loss:1.374 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.033 - actor/kl_coef:0.010 - actor/pg_loss:0.012 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.713 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:135.720 - actor/lr:0.000 - training/global_step:271.000 - training/epoch:3.000 - critic/score/mean:0.636 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.636 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:1.208 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:1.208 - critic/returns/min:-2.475 - response_length/mean:174.266 - response_length/max:513.000 - response_length/min:46.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.938 - prompt_length/max:530.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.351 - timing_s/reshard:7.134 - timing_s/gen:22.055 - timing_s/reward:0.157 - timing_s/old_log_prob:7.345 - timing_s/ref:7.220 - timing_s/adv:0.020 - timing_s/update_actor:22.299 - timing_s/dump_rollout_generations:0.266 - timing_s/step:59.393 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:650448.000 - perf/time_per_step:59.393 - perf/throughput:1368.952
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/272.jsonl
step:272 - global_seqlen/min:78384.000 - global_seqlen/max:84994.000 - global_seqlen/minmax_diff:6610.000 - global_seqlen/balanced_min:81049.000 - global_seqlen/balanced_max:81050.000 - global_seqlen/mean:81049.625 - actor/entropy_loss:1.359 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.022 - actor/kl_coef:0.010 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.389 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:135.372 - actor/lr:0.000 - training/global_step:272.000 - training/epoch:3.000 - critic/score/mean:0.663 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.663 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-0.354 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-0.354 - response_length/mean:172.911 - response_length/max:440.000 - response_length/min:35.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.289 - prompt_length/max:508.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.826 - timing_s/reshard:7.377 - timing_s/gen:21.777 - timing_s/reward:0.183 - timing_s/old_log_prob:7.192 - timing_s/ref:6.998 - timing_s/adv:0.020 - timing_s/update_actor:22.032 - timing_s/dump_rollout_generations:0.263 - timing_s/step:58.497 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.123 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:648397.000 - perf/time_per_step:58.497 - perf/throughput:1385.532
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/273.jsonl
step:273 - global_seqlen/min:78126.000 - global_seqlen/max:83728.000 - global_seqlen/minmax_diff:5602.000 - global_seqlen/balanced_min:80934.000 - global_seqlen/balanced_max:80935.000 - global_seqlen/mean:80934.500 - actor/entropy_loss:1.392 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.018 - actor/kl_coef:0.010 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.022 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:124.988 - actor/lr:0.000 - training/global_step:273.000 - training/epoch:4.000 - critic/score/mean:0.712 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.712 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:0.000 - critic/advantages/min:-0.007 - critic/returns/mean:-0.003 - critic/returns/max:0.000 - critic/returns/min:-0.007 - response_length/mean:171.926 - response_length/max:446.000 - response_length/min:47.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.375 - prompt_length/max:533.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.941 - timing_s/reshard:4.063 - timing_s/gen:18.594 - timing_s/reward:0.157 - timing_s/old_log_prob:7.458 - timing_s/ref:7.277 - timing_s/adv:0.021 - timing_s/update_actor:22.305 - timing_s/dump_rollout_generations:0.275 - timing_s/step:56.150 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.106 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:647476.000 - perf/time_per_step:56.150 - perf/throughput:1441.390
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/274.jsonl
step:274 - global_seqlen/min:78868.000 - global_seqlen/max:81338.000 - global_seqlen/minmax_diff:2470.000 - global_seqlen/balanced_min:79977.000 - global_seqlen/balanced_max:79978.000 - global_seqlen/mean:79977.625 - actor/entropy_loss:1.356 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.019 - actor/kl_coef:0.010 - actor/pg_loss:0.008 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.441 - perf/mfu/actor:0.185 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:125.404 - actor/lr:0.000 - training/global_step:274.000 - training/epoch:4.000 - critic/score/mean:0.695 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.695 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-0.540 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-0.540 - response_length/mean:165.247 - response_length/max:553.000 - response_length/min:42.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.578 - prompt_length/max:517.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.133 - timing_s/reshard:7.086 - timing_s/gen:21.768 - timing_s/reward:0.155 - timing_s/old_log_prob:7.184 - timing_s/ref:7.004 - timing_s/adv:0.020 - timing_s/update_actor:20.883 - timing_s/dump_rollout_generations:0.274 - timing_s/step:57.318 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.129 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:639821.000 - perf/time_per_step:57.318 - perf/throughput:1395.336
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/275.jsonl
step:275 - global_seqlen/min:79377.000 - global_seqlen/max:83705.000 - global_seqlen/minmax_diff:4328.000 - global_seqlen/balanced_min:81600.000 - global_seqlen/balanced_max:81601.000 - global_seqlen/mean:81600.875 - actor/entropy_loss:1.333 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.038 - actor/kl_coef:0.010 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.103 - perf/mfu/actor:0.189 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:126.069 - actor/lr:0.000 - training/global_step:275.000 - training/epoch:4.000 - critic/score/mean:0.585 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.585 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.000 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:173.733 - response_length/max:514.000 - response_length/min:35.000 - response_length/clip_ratio:0.000 - prompt_length/mean:463.773 - prompt_length/max:497.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.173 - timing_s/reshard:8.145 - timing_s/gen:22.881 - timing_s/reward:0.156 - timing_s/old_log_prob:7.137 - timing_s/ref:7.147 - timing_s/adv:0.022 - timing_s/update_actor:20.738 - timing_s/dump_rollout_generations:0.281 - timing_s/step:58.392 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.032 - timing_per_token_ms/gen:0.129 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:652807.000 - perf/time_per_step:58.392 - perf/throughput:1397.474
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/276.jsonl
step:276 - global_seqlen/min:78281.000 - global_seqlen/max:82048.000 - global_seqlen/minmax_diff:3767.000 - global_seqlen/balanced_min:80221.000 - global_seqlen/balanced_max:80222.000 - global_seqlen/mean:80221.875 - actor/entropy_loss:1.357 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.034 - actor/kl_coef:0.010 - actor/pg_loss:-0.008 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.368 - perf/mfu/actor:0.184 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:126.497 - actor/lr:0.000 - training/global_step:276.000 - training/epoch:4.000 - critic/score/mean:0.625 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.625 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-0.935 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-0.935 - response_length/mean:167.733 - response_length/max:431.000 - response_length/min:30.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.000 - prompt_length/max:521.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.341 - timing_s/reshard:8.582 - timing_s/gen:22.471 - timing_s/reward:0.155 - timing_s/old_log_prob:7.264 - timing_s/ref:7.221 - timing_s/adv:0.020 - timing_s/update_actor:20.993 - timing_s/dump_rollout_generations:0.320 - timing_s/step:58.475 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.131 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:641775.000 - perf/time_per_step:58.475 - perf/throughput:1371.893
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/277.jsonl
step:277 - global_seqlen/min:78063.000 - global_seqlen/max:81418.000 - global_seqlen/minmax_diff:3355.000 - global_seqlen/balanced_min:80099.000 - global_seqlen/balanced_max:80100.000 - global_seqlen/mean:80099.375 - actor/entropy_loss:1.381 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.038 - actor/kl_coef:0.010 - actor/pg_loss:0.006 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.498 - perf/mfu/actor:0.185 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:126.644 - actor/lr:0.000 - training/global_step:277.000 - training/epoch:4.000 - critic/score/mean:0.735 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.735 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.725 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:0.725 - critic/returns/min:-2.475 - response_length/mean:166.659 - response_length/max:398.000 - response_length/min:44.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.117 - prompt_length/max:506.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.348 - timing_s/reshard:8.305 - timing_s/gen:22.196 - timing_s/reward:0.155 - timing_s/old_log_prob:7.270 - timing_s/ref:7.179 - timing_s/adv:0.020 - timing_s/update_actor:20.819 - timing_s/dump_rollout_generations:0.277 - timing_s/step:57.945 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.032 - timing_per_token_ms/gen:0.130 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:640795.000 - perf/time_per_step:57.945 - perf/throughput:1382.327
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/278.jsonl
step:278 - global_seqlen/min:77986.000 - global_seqlen/max:82926.000 - global_seqlen/minmax_diff:4940.000 - global_seqlen/balanced_min:81089.000 - global_seqlen/balanced_max:81097.000 - global_seqlen/mean:81090.375 - actor/entropy_loss:1.397 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.022 - actor/kl_coef:0.010 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.100 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:127.100 - actor/lr:0.000 - training/global_step:278.000 - training/epoch:4.000 - critic/score/mean:0.621 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.621 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-0.354 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-0.354 - response_length/mean:170.003 - response_length/max:594.000 - response_length/min:47.000 - response_length/clip_ratio:0.000 - prompt_length/mean:463.516 - prompt_length/max:520.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.790 - timing_s/reshard:5.475 - timing_s/gen:20.856 - timing_s/reward:0.158 - timing_s/old_log_prob:7.238 - timing_s/ref:7.142 - timing_s/adv:0.019 - timing_s/update_actor:22.099 - timing_s/dump_rollout_generations:0.276 - timing_s/step:57.821 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.120 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:648723.000 - perf/time_per_step:57.821 - perf/throughput:1402.450
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/279.jsonl
step:279 - global_seqlen/min:75290.000 - global_seqlen/max:81584.000 - global_seqlen/minmax_diff:6294.000 - global_seqlen/balanced_min:78767.000 - global_seqlen/balanced_max:78767.000 - global_seqlen/mean:78767.000 - actor/entropy_loss:1.374 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.020 - actor/kl_coef:0.010 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.014 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:127.528 - actor/lr:0.000 - training/global_step:279.000 - training/epoch:4.000 - critic/score/mean:0.691 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.691 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:0.000 - critic/advantages/min:-0.007 - critic/returns/mean:-0.003 - critic/returns/max:0.000 - critic/returns/min:-0.007 - response_length/mean:158.352 - response_length/max:576.000 - response_length/min:37.000 - response_length/clip_ratio:0.000 - prompt_length/mean:457.016 - prompt_length/max:497.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.172 - timing_s/reshard:4.185 - timing_s/gen:18.923 - timing_s/reward:0.155 - timing_s/old_log_prob:7.121 - timing_s/ref:6.964 - timing_s/adv:0.019 - timing_s/update_actor:21.643 - timing_s/dump_rollout_generations:0.274 - timing_s/step:55.130 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:630136.000 - perf/time_per_step:55.130 - perf/throughput:1428.738
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/280.jsonl
local_global_step_folder: ../ckpt/checkpoints/global_step_280
step:280 - global_seqlen/min:76903.000 - global_seqlen/max:82325.000 - global_seqlen/minmax_diff:5422.000 - global_seqlen/balanced_min:79748.000 - global_seqlen/balanced_max:79749.000 - global_seqlen/mean:79748.875 - actor/entropy_loss:1.391 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.033 - actor/kl_coef:0.010 - actor/pg_loss:0.030 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.545 - perf/mfu/actor:0.179 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:127.819 - actor/lr:0.000 - training/global_step:280.000 - training/epoch:4.000 - critic/score/mean:0.647 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.647 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.354 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:0.354 - critic/returns/min:-2.475 - response_length/mean:163.335 - response_length/max:548.000 - response_length/min:41.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.703 - prompt_length/max:519.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.154 - timing_s/reshard:4.135 - timing_s/gen:18.857 - timing_s/reward:0.157 - timing_s/old_log_prob:7.189 - timing_s/ref:7.044 - timing_s/adv:0.019 - timing_s/update_actor:21.378 - timing_s/dump_rollout_generations:0.276 - timing_s/save_checkpoint:30.708 - timing_s/step:85.661 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:637991.000 - perf/time_per_step:85.661 - perf/throughput:930.985
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/281.jsonl
step:281 - global_seqlen/min:77405.000 - global_seqlen/max:82082.000 - global_seqlen/minmax_diff:4677.000 - global_seqlen/balanced_min:80263.000 - global_seqlen/balanced_max:81686.000 - global_seqlen/mean:80440.875 - actor/entropy_loss:1.329 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.014 - actor/kl_coef:0.010 - actor/pg_loss:0.008 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.520 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:131.451 - actor/lr:0.000 - training/global_step:281.000 - training/epoch:4.000 - critic/score/mean:0.649 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.649 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:168.038 - response_length/max:2048.000 - response_length/min:28.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.406 - prompt_length/max:514.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.828 - timing_s/reshard:4.225 - timing_s/gen:27.572 - timing_s/reward:0.156 - timing_s/old_log_prob:7.374 - timing_s/ref:7.239 - timing_s/adv:0.022 - timing_s/update_actor:22.789 - timing_s/dump_rollout_generations:0.304 - timing_s/step:65.486 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.160 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:643527.000 - perf/time_per_step:65.486 - perf/throughput:1228.363
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/282.jsonl
step:282 - global_seqlen/min:77196.000 - global_seqlen/max:81719.000 - global_seqlen/minmax_diff:4523.000 - global_seqlen/balanced_min:79482.000 - global_seqlen/balanced_max:79483.000 - global_seqlen/mean:79482.875 - actor/entropy_loss:1.362 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.020 - actor/kl_coef:0.010 - actor/pg_loss:-0.014 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.316 - perf/mfu/actor:0.169 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:128.930 - actor/lr:0.000 - training/global_step:282.000 - training/epoch:4.000 - critic/score/mean:0.623 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.623 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:159.741 - response_length/max:592.000 - response_length/min:34.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.219 - prompt_length/max:535.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.762 - timing_s/reshard:4.124 - timing_s/gen:19.455 - timing_s/reward:0.158 - timing_s/old_log_prob:7.369 - timing_s/ref:7.272 - timing_s/adv:0.020 - timing_s/update_actor:22.534 - timing_s/dump_rollout_generations:0.275 - timing_s/step:57.116 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.119 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:635863.000 - perf/time_per_step:57.116 - perf/throughput:1391.598
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/283.jsonl
step:283 - global_seqlen/min:77737.000 - global_seqlen/max:80673.000 - global_seqlen/minmax_diff:2936.000 - global_seqlen/balanced_min:79515.000 - global_seqlen/balanced_max:79516.000 - global_seqlen/mean:79515.375 - actor/entropy_loss:1.352 - training/rollout_probs_diff_max:0.999 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.027 - actor/kl_coef:0.010 - actor/pg_loss:0.009 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.696 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:129.534 - actor/lr:0.000 - training/global_step:283.000 - training/epoch:4.000 - critic/score/mean:0.672 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.672 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:1.208 - critic/advantages/min:-1.620 - critic/returns/mean:-0.003 - critic/returns/max:1.208 - critic/returns/min:-1.620 - response_length/mean:161.683 - response_length/max:497.000 - response_length/min:41.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.531 - prompt_length/max:505.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.366 - timing_s/reshard:4.166 - timing_s/gen:19.112 - timing_s/reward:0.153 - timing_s/old_log_prob:7.040 - timing_s/ref:6.940 - timing_s/adv:0.019 - timing_s/update_actor:21.791 - timing_s/dump_rollout_generations:0.277 - timing_s/step:55.361 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.115 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:636123.000 - perf/time_per_step:55.361 - perf/throughput:1436.303
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/284.jsonl
step:284 - global_seqlen/min:78357.000 - global_seqlen/max:82936.000 - global_seqlen/minmax_diff:4579.000 - global_seqlen/balanced_min:80455.000 - global_seqlen/balanced_max:80676.000 - global_seqlen/mean:80482.875 - actor/entropy_loss:1.368 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.026 - actor/kl_coef:0.010 - actor/pg_loss:0.012 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.977 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:130.062 - actor/lr:0.000 - training/global_step:284.000 - training/epoch:4.000 - critic/score/mean:0.561 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.561 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:1.208 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:1.208 - critic/returns/min:-2.475 - response_length/mean:166.663 - response_length/max:796.000 - response_length/min:35.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.109 - prompt_length/max:526.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:15.591 - timing_s/reshard:4.157 - timing_s/gen:20.972 - timing_s/reward:0.158 - timing_s/old_log_prob:7.196 - timing_s/ref:7.151 - timing_s/adv:0.020 - timing_s/update_actor:21.706 - timing_s/dump_rollout_generations:0.279 - timing_s/step:57.515 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.123 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:643863.000 - perf/time_per_step:57.515 - perf/throughput:1399.335
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/285.jsonl
step:285 - global_seqlen/min:76890.000 - global_seqlen/max:81005.000 - global_seqlen/minmax_diff:4115.000 - global_seqlen/balanced_min:79567.000 - global_seqlen/balanced_max:79568.000 - global_seqlen/mean:79567.250 - actor/entropy_loss:1.448 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.021 - actor/kl_coef:0.010 - actor/pg_loss:0.038 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.632 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:130.164 - actor/lr:0.000 - training/global_step:285.000 - training/epoch:4.000 - critic/score/mean:0.639 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.639 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:162.736 - response_length/max:576.000 - response_length/min:45.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.883 - prompt_length/max:494.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.397 - timing_s/reshard:4.166 - timing_s/gen:19.813 - timing_s/reward:0.156 - timing_s/old_log_prob:7.165 - timing_s/ref:6.914 - timing_s/adv:0.021 - timing_s/update_actor:21.916 - timing_s/dump_rollout_generations:0.278 - timing_s/step:56.296 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.119 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:636538.000 - perf/time_per_step:56.296 - perf/throughput:1413.381
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/286.jsonl
step:286 - global_seqlen/min:76507.000 - global_seqlen/max:81516.000 - global_seqlen/minmax_diff:5009.000 - global_seqlen/balanced_min:79502.000 - global_seqlen/balanced_max:79503.000 - global_seqlen/mean:79502.625 - actor/entropy_loss:1.377 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.031 - actor/kl_coef:0.010 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.180 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:130.780 - actor/lr:0.000 - training/global_step:286.000 - training/epoch:4.000 - critic/score/mean:0.666 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.666 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.004 - critic/advantages/max:0.935 - critic/advantages/min:-0.935 - critic/returns/mean:-0.004 - critic/returns/max:0.935 - critic/returns/min:-0.935 - response_length/mean:160.356 - response_length/max:435.000 - response_length/min:36.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.758 - prompt_length/max:497.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.335 - timing_s/reshard:4.132 - timing_s/gen:18.021 - timing_s/reward:0.177 - timing_s/old_log_prob:7.315 - timing_s/ref:7.016 - timing_s/adv:0.020 - timing_s/update_actor:21.395 - timing_s/dump_rollout_generations:0.302 - timing_s/step:54.281 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.110 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:636021.000 - perf/time_per_step:54.281 - perf/throughput:1464.638
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/287.jsonl
step:287 - global_seqlen/min:77434.000 - global_seqlen/max:81438.000 - global_seqlen/minmax_diff:4004.000 - global_seqlen/balanced_min:79945.000 - global_seqlen/balanced_max:79946.000 - global_seqlen/mean:79945.750 - actor/entropy_loss:1.395 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.041 - actor/kl_coef:0.010 - actor/pg_loss:-0.006 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.434 - perf/mfu/actor:0.184 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:131.596 - actor/lr:0.000 - training/global_step:287.000 - training/epoch:4.000 - critic/score/mean:0.611 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.611 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:164.170 - response_length/max:542.000 - response_length/min:25.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.406 - prompt_length/max:517.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.282 - timing_s/reshard:6.856 - timing_s/gen:21.700 - timing_s/reward:0.158 - timing_s/old_log_prob:7.263 - timing_s/ref:7.156 - timing_s/adv:0.022 - timing_s/update_actor:20.887 - timing_s/dump_rollout_generations:0.276 - timing_s/step:57.495 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.129 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:639566.000 - perf/time_per_step:57.495 - perf/throughput:1390.476
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/288.jsonl
step:288 - global_seqlen/min:77574.000 - global_seqlen/max:81711.000 - global_seqlen/minmax_diff:4137.000 - global_seqlen/balanced_min:79239.000 - global_seqlen/balanced_max:80742.000 - global_seqlen/mean:79427.375 - actor/entropy_loss:1.306 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.021 - actor/kl_coef:0.010 - actor/pg_loss:0.100 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.295 - perf/mfu/actor:0.182 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:131.742 - actor/lr:0.000 - training/global_step:288.000 - training/epoch:4.000 - critic/score/mean:0.629 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.629 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.032 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.032 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:158.589 - response_length/max:2048.000 - response_length/min:50.000 - response_length/clip_ratio:0.001 - prompt_length/mean:461.938 - prompt_length/max:506.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.866 - timing_s/reshard:7.908 - timing_s/gen:32.123 - timing_s/reward:0.156 - timing_s/old_log_prob:7.232 - timing_s/ref:6.995 - timing_s/adv:0.022 - timing_s/update_actor:20.993 - timing_s/dump_rollout_generations:0.279 - timing_s/step:67.832 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.198 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:635419.000 - perf/time_per_step:67.832 - perf/throughput:1170.945
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/289.jsonl
step:289 - global_seqlen/min:78459.000 - global_seqlen/max:81059.000 - global_seqlen/minmax_diff:2600.000 - global_seqlen/balanced_min:79382.000 - global_seqlen/balanced_max:80866.000 - global_seqlen/mean:79568.250 - actor/entropy_loss:1.390 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.036 - actor/kl_coef:0.010 - actor/pg_loss:0.099 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.212 - perf/mfu/actor:0.182 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:132.377 - actor/lr:0.000 - training/global_step:289.000 - training/epoch:4.000 - critic/score/mean:0.571 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.571 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.030 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.030 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:160.385 - response_length/max:2048.000 - response_length/min:30.000 - response_length/clip_ratio:0.001 - prompt_length/mean:461.242 - prompt_length/max:503.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.100 - timing_s/reshard:4.163 - timing_s/gen:27.090 - timing_s/reward:0.156 - timing_s/old_log_prob:7.264 - timing_s/ref:7.180 - timing_s/adv:0.024 - timing_s/update_actor:21.046 - timing_s/dump_rollout_generations:0.274 - timing_s/step:63.064 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.165 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:636546.000 - perf/time_per_step:63.064 - perf/throughput:1261.713
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/290.jsonl
step:290 - global_seqlen/min:77258.000 - global_seqlen/max:83038.000 - global_seqlen/minmax_diff:5780.000 - global_seqlen/balanced_min:79652.000 - global_seqlen/balanced_max:80935.000 - global_seqlen/mean:79812.625 - actor/entropy_loss:1.327 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.034 - actor/kl_coef:0.010 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.229 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:132.975 - actor/lr:0.000 - training/global_step:290.000 - training/epoch:4.000 - critic/score/mean:0.659 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.659 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.002 - critic/advantages/max:0.935 - critic/advantages/min:-0.935 - critic/returns/mean:-0.002 - critic/returns/max:0.935 - critic/returns/min:-0.935 - response_length/mean:161.942 - response_length/max:1875.000 - response_length/min:41.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.594 - prompt_length/max:499.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:20.847 - timing_s/reshard:4.473 - timing_s/gen:25.869 - timing_s/reward:0.156 - timing_s/old_log_prob:7.282 - timing_s/ref:7.050 - timing_s/adv:0.019 - timing_s/update_actor:22.116 - timing_s/dump_rollout_generations:0.278 - timing_s/step:62.808 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.156 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:638501.000 - perf/time_per_step:62.808 - perf/throughput:1270.733
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/291.jsonl
step:291 - global_seqlen/min:76628.000 - global_seqlen/max:80919.000 - global_seqlen/minmax_diff:4291.000 - global_seqlen/balanced_min:78790.000 - global_seqlen/balanced_max:78791.000 - global_seqlen/mean:78790.625 - actor/entropy_loss:1.339 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.025 - actor/kl_coef:0.010 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.745 - perf/mfu/actor:0.169 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:133.606 - actor/lr:0.000 - training/global_step:291.000 - training/epoch:4.000 - critic/score/mean:0.667 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.667 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:155.692 - response_length/max:426.000 - response_length/min:47.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.859 - prompt_length/max:516.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.205 - timing_s/reshard:4.163 - timing_s/gen:18.613 - timing_s/reward:0.155 - timing_s/old_log_prob:7.238 - timing_s/ref:6.965 - timing_s/adv:0.020 - timing_s/update_actor:22.315 - timing_s/dump_rollout_generations:0.278 - timing_s/step:55.620 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:630325.000 - perf/time_per_step:55.620 - perf/throughput:1416.587
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/292.jsonl
step:292 - global_seqlen/min:77757.000 - global_seqlen/max:81717.000 - global_seqlen/minmax_diff:3960.000 - global_seqlen/balanced_min:79191.000 - global_seqlen/balanced_max:79192.000 - global_seqlen/mean:79191.125 - actor/entropy_loss:1.388 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.025 - actor/kl_coef:0.010 - actor/pg_loss:0.027 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.894 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:134.714 - actor/lr:0.000 - training/global_step:292.000 - training/epoch:4.000 - critic/score/mean:0.630 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.630 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:157.962 - response_length/max:440.000 - response_length/min:45.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.719 - prompt_length/max:517.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.487 - timing_s/reshard:4.118 - timing_s/gen:18.828 - timing_s/reward:0.154 - timing_s/old_log_prob:7.341 - timing_s/ref:7.051 - timing_s/adv:0.020 - timing_s/update_actor:21.913 - timing_s/dump_rollout_generations:0.278 - timing_s/step:55.615 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:633529.000 - perf/time_per_step:55.615 - perf/throughput:1423.909
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/293.jsonl
step:293 - global_seqlen/min:76311.000 - global_seqlen/max:81516.000 - global_seqlen/minmax_diff:5205.000 - global_seqlen/balanced_min:78809.000 - global_seqlen/balanced_max:78810.000 - global_seqlen/mean:78809.625 - actor/entropy_loss:1.293 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.038 - actor/kl_coef:0.010 - actor/pg_loss:-0.002 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.351 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:135.565 - actor/lr:0.000 - training/global_step:293.000 - training/epoch:4.000 - critic/score/mean:0.674 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.674 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:155.622 - response_length/max:443.000 - response_length/min:30.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.078 - prompt_length/max:526.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.904 - timing_s/reshard:4.128 - timing_s/gen:18.592 - timing_s/reward:0.154 - timing_s/old_log_prob:7.117 - timing_s/ref:6.986 - timing_s/adv:0.019 - timing_s/update_actor:21.955 - timing_s/dump_rollout_generations:0.306 - timing_s/step:55.159 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:630477.000 - perf/time_per_step:55.159 - perf/throughput:1428.775
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/294.jsonl
step:294 - global_seqlen/min:76299.000 - global_seqlen/max:82813.000 - global_seqlen/minmax_diff:6514.000 - global_seqlen/balanced_min:78786.000 - global_seqlen/balanced_max:80205.000 - global_seqlen/mean:79318.375 - actor/entropy_loss:1.266 - training/rollout_probs_diff_max:0.991 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.075 - actor/kl_loss:0.017 - actor/kl_coef:0.010 - actor/pg_loss:0.110 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.141 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:136.058 - actor/lr:0.000 - training/global_step:294.000 - training/epoch:4.000 - critic/score/mean:0.632 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.632 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.089 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.089 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:158.769 - response_length/max:2048.000 - response_length/min:42.000 - response_length/clip_ratio:0.003 - prompt_length/mean:460.906 - prompt_length/max:506.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:23.243 - timing_s/reshard:6.903 - timing_s/gen:31.449 - timing_s/reward:0.155 - timing_s/old_log_prob:6.990 - timing_s/ref:6.793 - timing_s/adv:0.023 - timing_s/update_actor:21.883 - timing_s/dump_rollout_generations:0.278 - timing_s/step:67.617 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.193 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:634547.000 - perf/time_per_step:67.617 - perf/throughput:1173.053
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/295.jsonl
step:295 - global_seqlen/min:75437.000 - global_seqlen/max:81600.000 - global_seqlen/minmax_diff:6163.000 - global_seqlen/balanced_min:78965.000 - global_seqlen/balanced_max:78966.000 - global_seqlen/mean:78965.625 - actor/entropy_loss:1.299 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.051 - actor/kl_coef:0.010 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.661 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:136.819 - actor/lr:0.000 - training/global_step:295.000 - training/epoch:4.000 - critic/score/mean:0.590 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.590 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:155.669 - response_length/max:465.000 - response_length/min:35.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.250 - prompt_length/max:507.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.678 - timing_s/reshard:4.165 - timing_s/gen:19.088 - timing_s/reward:0.154 - timing_s/old_log_prob:7.241 - timing_s/ref:6.875 - timing_s/adv:0.020 - timing_s/update_actor:21.895 - timing_s/dump_rollout_generations:0.302 - timing_s/step:55.607 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.120 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:631725.000 - perf/time_per_step:55.607 - perf/throughput:1420.075
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/296.jsonl
step:296 - global_seqlen/min:74041.000 - global_seqlen/max:81484.000 - global_seqlen/minmax_diff:7443.000 - global_seqlen/balanced_min:78388.000 - global_seqlen/balanced_max:78389.000 - global_seqlen/mean:78388.875 - actor/entropy_loss:1.399 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.033 - actor/kl_coef:0.010 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.281 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.376 - actor/lr:0.000 - training/global_step:296.000 - training/epoch:4.000 - critic/score/mean:0.665 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.665 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.935 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:0.935 - critic/returns/min:-2.475 - response_length/mean:153.663 - response_length/max:561.000 - response_length/min:41.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.750 - prompt_length/max:505.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.770 - timing_s/reshard:4.423 - timing_s/gen:18.756 - timing_s/reward:0.154 - timing_s/old_log_prob:7.141 - timing_s/ref:7.001 - timing_s/adv:0.022 - timing_s/update_actor:21.623 - timing_s/dump_rollout_generations:0.275 - timing_s/step:55.012 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.119 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:627111.000 - perf/time_per_step:55.012 - perf/throughput:1424.935
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/297.jsonl
step:297 - global_seqlen/min:76828.000 - global_seqlen/max:79528.000 - global_seqlen/minmax_diff:2700.000 - global_seqlen/balanced_min:78276.000 - global_seqlen/balanced_max:78277.000 - global_seqlen/mean:78276.250 - actor/entropy_loss:1.334 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.040 - actor/kl_coef:0.010 - actor/pg_loss:-0.015 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.544 - perf/mfu/actor:0.189 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.322 - actor/lr:0.000 - training/global_step:297.000 - training/epoch:4.000 - critic/score/mean:0.707 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.707 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:1.620 - critic/advantages/min:-1.208 - critic/returns/mean:-0.003 - critic/returns/max:1.620 - critic/returns/min:-1.208 - response_length/mean:152.268 - response_length/max:500.000 - response_length/min:37.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.266 - prompt_length/max:530.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.131 - timing_s/reshard:7.375 - timing_s/gen:21.032 - timing_s/reward:0.176 - timing_s/old_log_prob:7.153 - timing_s/ref:7.200 - timing_s/adv:0.020 - timing_s/update_actor:19.911 - timing_s/dump_rollout_generations:0.277 - timing_s/step:55.799 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.032 - timing_per_token_ms/gen:0.135 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:626210.000 - perf/time_per_step:55.799 - perf/throughput:1402.834
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/298.jsonl
step:298 - global_seqlen/min:76676.000 - global_seqlen/max:81620.000 - global_seqlen/minmax_diff:4944.000 - global_seqlen/balanced_min:77988.000 - global_seqlen/balanced_max:78393.000 - global_seqlen/mean:78039.000 - actor/entropy_loss:1.306 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.024 - actor/kl_coef:0.010 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.765 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.348 - actor/lr:0.000 - training/global_step:298.000 - training/epoch:4.000 - critic/score/mean:0.693 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.693 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-1.620 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-1.620 - response_length/mean:150.672 - response_length/max:971.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.008 - prompt_length/max:506.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:16.481 - timing_s/reshard:9.057 - timing_s/gen:26.109 - timing_s/reward:0.151 - timing_s/old_log_prob:7.232 - timing_s/ref:7.113 - timing_s/adv:0.020 - timing_s/update_actor:21.099 - timing_s/dump_rollout_generations:0.276 - timing_s/step:62.031 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.169 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:624312.000 - perf/time_per_step:62.031 - perf/throughput:1258.058
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/299.jsonl
step:299 - global_seqlen/min:76220.000 - global_seqlen/max:82153.000 - global_seqlen/minmax_diff:5933.000 - global_seqlen/balanced_min:79276.000 - global_seqlen/balanced_max:79336.000 - global_seqlen/mean:79284.125 - actor/entropy_loss:1.365 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.043 - actor/kl_coef:0.010 - actor/pg_loss:-0.012 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.137 - perf/mfu/actor:0.179 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.332 - actor/lr:0.000 - training/global_step:299.000 - training/epoch:4.000 - critic/score/mean:0.650 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.650 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:1.620 - critic/advantages/min:-0.540 - critic/returns/mean:-0.003 - critic/returns/max:1.620 - critic/returns/min:-0.540 - response_length/mean:157.001 - response_length/max:665.000 - response_length/min:39.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.406 - prompt_length/max:517.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.648 - timing_s/reshard:8.091 - timing_s/gen:23.322 - timing_s/reward:0.154 - timing_s/old_log_prob:7.067 - timing_s/ref:6.899 - timing_s/adv:0.019 - timing_s/update_actor:21.244 - timing_s/dump_rollout_generations:0.277 - timing_s/step:59.015 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.145 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:634273.000 - perf/time_per_step:59.015 - perf/throughput:1343.466
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/300.jsonl
step:300 - global_seqlen/min:76146.000 - global_seqlen/max:80618.000 - global_seqlen/minmax_diff:4472.000 - global_seqlen/balanced_min:77944.000 - global_seqlen/balanced_max:77945.000 - global_seqlen/mean:77944.875 - actor/entropy_loss:1.308 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.023 - actor/kl_coef:0.010 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.375 - perf/mfu/actor:0.169 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.272 - actor/lr:0.000 - training/global_step:300.000 - training/epoch:4.000 - critic/score/mean:0.734 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.734 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.001 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:0.001 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:149.874 - response_length/max:403.000 - response_length/min:37.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.070 - prompt_length/max:499.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.420 - timing_s/reshard:8.013 - timing_s/gen:21.977 - timing_s/reward:0.175 - timing_s/old_log_prob:7.132 - timing_s/ref:7.195 - timing_s/adv:0.019 - timing_s/update_actor:22.162 - timing_s/dump_rollout_generations:0.273 - timing_s/step:58.964 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.036 - timing_per_token_ms/gen:0.143 - timing_per_token_ms/ref:0.012 - perf/total_num_tokens:623559.000 - perf/time_per_step:58.964 - perf/throughput:1321.916
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/301.jsonl
step:301 - global_seqlen/min:76749.000 - global_seqlen/max:81057.000 - global_seqlen/minmax_diff:4308.000 - global_seqlen/balanced_min:78455.000 - global_seqlen/balanced_max:79525.000 - global_seqlen/mean:78620.625 - actor/entropy_loss:1.341 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.027 - actor/kl_coef:0.010 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.145 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.459 - actor/lr:0.000 - training/global_step:301.000 - training/epoch:4.000 - critic/score/mean:0.630 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.630 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:1.208 - critic/advantages/min:-0.725 - critic/returns/mean:-0.003 - critic/returns/max:1.208 - critic/returns/min:-0.725 - response_length/mean:154.528 - response_length/max:1647.000 - response_length/min:32.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.695 - prompt_length/max:531.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:19.654 - timing_s/reshard:8.444 - timing_s/gen:28.814 - timing_s/reward:0.153 - timing_s/old_log_prob:7.319 - timing_s/ref:7.060 - timing_s/adv:0.020 - timing_s/update_actor:21.320 - timing_s/dump_rollout_generations:0.300 - timing_s/step:65.018 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.182 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:628965.000 - perf/time_per_step:65.018 - perf/throughput:1209.205
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/302.jsonl
step:302 - global_seqlen/min:75831.000 - global_seqlen/max:81988.000 - global_seqlen/minmax_diff:6157.000 - global_seqlen/balanced_min:79451.000 - global_seqlen/balanced_max:79452.000 - global_seqlen/mean:79451.375 - actor/entropy_loss:1.332 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.031 - actor/kl_coef:0.010 - actor/pg_loss:0.019 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.761 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.521 - actor/lr:0.000 - training/global_step:302.000 - training/epoch:4.000 - critic/score/mean:0.604 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.604 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:158.823 - response_length/max:547.000 - response_length/min:34.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.891 - prompt_length/max:521.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.742 - timing_s/reshard:6.406 - timing_s/gen:20.694 - timing_s/reward:0.155 - timing_s/old_log_prob:7.234 - timing_s/ref:7.044 - timing_s/adv:0.020 - timing_s/update_actor:21.958 - timing_s/dump_rollout_generations:0.279 - timing_s/step:57.419 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.127 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:635611.000 - perf/time_per_step:57.419 - perf/throughput:1383.718
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/303.jsonl
step:303 - global_seqlen/min:77033.000 - global_seqlen/max:83392.000 - global_seqlen/minmax_diff:6359.000 - global_seqlen/balanced_min:79091.000 - global_seqlen/balanced_max:79092.000 - global_seqlen/mean:79091.125 - actor/entropy_loss:1.318 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.030 - actor/kl_coef:0.010 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.133 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.598 - actor/lr:0.000 - training/global_step:303.000 - training/epoch:4.000 - critic/score/mean:0.675 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.675 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.002 - critic/advantages/max:0.540 - critic/advantages/min:-1.620 - critic/returns/mean:-0.002 - critic/returns/max:0.540 - critic/returns/min:-1.620 - response_length/mean:156.821 - response_length/max:532.000 - response_length/min:42.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.078 - prompt_length/max:540.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.883 - timing_s/reshard:7.319 - timing_s/gen:21.758 - timing_s/reward:0.153 - timing_s/old_log_prob:7.205 - timing_s/ref:6.976 - timing_s/adv:0.020 - timing_s/update_actor:22.115 - timing_s/dump_rollout_generations:0.293 - timing_s/step:58.552 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.135 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:632729.000 - perf/time_per_step:58.552 - perf/throughput:1350.787
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/304.jsonl
step:304 - global_seqlen/min:76629.000 - global_seqlen/max:81278.000 - global_seqlen/minmax_diff:4649.000 - global_seqlen/balanced_min:79282.000 - global_seqlen/balanced_max:79283.000 - global_seqlen/mean:79282.625 - actor/entropy_loss:1.276 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.075 - actor/kl_loss:0.022 - actor/kl_coef:0.010 - actor/pg_loss:0.006 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.210 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.666 - actor/lr:0.000 - training/global_step:304.000 - training/epoch:4.000 - critic/score/mean:0.633 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.633 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:0.540 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:0.540 - critic/returns/min:-2.475 - response_length/mean:157.833 - response_length/max:506.000 - response_length/min:39.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.562 - prompt_length/max:508.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.687 - timing_s/reshard:7.815 - timing_s/gen:22.059 - timing_s/reward:0.155 - timing_s/old_log_prob:7.179 - timing_s/ref:7.022 - timing_s/adv:0.021 - timing_s/update_actor:21.851 - timing_s/dump_rollout_generations:0.276 - timing_s/step:58.596 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.136 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:634261.000 - perf/time_per_step:58.596 - perf/throughput:1353.047
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/305.jsonl
step:305 - global_seqlen/min:76126.000 - global_seqlen/max:83291.000 - global_seqlen/minmax_diff:7165.000 - global_seqlen/balanced_min:79513.000 - global_seqlen/balanced_max:79514.000 - global_seqlen/mean:79513.125 - actor/entropy_loss:1.292 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.023 - actor/kl_coef:0.010 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.647 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:138.127 - actor/lr:0.000 - training/global_step:305.000 - training/epoch:4.000 - critic/score/mean:0.669 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.669 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.001 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:0.001 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:159.290 - response_length/max:424.000 - response_length/min:47.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.906 - prompt_length/max:509.000 - prompt_length/min:436.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.536 - timing_s/reshard:7.757 - timing_s/gen:21.818 - timing_s/reward:0.154 - timing_s/old_log_prob:7.210 - timing_s/ref:7.070 - timing_s/adv:0.032 - timing_s/update_actor:22.291 - timing_s/dump_rollout_generations:0.277 - timing_s/step:58.884 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.134 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:636105.000 - perf/time_per_step:58.884 - perf/throughput:1350.346
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/306.jsonl
step:306 - global_seqlen/min:76244.000 - global_seqlen/max:82511.000 - global_seqlen/minmax_diff:6267.000 - global_seqlen/balanced_min:79342.000 - global_seqlen/balanced_max:79343.000 - global_seqlen/mean:79342.375 - actor/entropy_loss:1.236 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.055 - actor/kl_coef:0.010 - actor/pg_loss:-0.007 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.356 - perf/mfu/actor:0.182 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.783 - actor/lr:0.000 - training/global_step:306.000 - training/epoch:4.000 - critic/score/mean:0.618 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.618 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:0.540 - critic/advantages/min:-2.475 - critic/returns/mean:-0.005 - critic/returns/max:0.540 - critic/returns/min:-2.475 - response_length/mean:159.495 - response_length/max:482.000 - response_length/min:43.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.367 - prompt_length/max:511.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.821 - timing_s/reshard:8.341 - timing_s/gen:22.729 - timing_s/reward:0.154 - timing_s/old_log_prob:7.156 - timing_s/ref:7.163 - timing_s/adv:0.021 - timing_s/update_actor:20.982 - timing_s/dump_rollout_generations:0.274 - timing_s/step:58.513 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.139 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:634739.000 - perf/time_per_step:58.513 - perf/throughput:1355.972
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/307.jsonl
step:307 - global_seqlen/min:78674.000 - global_seqlen/max:81753.000 - global_seqlen/minmax_diff:3079.000 - global_seqlen/balanced_min:80073.000 - global_seqlen/balanced_max:80073.000 - global_seqlen/mean:80073.000 - actor/entropy_loss:1.292 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.020 - actor/kl_coef:0.010 - actor/pg_loss:0.036 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.387 - perf/mfu/actor:0.183 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:137.979 - actor/lr:0.000 - training/global_step:307.000 - training/epoch:4.000 - critic/score/mean:0.615 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.615 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.004 - critic/advantages/max:1.208 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:1.208 - critic/returns/min:-2.475 - response_length/mean:162.078 - response_length/max:484.000 - response_length/min:38.000 - response_length/clip_ratio:0.000 - prompt_length/mean:463.492 - prompt_length/max:511.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.707 - timing_s/reshard:8.271 - timing_s/gen:22.536 - timing_s/reward:0.156 - timing_s/old_log_prob:7.067 - timing_s/ref:6.940 - timing_s/adv:0.020 - timing_s/update_actor:21.085 - timing_s/dump_rollout_generations:0.276 - timing_s/step:58.109 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.136 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:640584.000 - perf/time_per_step:58.109 - perf/throughput:1377.968
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/308.jsonl
step:308 - global_seqlen/min:78042.000 - global_seqlen/max:81511.000 - global_seqlen/minmax_diff:3469.000 - global_seqlen/balanced_min:79697.000 - global_seqlen/balanced_max:79698.000 - global_seqlen/mean:79697.625 - actor/entropy_loss:1.290 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.020 - actor/kl_coef:0.010 - actor/pg_loss:0.011 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.129 - perf/mfu/actor:0.183 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:138.804 - actor/lr:0.000 - training/global_step:308.000 - training/epoch:4.000 - critic/score/mean:0.679 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.679 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.002 - critic/advantages/max:1.208 - critic/advantages/min:-0.725 - critic/returns/mean:-0.002 - critic/returns/max:1.208 - critic/returns/min:-0.725 - response_length/mean:161.278 - response_length/max:438.000 - response_length/min:45.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.359 - prompt_length/max:509.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.788 - timing_s/reshard:6.160 - timing_s/gen:20.513 - timing_s/reward:0.178 - timing_s/old_log_prob:7.160 - timing_s/ref:7.121 - timing_s/adv:0.020 - timing_s/update_actor:20.887 - timing_s/dump_rollout_generations:0.277 - timing_s/step:56.187 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:637581.000 - perf/time_per_step:56.187 - perf/throughput:1418.441
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/309.jsonl
step:309 - global_seqlen/min:78059.000 - global_seqlen/max:81050.000 - global_seqlen/minmax_diff:2991.000 - global_seqlen/balanced_min:79688.000 - global_seqlen/balanced_max:79689.000 - global_seqlen/mean:79688.125 - actor/entropy_loss:1.292 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.047 - actor/kl_coef:0.010 - actor/pg_loss:0.016 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.283 - perf/mfu/actor:0.180 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:139.158 - actor/lr:0.000 - training/global_step:309.000 - training/epoch:4.000 - critic/score/mean:0.692 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.692 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:0.725 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:0.725 - critic/returns/min:-2.475 - response_length/mean:162.196 - response_length/max:446.000 - response_length/min:37.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.367 - prompt_length/max:499.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.108 - timing_s/reshard:4.098 - timing_s/gen:18.731 - timing_s/reward:0.156 - timing_s/old_log_prob:7.207 - timing_s/ref:7.036 - timing_s/adv:0.019 - timing_s/update_actor:21.324 - timing_s/dump_rollout_generations:0.273 - timing_s/step:54.778 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:637505.000 - perf/time_per_step:54.778 - perf/throughput:1454.736
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/310.jsonl
step:310 - global_seqlen/min:78361.000 - global_seqlen/max:82875.000 - global_seqlen/minmax_diff:4514.000 - global_seqlen/balanced_min:79990.000 - global_seqlen/balanced_max:81479.000 - global_seqlen/mean:80176.375 - actor/entropy_loss:1.214 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.075 - actor/kl_loss:0.020 - actor/kl_coef:0.010 - actor/pg_loss:0.090 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.545 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:139.775 - actor/lr:0.000 - training/global_step:310.000 - training/epoch:4.000 - critic/score/mean:0.696 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.696 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.032 - critic/advantages/max:0.540 - critic/advantages/min:-2.475 - critic/returns/mean:-0.032 - critic/returns/max:0.540 - critic/returns/min:-2.475 - response_length/mean:165.933 - response_length/max:2048.000 - response_length/min:46.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.445 - prompt_length/max:503.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.033 - timing_s/reshard:4.180 - timing_s/gen:26.771 - timing_s/reward:0.155 - timing_s/old_log_prob:7.289 - timing_s/ref:7.035 - timing_s/adv:0.023 - timing_s/update_actor:21.982 - timing_s/dump_rollout_generations:0.275 - timing_s/step:63.566 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.158 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:641411.000 - perf/time_per_step:63.566 - perf/throughput:1261.315
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/311.jsonl
step:311 - global_seqlen/min:76543.000 - global_seqlen/max:83204.000 - global_seqlen/minmax_diff:6661.000 - global_seqlen/balanced_min:80465.000 - global_seqlen/balanced_max:81945.000 - global_seqlen/mean:80650.125 - actor/entropy_loss:1.261 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.026 - actor/kl_coef:0.010 - actor/pg_loss:0.083 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.287 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:139.849 - actor/lr:0.000 - training/global_step:311.000 - training/epoch:4.000 - critic/score/mean:0.643 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.643 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.031 - critic/advantages/max:0.935 - critic/advantages/min:-2.475 - critic/returns/mean:-0.031 - critic/returns/max:0.935 - critic/returns/min:-2.475 - response_length/mean:167.728 - response_length/max:2048.000 - response_length/min:51.000 - response_length/clip_ratio:0.001 - prompt_length/mean:462.352 - prompt_length/max:505.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.526 - timing_s/reshard:4.076 - timing_s/gen:27.152 - timing_s/reward:0.159 - timing_s/old_log_prob:7.273 - timing_s/ref:7.123 - timing_s/adv:0.027 - timing_s/update_actor:22.476 - timing_s/dump_rollout_generations:0.282 - timing_s/step:64.523 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.158 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:645201.000 - perf/time_per_step:64.523 - perf/throughput:1249.940
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/312.jsonl
step:312 - global_seqlen/min:77932.000 - global_seqlen/max:82950.000 - global_seqlen/minmax_diff:5018.000 - global_seqlen/balanced_min:80717.000 - global_seqlen/balanced_max:80754.000 - global_seqlen/mean:80722.250 - actor/entropy_loss:1.234 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.036 - actor/kl_coef:0.010 - actor/pg_loss:-0.006 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.407 - perf/mfu/actor:0.179 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:140.580 - actor/lr:0.000 - training/global_step:312.000 - training/epoch:4.000 - critic/score/mean:0.581 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.581 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:0.725 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:0.725 - critic/returns/min:-2.475 - response_length/mean:167.354 - response_length/max:622.000 - response_length/min:43.000 - response_length/clip_ratio:0.000 - prompt_length/mean:463.289 - prompt_length/max:512.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.645 - timing_s/reshard:6.111 - timing_s/gen:21.298 - timing_s/reward:0.156 - timing_s/old_log_prob:7.166 - timing_s/ref:6.923 - timing_s/adv:0.020 - timing_s/update_actor:21.720 - timing_s/dump_rollout_generations:0.278 - timing_s/step:57.594 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:645778.000 - perf/time_per_step:57.594 - perf/throughput:1401.575
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/313.jsonl
step:313 - global_seqlen/min:78884.000 - global_seqlen/max:81798.000 - global_seqlen/minmax_diff:2914.000 - global_seqlen/balanced_min:80486.000 - global_seqlen/balanced_max:80487.000 - global_seqlen/mean:80486.500 - actor/entropy_loss:1.232 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.037 - actor/kl_coef:0.010 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.121 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:140.624 - actor/lr:0.000 - training/global_step:313.000 - training/epoch:4.000 - critic/score/mean:0.602 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.602 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.001 - critic/advantages/max:1.208 - critic/advantages/min:-0.725 - critic/returns/mean:0.001 - critic/returns/max:1.208 - critic/returns/min:-0.725 - response_length/mean:165.809 - response_length/max:541.000 - response_length/min:24.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.992 - prompt_length/max:513.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.939 - timing_s/reshard:5.005 - timing_s/gen:20.491 - timing_s/reward:0.157 - timing_s/old_log_prob:7.114 - timing_s/ref:6.912 - timing_s/adv:0.020 - timing_s/update_actor:22.023 - timing_s/dump_rollout_generations:0.278 - timing_s/step:57.025 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.121 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:643892.000 - perf/time_per_step:57.025 - perf/throughput:1411.413
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/314.jsonl
step:314 - global_seqlen/min:79081.000 - global_seqlen/max:83109.000 - global_seqlen/minmax_diff:4028.000 - global_seqlen/balanced_min:80703.000 - global_seqlen/balanced_max:82196.000 - global_seqlen/mean:80890.000 - actor/entropy_loss:1.259 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.023 - actor/kl_coef:0.010 - actor/pg_loss:0.095 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.335 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:140.645 - actor/lr:0.000 - training/global_step:314.000 - training/epoch:4.000 - critic/score/mean:0.588 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.588 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.030 - critic/advantages/max:0.725 - critic/advantages/min:-2.475 - critic/returns/mean:-0.030 - critic/returns/max:0.725 - critic/returns/min:-2.475 - response_length/mean:170.453 - response_length/max:2048.000 - response_length/min:51.000 - response_length/clip_ratio:0.001 - prompt_length/mean:461.500 - prompt_length/max:523.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:23.017 - timing_s/reshard:4.079 - timing_s/gen:27.636 - timing_s/reward:0.159 - timing_s/old_log_prob:7.065 - timing_s/ref:7.091 - timing_s/adv:0.022 - timing_s/update_actor:22.013 - timing_s/dump_rollout_generations:0.284 - timing_s/step:64.300 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.158 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:647120.000 - perf/time_per_step:64.300 - perf/throughput:1258.002
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/315.jsonl
step:315 - global_seqlen/min:77793.000 - global_seqlen/max:82915.000 - global_seqlen/minmax_diff:5122.000 - global_seqlen/balanced_min:79775.000 - global_seqlen/balanced_max:79776.000 - global_seqlen/mean:79775.375 - actor/entropy_loss:1.260 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.075 - actor/kl_loss:0.035 - actor/kl_coef:0.010 - actor/pg_loss:0.009 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.423 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:140.675 - actor/lr:0.000 - training/global_step:315.000 - training/epoch:4.000 - critic/score/mean:0.625 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.625 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.000 - critic/advantages/max:2.475 - critic/advantages/min:-0.540 - critic/returns/mean:-0.000 - critic/returns/max:2.475 - critic/returns/min:-0.540 - response_length/mean:164.276 - response_length/max:438.000 - response_length/min:24.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.969 - prompt_length/max:501.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.478 - timing_s/reshard:6.095 - timing_s/gen:20.137 - timing_s/reward:0.155 - timing_s/old_log_prob:7.216 - timing_s/ref:6.994 - timing_s/adv:0.019 - timing_s/update_actor:22.184 - timing_s/dump_rollout_generations:0.275 - timing_s/step:57.014 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.120 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:638203.000 - perf/time_per_step:57.014 - perf/throughput:1399.215
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/316.jsonl
step:316 - global_seqlen/min:78006.000 - global_seqlen/max:84335.000 - global_seqlen/minmax_diff:6329.000 - global_seqlen/balanced_min:80671.000 - global_seqlen/balanced_max:82077.000 - global_seqlen/mean:80847.125 - actor/entropy_loss:1.221 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.032 - actor/kl_coef:0.010 - actor/pg_loss:0.098 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.459 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:140.738 - actor/lr:0.000 - training/global_step:316.000 - training/epoch:4.000 - critic/score/mean:0.624 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.624 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.032 - critic/advantages/max:0.540 - critic/advantages/min:-2.475 - critic/returns/mean:-0.032 - critic/returns/max:0.540 - critic/returns/min:-2.475 - response_length/mean:169.337 - response_length/max:2048.000 - response_length/min:34.000 - response_length/clip_ratio:0.001 - prompt_length/mean:462.281 - prompt_length/max:509.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.137 - timing_s/reshard:4.437 - timing_s/gen:27.116 - timing_s/reward:0.157 - timing_s/old_log_prob:7.269 - timing_s/ref:7.080 - timing_s/adv:0.021 - timing_s/update_actor:22.046 - timing_s/dump_rollout_generations:0.279 - timing_s/step:64.001 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.156 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:646777.000 - perf/time_per_step:64.001 - perf/throughput:1263.224
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/317.jsonl
step:317 - global_seqlen/min:77957.000 - global_seqlen/max:82353.000 - global_seqlen/minmax_diff:4396.000 - global_seqlen/balanced_min:80402.000 - global_seqlen/balanced_max:80403.000 - global_seqlen/mean:80402.250 - actor/entropy_loss:1.246 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.027 - actor/kl_coef:0.010 - actor/pg_loss:0.031 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.993 - perf/mfu/actor:0.181 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:139.901 - actor/lr:0.000 - training/global_step:317.000 - training/epoch:4.000 - critic/score/mean:0.619 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.619 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.004 - critic/advantages/max:0.354 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:0.354 - critic/returns/min:-2.475 - response_length/mean:166.541 - response_length/max:415.000 - response_length/min:51.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.602 - prompt_length/max:529.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.391 - timing_s/reshard:8.643 - timing_s/gen:22.564 - timing_s/reward:0.157 - timing_s/old_log_prob:7.181 - timing_s/ref:6.920 - timing_s/adv:0.019 - timing_s/update_actor:21.365 - timing_s/dump_rollout_generations:0.302 - timing_s/step:58.540 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.132 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:643218.000 - perf/time_per_step:58.540 - perf/throughput:1373.449
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/318.jsonl
step:318 - global_seqlen/min:77256.000 - global_seqlen/max:82017.000 - global_seqlen/minmax_diff:4761.000 - global_seqlen/balanced_min:79665.000 - global_seqlen/balanced_max:79666.000 - global_seqlen/mean:79665.250 - actor/entropy_loss:1.251 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.031 - actor/kl_coef:0.010 - actor/pg_loss:0.006 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.085 - perf/mfu/actor:0.179 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:139.693 - actor/lr:0.000 - training/global_step:318.000 - training/epoch:4.000 - critic/score/mean:0.699 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.699 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.002 - critic/advantages/max:1.208 - critic/advantages/min:-1.620 - critic/returns/mean:-0.002 - critic/returns/max:1.208 - critic/returns/min:-1.620 - response_length/mean:161.775 - response_length/max:416.000 - response_length/min:23.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.609 - prompt_length/max:505.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.295 - timing_s/reshard:7.310 - timing_s/gen:21.168 - timing_s/reward:0.155 - timing_s/old_log_prob:7.052 - timing_s/ref:6.954 - timing_s/adv:0.020 - timing_s/update_actor:21.298 - timing_s/dump_rollout_generations:0.275 - timing_s/step:56.955 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.128 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:637322.000 - perf/time_per_step:56.955 - perf/throughput:1398.750
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/319.jsonl
step:319 - global_seqlen/min:78084.000 - global_seqlen/max:82691.000 - global_seqlen/minmax_diff:4607.000 - global_seqlen/balanced_min:80111.000 - global_seqlen/balanced_max:80112.000 - global_seqlen/mean:80111.750 - actor/entropy_loss:1.290 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.027 - actor/kl_coef:0.010 - actor/pg_loss:-0.024 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.594 - perf/mfu/actor:0.189 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:140.112 - actor/lr:0.000 - training/global_step:319.000 - training/epoch:4.000 - critic/score/mean:0.624 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.624 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:166.350 - response_length/max:454.000 - response_length/min:44.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.523 - prompt_length/max:515.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.488 - timing_s/reshard:4.628 - timing_s/gen:19.694 - timing_s/reward:0.155 - timing_s/old_log_prob:7.229 - timing_s/ref:7.000 - timing_s/adv:0.020 - timing_s/update_actor:20.348 - timing_s/dump_rollout_generations:0.275 - timing_s/step:54.757 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.032 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:640894.000 - perf/time_per_step:54.757 - perf/throughput:1463.038
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/320.jsonl
local_global_step_folder: ../ckpt/checkpoints/global_step_320
step:320 - global_seqlen/min:78759.000 - global_seqlen/max:83009.000 - global_seqlen/minmax_diff:4250.000 - global_seqlen/balanced_min:80123.000 - global_seqlen/balanced_max:80123.000 - global_seqlen/mean:80123.000 - actor/entropy_loss:1.307 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.015 - actor/kl_coef:0.010 - actor/pg_loss:0.022 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.778 - perf/mfu/actor:0.185 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:140.216 - actor/lr:0.000 - training/global_step:320.000 - training/epoch:4.000 - critic/score/mean:0.687 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.687 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.540 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:0.540 - critic/returns/min:-2.475 - response_length/mean:166.578 - response_length/max:449.000 - response_length/min:41.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.383 - prompt_length/max:502.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.902 - timing_s/reshard:4.171 - timing_s/gen:18.620 - timing_s/reward:0.157 - timing_s/old_log_prob:7.114 - timing_s/ref:6.848 - timing_s/adv:0.020 - timing_s/update_actor:20.812 - timing_s/dump_rollout_generations:0.275 - timing_s/save_checkpoint:32.051 - timing_s/step:85.929 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.032 - timing_per_token_ms/gen:0.109 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:640984.000 - perf/time_per_step:85.929 - perf/throughput:932.437
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/321.jsonl
step:321 - global_seqlen/min:77013.000 - global_seqlen/max:84728.000 - global_seqlen/minmax_diff:7715.000 - global_seqlen/balanced_min:80359.000 - global_seqlen/balanced_max:81806.000 - global_seqlen/mean:80540.250 - actor/entropy_loss:1.218 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.075 - actor/kl_loss:0.030 - actor/kl_coef:0.010 - actor/pg_loss:0.102 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.350 - perf/mfu/actor:0.179 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:144.647 - actor/lr:0.000 - training/global_step:321.000 - training/epoch:4.000 - critic/score/mean:0.698 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.698 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.030 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.030 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:167.635 - response_length/max:2048.000 - response_length/min:47.000 - response_length/clip_ratio:0.001 - prompt_length/mean:461.586 - prompt_length/max:540.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:23.918 - timing_s/reshard:4.409 - timing_s/gen:28.818 - timing_s/reward:0.156 - timing_s/old_log_prob:7.354 - timing_s/ref:7.225 - timing_s/adv:0.026 - timing_s/update_actor:21.736 - timing_s/dump_rollout_generations:0.278 - timing_s/step:65.996 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.168 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:644322.000 - perf/time_per_step:65.996 - perf/throughput:1220.390
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/322.jsonl
step:322 - global_seqlen/min:78201.000 - global_seqlen/max:81526.000 - global_seqlen/minmax_diff:3325.000 - global_seqlen/balanced_min:79908.000 - global_seqlen/balanced_max:79924.000 - global_seqlen/mean:79912.500 - actor/entropy_loss:1.324 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.030 - actor/kl_coef:0.010 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.462 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:141.327 - actor/lr:0.000 - training/global_step:322.000 - training/epoch:4.000 - critic/score/mean:0.690 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.690 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.002 - critic/advantages/max:0.354 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:0.354 - critic/returns/min:-2.475 - response_length/mean:163.332 - response_length/max:562.000 - response_length/min:38.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.984 - prompt_length/max:509.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.700 - timing_s/reshard:4.158 - timing_s/gen:19.416 - timing_s/reward:0.157 - timing_s/old_log_prob:7.232 - timing_s/ref:7.171 - timing_s/adv:0.020 - timing_s/update_actor:22.543 - timing_s/dump_rollout_generations:0.282 - timing_s/step:56.852 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:639300.000 - perf/time_per_step:56.852 - perf/throughput:1405.633
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/323.jsonl
step:323 - global_seqlen/min:77681.000 - global_seqlen/max:82732.000 - global_seqlen/minmax_diff:5051.000 - global_seqlen/balanced_min:80169.000 - global_seqlen/balanced_max:81663.000 - global_seqlen/mean:80356.125 - actor/entropy_loss:1.283 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.025 - actor/kl_coef:0.010 - actor/pg_loss:0.085 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.198 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:141.405 - actor/lr:0.000 - training/global_step:323.000 - training/epoch:4.000 - critic/score/mean:0.663 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.663 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.032 - critic/advantages/max:1.208 - critic/advantages/min:-2.475 - critic/returns/mean:-0.032 - critic/returns/max:1.208 - critic/returns/min:-2.475 - response_length/mean:168.399 - response_length/max:2048.000 - response_length/min:40.000 - response_length/clip_ratio:0.001 - prompt_length/mean:459.383 - prompt_length/max:512.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.675 - timing_s/reshard:4.114 - timing_s/gen:27.321 - timing_s/reward:0.160 - timing_s/old_log_prob:7.059 - timing_s/ref:6.858 - timing_s/adv:0.022 - timing_s/update_actor:22.036 - timing_s/dump_rollout_generations:0.278 - timing_s/step:63.764 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.158 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:642849.000 - perf/time_per_step:63.764 - perf/throughput:1260.218
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/324.jsonl
step:324 - global_seqlen/min:76887.000 - global_seqlen/max:81510.000 - global_seqlen/minmax_diff:4623.000 - global_seqlen/balanced_min:79843.000 - global_seqlen/balanced_max:79844.000 - global_seqlen/mean:79843.500 - actor/entropy_loss:1.298 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.049 - actor/kl_coef:0.010 - actor/pg_loss:0.006 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.627 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:141.866 - actor/lr:0.000 - training/global_step:324.000 - training/epoch:4.000 - critic/score/mean:0.648 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.648 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-0.935 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-0.935 - response_length/mean:162.324 - response_length/max:497.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.453 - prompt_length/max:496.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.796 - timing_s/reshard:4.196 - timing_s/gen:19.517 - timing_s/reward:0.157 - timing_s/old_log_prob:7.278 - timing_s/ref:7.071 - timing_s/adv:0.020 - timing_s/update_actor:22.020 - timing_s/dump_rollout_generations:0.277 - timing_s/step:56.374 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:638748.000 - perf/time_per_step:56.374 - perf/throughput:1416.322
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/325.jsonl
step:325 - global_seqlen/min:77007.000 - global_seqlen/max:81274.000 - global_seqlen/minmax_diff:4267.000 - global_seqlen/balanced_min:78856.000 - global_seqlen/balanced_max:78857.000 - global_seqlen/mean:78856.500 - actor/entropy_loss:1.269 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.020 - actor/kl_coef:0.010 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.327 - perf/mfu/actor:0.180 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:141.973 - actor/lr:0.000 - training/global_step:325.000 - training/epoch:4.000 - critic/score/mean:0.588 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.588 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.007 - critic/advantages/max:0.935 - critic/advantages/min:-2.475 - critic/returns/mean:-0.007 - critic/returns/max:0.935 - critic/returns/min:-2.475 - response_length/mean:155.879 - response_length/max:426.000 - response_length/min:44.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.188 - prompt_length/max:492.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.855 - timing_s/reshard:4.182 - timing_s/gen:18.556 - timing_s/reward:0.154 - timing_s/old_log_prob:7.017 - timing_s/ref:6.811 - timing_s/adv:0.020 - timing_s/update_actor:21.027 - timing_s/dump_rollout_generations:0.276 - timing_s/step:53.892 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:630852.000 - perf/time_per_step:53.892 - perf/throughput:1463.218
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/326.jsonl
step:326 - global_seqlen/min:77038.000 - global_seqlen/max:80886.000 - global_seqlen/minmax_diff:3848.000 - global_seqlen/balanced_min:78544.000 - global_seqlen/balanced_max:78545.000 - global_seqlen/mean:78544.875 - actor/entropy_loss:1.272 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.042 - actor/kl_coef:0.010 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.463 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:141.986 - actor/lr:0.000 - training/global_step:326.000 - training/epoch:4.000 - critic/score/mean:0.649 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.649 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-0.354 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-0.354 - response_length/mean:152.687 - response_length/max:442.000 - response_length/min:48.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.945 - prompt_length/max:509.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.692 - timing_s/reshard:4.418 - timing_s/gen:19.361 - timing_s/reward:0.154 - timing_s/old_log_prob:7.084 - timing_s/ref:6.827 - timing_s/adv:0.020 - timing_s/update_actor:21.684 - timing_s/dump_rollout_generations:0.276 - timing_s/step:55.437 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:628359.000 - perf/time_per_step:55.437 - perf/throughput:1416.839
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/327.jsonl
step:327 - global_seqlen/min:75938.000 - global_seqlen/max:80419.000 - global_seqlen/minmax_diff:4481.000 - global_seqlen/balanced_min:78491.000 - global_seqlen/balanced_max:78492.000 - global_seqlen/mean:78491.625 - actor/entropy_loss:1.325 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.075 - actor/kl_loss:0.029 - actor/kl_coef:0.010 - actor/pg_loss:-0.023 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.540 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:142.405 - actor/lr:0.000 - training/global_step:327.000 - training/epoch:4.000 - critic/score/mean:0.600 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.600 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-1.620 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-1.620 - response_length/mean:155.380 - response_length/max:442.000 - response_length/min:38.000 - response_length/clip_ratio:0.000 - prompt_length/mean:457.836 - prompt_length/max:503.000 - prompt_length/min:432.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.794 - timing_s/reshard:4.090 - timing_s/gen:18.606 - timing_s/reward:0.154 - timing_s/old_log_prob:7.175 - timing_s/ref:6.817 - timing_s/adv:0.019 - timing_s/update_actor:21.971 - timing_s/dump_rollout_generations:0.274 - timing_s/step:55.049 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:627933.000 - perf/time_per_step:55.049 - perf/throughput:1425.851
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/328.jsonl
step:328 - global_seqlen/min:77580.000 - global_seqlen/max:81646.000 - global_seqlen/minmax_diff:4066.000 - global_seqlen/balanced_min:79425.000 - global_seqlen/balanced_max:80874.000 - global_seqlen/mean:79606.125 - actor/entropy_loss:1.274 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.051 - actor/kl_coef:0.010 - actor/pg_loss:0.101 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.527 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:142.489 - actor/lr:0.000 - training/global_step:328.000 - training/epoch:4.000 - critic/score/mean:0.677 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.677 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.033 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.033 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:161.673 - response_length/max:2048.000 - response_length/min:44.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.250 - prompt_length/max:496.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.458 - timing_s/reshard:5.590 - timing_s/gen:29.358 - timing_s/reward:0.154 - timing_s/old_log_prob:7.204 - timing_s/ref:6.946 - timing_s/adv:0.022 - timing_s/update_actor:21.581 - timing_s/dump_rollout_generations:0.277 - timing_s/step:65.575 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.177 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:636849.000 - perf/time_per_step:65.575 - perf/throughput:1213.978
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/329.jsonl
step:329 - global_seqlen/min:76279.000 - global_seqlen/max:80224.000 - global_seqlen/minmax_diff:3945.000 - global_seqlen/balanced_min:78540.000 - global_seqlen/balanced_max:78541.000 - global_seqlen/mean:78540.750 - actor/entropy_loss:1.271 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.024 - actor/kl_coef:0.010 - actor/pg_loss:-0.033 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.752 - perf/mfu/actor:0.182 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:141.145 - actor/lr:0.000 - training/global_step:329.000 - training/epoch:4.000 - critic/score/mean:0.678 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.678 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.005 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.005 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:152.436 - response_length/max:391.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.164 - prompt_length/max:521.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.104 - timing_s/reshard:4.194 - timing_s/gen:18.500 - timing_s/reward:0.153 - timing_s/old_log_prob:7.210 - timing_s/ref:7.182 - timing_s/adv:0.020 - timing_s/update_actor:20.712 - timing_s/dump_rollout_generations:0.272 - timing_s/step:54.082 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.119 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:628326.000 - perf/time_per_step:54.082 - perf/throughput:1452.248
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/330.jsonl
step:330 - global_seqlen/min:76513.000 - global_seqlen/max:81284.000 - global_seqlen/minmax_diff:4771.000 - global_seqlen/balanced_min:78612.000 - global_seqlen/balanced_max:80096.000 - global_seqlen/mean:78797.875 - actor/entropy_loss:1.315 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.046 - training/rollout_probs_diff_std:0.076 - actor/kl_loss:0.024 - actor/kl_coef:0.010 - actor/pg_loss:0.101 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.253 - perf/mfu/actor:0.181 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:140.863 - actor/lr:0.000 - training/global_step:330.000 - training/epoch:4.000 - critic/score/mean:0.642 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.642 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.034 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.034 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:155.405 - response_length/max:2048.000 - response_length/min:38.000 - response_length/clip_ratio:0.001 - prompt_length/mean:460.203 - prompt_length/max:518.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.889 - timing_s/reshard:5.547 - timing_s/gen:28.734 - timing_s/reward:0.154 - timing_s/old_log_prob:7.161 - timing_s/ref:7.010 - timing_s/adv:0.062 - timing_s/update_actor:21.064 - timing_s/dump_rollout_generations:0.276 - timing_s/step:64.494 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - timing_per_token_ms/gen:0.181 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:630383.000 - perf/time_per_step:64.494 - perf/throughput:1221.792
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/331.jsonl
step:331 - global_seqlen/min:77765.000 - global_seqlen/max:81530.000 - global_seqlen/minmax_diff:3765.000 - global_seqlen/balanced_min:80125.000 - global_seqlen/balanced_max:80130.000 - global_seqlen/mean:80126.375 - actor/entropy_loss:1.336 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.033 - actor/kl_coef:0.010 - actor/pg_loss:-0.008 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.329 - perf/mfu/actor:0.179 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:141.122 - actor/lr:0.000 - training/global_step:331.000 - training/epoch:4.000 - critic/score/mean:0.551 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.551 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:163.167 - response_length/max:639.000 - response_length/min:26.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.820 - prompt_length/max:506.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.886 - timing_s/reshard:4.179 - timing_s/gen:20.681 - timing_s/reward:0.183 - timing_s/old_log_prob:7.397 - timing_s/ref:7.111 - timing_s/adv:0.020 - timing_s/update_actor:21.513 - timing_s/dump_rollout_generations:0.278 - timing_s/step:57.212 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:641011.000 - perf/time_per_step:57.212 - perf/throughput:1400.520
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/332.jsonl
step:332 - global_seqlen/min:76788.000 - global_seqlen/max:82644.000 - global_seqlen/minmax_diff:5856.000 - global_seqlen/balanced_min:79507.000 - global_seqlen/balanced_max:80945.000 - global_seqlen/mean:79687.375 - actor/entropy_loss:1.400 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.039 - actor/kl_coef:0.010 - actor/pg_loss:0.085 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.060 - perf/mfu/actor:0.174 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:141.243 - actor/lr:0.000 - training/global_step:332.000 - training/epoch:4.000 - critic/score/mean:0.648 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.648 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.030 - critic/advantages/max:0.354 - critic/advantages/min:-2.475 - critic/returns/mean:-0.030 - critic/returns/max:0.354 - critic/returns/min:-2.475 - response_length/mean:160.019 - response_length/max:2048.000 - response_length/min:32.000 - response_length/clip_ratio:0.001 - prompt_length/mean:462.539 - prompt_length/max:519.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.009 - timing_s/reshard:4.145 - timing_s/gen:27.398 - timing_s/reward:0.156 - timing_s/old_log_prob:7.127 - timing_s/ref:7.082 - timing_s/adv:0.034 - timing_s/update_actor:21.960 - timing_s/dump_rollout_generations:0.278 - timing_s/step:64.068 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.167 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:637499.000 - perf/time_per_step:64.068 - perf/throughput:1243.798
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/333.jsonl
step:333 - global_seqlen/min:76468.000 - global_seqlen/max:82640.000 - global_seqlen/minmax_diff:6172.000 - global_seqlen/balanced_min:78859.000 - global_seqlen/balanced_max:78860.000 - global_seqlen/mean:78859.875 - actor/entropy_loss:1.385 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.077 - actor/kl_loss:0.040 - actor/kl_coef:0.010 - actor/pg_loss:-0.006 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.369 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:141.216 - actor/lr:0.000 - training/global_step:333.000 - training/epoch:4.000 - critic/score/mean:0.651 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.651 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.725 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:0.725 - critic/returns/min:-2.475 - response_length/mean:157.046 - response_length/max:483.000 - response_length/min:28.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.047 - prompt_length/max:506.000 - prompt_length/min:430.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.520 - timing_s/reshard:4.185 - timing_s/gen:18.949 - timing_s/reward:0.155 - timing_s/old_log_prob:7.185 - timing_s/ref:6.877 - timing_s/adv:0.020 - timing_s/update_actor:21.783 - timing_s/dump_rollout_generations:0.276 - timing_s/step:55.278 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.118 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:630879.000 - perf/time_per_step:55.278 - perf/throughput:1426.617
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/334.jsonl
step:334 - global_seqlen/min:76725.000 - global_seqlen/max:81774.000 - global_seqlen/minmax_diff:5049.000 - global_seqlen/balanced_min:79761.000 - global_seqlen/balanced_max:79762.000 - global_seqlen/mean:79761.625 - actor/entropy_loss:1.348 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.027 - actor/kl_coef:0.010 - actor/pg_loss:0.008 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.223 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:141.428 - actor/lr:0.000 - training/global_step:334.000 - training/epoch:4.000 - critic/score/mean:0.677 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.677 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:160.841 - response_length/max:535.000 - response_length/min:43.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.297 - prompt_length/max:523.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.954 - timing_s/reshard:4.140 - timing_s/gen:18.590 - timing_s/reward:0.154 - timing_s/old_log_prob:7.269 - timing_s/ref:7.048 - timing_s/adv:0.020 - timing_s/update_actor:21.808 - timing_s/dump_rollout_generations:0.283 - timing_s/step:55.207 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:638093.000 - perf/time_per_step:55.207 - perf/throughput:1444.776
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/335.jsonl
step:335 - global_seqlen/min:76750.000 - global_seqlen/max:81185.000 - global_seqlen/minmax_diff:4435.000 - global_seqlen/balanced_min:79018.000 - global_seqlen/balanced_max:80435.000 - global_seqlen/mean:79201.625 - actor/entropy_loss:1.377 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.039 - actor/kl_coef:0.010 - actor/pg_loss:0.100 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.202 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:141.492 - actor/lr:0.000 - training/global_step:335.000 - training/epoch:4.000 - critic/score/mean:0.705 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.705 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.031 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.031 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:159.622 - response_length/max:2048.000 - response_length/min:20.000 - response_length/clip_ratio:0.001 - prompt_length/mean:459.141 - prompt_length/max:507.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.236 - timing_s/reshard:6.824 - timing_s/gen:30.361 - timing_s/reward:0.156 - timing_s/old_log_prob:7.171 - timing_s/ref:7.037 - timing_s/adv:0.023 - timing_s/update_actor:22.299 - timing_s/dump_rollout_generations:0.276 - timing_s/step:67.356 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.186 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:633613.000 - perf/time_per_step:67.356 - perf/throughput:1175.858
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/336.jsonl
step:336 - global_seqlen/min:77007.000 - global_seqlen/max:81553.000 - global_seqlen/minmax_diff:4546.000 - global_seqlen/balanced_min:78644.000 - global_seqlen/balanced_max:78645.000 - global_seqlen/mean:78644.500 - actor/entropy_loss:1.411 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.079 - actor/kl_loss:0.063 - actor/kl_coef:0.010 - actor/pg_loss:0.014 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.179 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:141.527 - actor/lr:0.000 - training/global_step:336.000 - training/epoch:4.000 - critic/score/mean:0.614 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.614 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:154.949 - response_length/max:536.000 - response_length/min:30.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.461 - prompt_length/max:502.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.766 - timing_s/reshard:4.152 - timing_s/gen:19.192 - timing_s/reward:0.153 - timing_s/old_log_prob:7.065 - timing_s/ref:6.838 - timing_s/adv:0.021 - timing_s/update_actor:22.036 - timing_s/dump_rollout_generations:0.277 - timing_s/step:55.614 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.121 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:629156.000 - perf/time_per_step:55.614 - perf/throughput:1414.119
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/337.jsonl
step:337 - global_seqlen/min:79298.000 - global_seqlen/max:82069.000 - global_seqlen/minmax_diff:2771.000 - global_seqlen/balanced_min:80119.000 - global_seqlen/balanced_max:80161.000 - global_seqlen/mean:80124.750 - actor/entropy_loss:1.496 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.028 - actor/kl_coef:0.010 - actor/pg_loss:0.021 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.042 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:141.481 - actor/lr:0.000 - training/global_step:337.000 - training/epoch:4.000 - critic/score/mean:0.661 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.661 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:1.208 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:1.208 - critic/returns/min:-2.475 - response_length/mean:166.756 - response_length/max:678.000 - response_length/min:47.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.219 - prompt_length/max:493.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.877 - timing_s/reshard:4.428 - timing_s/gen:19.846 - timing_s/reward:0.157 - timing_s/old_log_prob:7.243 - timing_s/ref:7.220 - timing_s/adv:0.020 - timing_s/update_actor:21.795 - timing_s/dump_rollout_generations:0.297 - timing_s/step:56.609 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:640998.000 - perf/time_per_step:56.609 - perf/throughput:1415.419
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/338.jsonl
step:338 - global_seqlen/min:76212.000 - global_seqlen/max:82882.000 - global_seqlen/minmax_diff:6670.000 - global_seqlen/balanced_min:78491.000 - global_seqlen/balanced_max:78492.000 - global_seqlen/mean:78491.125 - actor/entropy_loss:1.387 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.048 - training/rollout_probs_diff_std:0.080 - actor/kl_loss:0.046 - actor/kl_coef:0.010 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.012 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:141.582 - actor/lr:0.000 - training/global_step:338.000 - training/epoch:4.000 - critic/score/mean:0.649 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.649 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:154.321 - response_length/max:392.000 - response_length/min:20.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.891 - prompt_length/max:492.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.536 - timing_s/reshard:6.538 - timing_s/gen:20.616 - timing_s/reward:0.156 - timing_s/old_log_prob:7.171 - timing_s/ref:7.159 - timing_s/adv:0.020 - timing_s/update_actor:21.793 - timing_s/dump_rollout_generations:0.275 - timing_s/step:57.219 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/gen:0.130 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:627929.000 - perf/time_per_step:57.219 - perf/throughput:1371.764
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/339.jsonl
step:339 - global_seqlen/min:77303.000 - global_seqlen/max:82317.000 - global_seqlen/minmax_diff:5014.000 - global_seqlen/balanced_min:79593.000 - global_seqlen/balanced_max:79659.000 - global_seqlen/mean:79606.750 - actor/entropy_loss:1.425 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.048 - actor/kl_coef:0.010 - actor/pg_loss:-0.005 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.222 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:141.685 - actor/lr:0.000 - training/global_step:339.000 - training/epoch:4.000 - critic/score/mean:0.671 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.671 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.000 - critic/advantages/max:1.620 - critic/advantages/min:-2.475 - critic/returns/mean:0.000 - critic/returns/max:1.620 - critic/returns/min:-2.475 - response_length/mean:161.404 - response_length/max:710.000 - response_length/min:33.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.523 - prompt_length/max:493.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.952 - timing_s/reshard:7.600 - timing_s/gen:23.113 - timing_s/reward:0.155 - timing_s/old_log_prob:7.315 - timing_s/ref:7.176 - timing_s/adv:0.020 - timing_s/update_actor:21.599 - timing_s/dump_rollout_generations:0.276 - timing_s/step:59.691 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.140 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:636854.000 - perf/time_per_step:59.691 - perf/throughput:1333.647
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['position_ids', 'rollout_log_probs', 'attention_mask', 'prompts', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/340.jsonl
local_global_step_folder: ../ckpt/checkpoints/global_step_340
step:340 - global_seqlen/min:77529.000 - global_seqlen/max:80865.000 - global_seqlen/minmax_diff:3336.000 - global_seqlen/balanced_min:79175.000 - global_seqlen/balanced_max:79176.000 - global_seqlen/mean:79175.375 - actor/entropy_loss:1.393 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.047 - training/rollout_probs_diff_std:0.078 - actor/kl_loss:0.041 - actor/kl_coef:0.010 - actor/pg_loss:-0.008 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.224 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.548 - perf/max_memory_reserved_gb:55.549 - perf/cpu_memory_used_gb:141.305 - actor/lr:0.000 - training/global_step:340.000 - training/epoch:4.000 - critic/score/mean:0.700 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.700 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:158.698 - response_length/max:534.000 - response_length/min:30.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.859 - prompt_length/max:516.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.810 - timing_s/reshard:7.682 - timing_s/gen:22.067 - timing_s/reward:0.155 - timing_s/old_log_prob:7.131 - timing_s/ref:7.005 - timing_s/adv:0.020 - timing_s/update_actor:21.391 - timing_s/dump_rollout_generations:0.275 - timing_s/save_checkpoint:30.994 - timing_s/step:89.072 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/gen:0.136 - timing_per_token_ms/ref:0.011 - perf/total_num_tokens:633403.000 - perf/time_per_step:89.072 - perf/throughput:888.896
'Final validation metrics: None'
