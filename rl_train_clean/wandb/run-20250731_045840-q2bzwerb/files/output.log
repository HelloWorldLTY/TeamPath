Using LocalLogger is deprecated. The constructor API will change
Checkpoint tracker file does not exist: %s /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/checkpoints/latest_checkpointed_iteration.txt
Training from scratch
Training Progress:   1%|          | 7/1020 [07:10<16:29:40, 58.62s/it]
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/1.jsonl
step:1 - global_seqlen/min:77515.000 - global_seqlen/max:80850.000 - global_seqlen/minmax_diff:3335.000 - global_seqlen/balanced_min:79254.000 - global_seqlen/balanced_max:79254.000 - global_seqlen/mean:79254.000 - actor/entropy_loss:0.947 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.042 - training/rollout_probs_diff_std:0.065 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:-0.040 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.815 - perf/mfu/actor:0.164 - perf/max_memory_allocated_gb:19.418 - perf/max_memory_reserved_gb:42.801 - perf/cpu_memory_used_gb:94.676 - actor/lr:0.000 - training/global_step:1.000 - training/epoch:0.000 - critic/score/mean:0.553 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.553 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:157.492 - response_length/max:262.000 - response_length/min:75.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.680 - prompt_length/max:511.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.545 - timing_s/reshard:4.791 - timing_s/gen:35.325 - timing_s/reward:0.159 - timing_s/old_log_prob:12.048 - timing_s/ref:10.469 - timing_s/adv:0.020 - timing_s/update_actor:23.173 - timing_s/dump_rollout_generations:0.357 - timing_s/step:81.603 - timing_per_token_ms/ref:0.017 - timing_per_token_ms/gen:0.219 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.037 - perf/total_num_tokens:634032.000 - perf/time_per_step:81.603 - perf/throughput:971.216
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/2.jsonl
step:2 - global_seqlen/min:77548.000 - global_seqlen/max:80127.000 - global_seqlen/minmax_diff:2579.000 - global_seqlen/balanced_min:78451.000 - global_seqlen/balanced_max:78451.000 - global_seqlen/mean:78451.000 - actor/entropy_loss:0.977 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.042 - training/rollout_probs_diff_std:0.065 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:0.058 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.283 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:25.477 - perf/max_memory_reserved_gb:45.904 - perf/cpu_memory_used_gb:99.431 - actor/lr:0.000 - training/global_step:2.000 - training/epoch:0.000 - critic/score/mean:0.613 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.613 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:154.641 - response_length/max:257.000 - response_length/min:83.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.258 - prompt_length/max:521.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.335 - timing_s/reshard:4.086 - timing_s/gen:19.652 - timing_s/reward:0.153 - timing_s/old_log_prob:7.551 - timing_s/ref:7.266 - timing_s/adv:0.021 - timing_s/update_actor:21.857 - timing_s/dump_rollout_generations:0.322 - timing_s/step:56.866 - timing_per_token_ms/ref:0.012 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - perf/total_num_tokens:627608.000 - perf/time_per_step:56.866 - perf/throughput:1379.581
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/3.jsonl
step:3 - global_seqlen/min:77302.000 - global_seqlen/max:79908.000 - global_seqlen/minmax_diff:2606.000 - global_seqlen/balanced_min:78635.000 - global_seqlen/balanced_max:78636.000 - global_seqlen/mean:78635.125 - actor/entropy_loss:0.984 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.066 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:0.006 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.090 - perf/mfu/actor:0.172 - perf/max_memory_allocated_gb:25.586 - perf/max_memory_reserved_gb:50.154 - perf/cpu_memory_used_gb:102.112 - actor/lr:0.000 - training/global_step:3.000 - training/epoch:0.000 - critic/score/mean:0.644 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.644 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.000 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.000 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:155.095 - response_length/max:275.000 - response_length/min:90.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.242 - prompt_length/max:535.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.397 - timing_s/reshard:3.985 - timing_s/gen:17.940 - timing_s/reward:0.154 - timing_s/old_log_prob:7.457 - timing_s/ref:7.292 - timing_s/adv:0.020 - timing_s/update_actor:21.911 - timing_s/dump_rollout_generations:0.344 - timing_s/step:55.160 - timing_per_token_ms/ref:0.012 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - perf/total_num_tokens:629081.000 - perf/time_per_step:55.160 - perf/throughput:1425.578
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/4.jsonl
step:4 - global_seqlen/min:77032.000 - global_seqlen/max:80646.000 - global_seqlen/minmax_diff:3614.000 - global_seqlen/balanced_min:78869.000 - global_seqlen/balanced_max:78901.000 - global_seqlen/mean:78873.250 - actor/entropy_loss:0.979 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.067 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:5.488 - perf/mfu/actor:0.171 - perf/max_memory_allocated_gb:25.690 - perf/max_memory_reserved_gb:50.154 - perf/cpu_memory_used_gb:103.710 - actor/lr:0.000 - training/global_step:4.000 - training/epoch:0.000 - critic/score/mean:0.605 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.605 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.001 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.001 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:156.455 - response_length/max:407.000 - response_length/min:30.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.742 - prompt_length/max:514.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.207 - timing_s/reshard:6.184 - timing_s/gen:19.936 - timing_s/reward:0.153 - timing_s/old_log_prob:7.210 - timing_s/ref:7.224 - timing_s/adv:0.022 - timing_s/update_actor:22.139 - timing_s/dump_rollout_generations:0.340 - timing_s/step:57.058 - timing_per_token_ms/ref:0.011 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - perf/total_num_tokens:630986.000 - perf/time_per_step:57.058 - perf/throughput:1382.341
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/5.jsonl
step:5 - global_seqlen/min:76381.000 - global_seqlen/max:79513.000 - global_seqlen/minmax_diff:3132.000 - global_seqlen/balanced_min:78614.000 - global_seqlen/balanced_max:78615.000 - global_seqlen/mean:78614.125 - actor/entropy_loss:0.973 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.066 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:-0.041 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.725 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:25.690 - perf/max_memory_reserved_gb:50.154 - perf/cpu_memory_used_gb:105.899 - actor/lr:0.000 - training/global_step:5.000 - training/epoch:0.000 - critic/score/mean:0.585 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.585 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.000 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:154.829 - response_length/max:271.000 - response_length/min:84.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.344 - prompt_length/max:491.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.873 - timing_s/reshard:7.584 - timing_s/gen:21.008 - timing_s/reward:0.150 - timing_s/old_log_prob:7.417 - timing_s/ref:7.148 - timing_s/adv:0.019 - timing_s/update_actor:21.864 - timing_s/dump_rollout_generations:0.333 - timing_s/step:57.974 - timing_per_token_ms/ref:0.011 - timing_per_token_ms/gen:0.133 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - perf/total_num_tokens:628913.000 - perf/time_per_step:57.974 - perf/throughput:1356.020
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/6.jsonl
step:6 - global_seqlen/min:78232.000 - global_seqlen/max:81665.000 - global_seqlen/minmax_diff:3433.000 - global_seqlen/balanced_min:79373.000 - global_seqlen/balanced_max:79374.000 - global_seqlen/mean:79373.375 - actor/entropy_loss:0.933 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.066 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:-0.045 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.344 - perf/mfu/actor:0.182 - perf/max_memory_allocated_gb:25.690 - perf/max_memory_reserved_gb:54.314 - perf/cpu_memory_used_gb:107.482 - actor/lr:0.000 - training/global_step:6.000 - training/epoch:0.000 - critic/score/mean:0.571 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.571 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:157.604 - response_length/max:275.000 - response_length/min:90.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.500 - prompt_length/max:516.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.434 - timing_s/reshard:8.325 - timing_s/gen:22.308 - timing_s/reward:0.152 - timing_s/old_log_prob:7.175 - timing_s/ref:7.162 - timing_s/adv:0.022 - timing_s/update_actor:20.930 - timing_s/dump_rollout_generations:0.365 - timing_s/step:58.149 - timing_per_token_ms/ref:0.011 - timing_per_token_ms/gen:0.138 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - perf/total_num_tokens:634987.000 - perf/time_per_step:58.149 - perf/throughput:1365.002
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/7.jsonl
step:7 - global_seqlen/min:77331.000 - global_seqlen/max:80521.000 - global_seqlen/minmax_diff:3190.000 - global_seqlen/balanced_min:78840.000 - global_seqlen/balanced_max:78841.000 - global_seqlen/mean:78840.250 - actor/entropy_loss:0.953 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.042 - training/rollout_probs_diff_std:0.065 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:-0.035 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.138 - perf/mfu/actor:0.189 - perf/max_memory_allocated_gb:25.690 - perf/max_memory_reserved_gb:54.314 - perf/cpu_memory_used_gb:109.924 - actor/lr:0.000 - training/global_step:7.000 - training/epoch:0.000 - critic/score/mean:0.582 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.582 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:156.432 - response_length/max:236.000 - response_length/min:73.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.508 - prompt_length/max:492.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.666 - timing_s/reshard:8.669 - timing_s/gen:21.961 - timing_s/reward:0.153 - timing_s/old_log_prob:7.302 - timing_s/ref:7.164 - timing_s/adv:0.022 - timing_s/update_actor:20.055 - timing_s/dump_rollout_generations:0.368 - timing_s/step:57.071 - timing_per_token_ms/ref:0.011 - timing_per_token_ms/gen:0.137 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.032 - perf/total_num_tokens:630722.000 - perf/time_per_step:57.071 - perf/throughput:1381.431
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/8.jsonl
step:8 - global_seqlen/min:78654.000 - global_seqlen/max:81071.000 - global_seqlen/minmax_diff:2417.000 - global_seqlen/balanced_min:79602.000 - global_seqlen/balanced_max:81301.000 - global_seqlen/mean:79815.000 - actor/entropy_loss:0.959 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.066 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:0.084 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.493 - perf/mfu/actor:0.179 - perf/max_memory_allocated_gb:28.033 - perf/max_memory_reserved_gb:54.314 - perf/cpu_memory_used_gb:111.561 - actor/lr:0.000 - training/global_step:8.000 - training/epoch:0.000 - critic/score/mean:0.619 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.619 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.029 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.029 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:160.359 - response_length/max:2048.000 - response_length/min:64.000 - response_length/clip_ratio:0.001 - prompt_length/mean:463.195 - prompt_length/max:507.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.834 - timing_s/reshard:5.607 - timing_s/gen:29.012 - timing_s/reward:0.154 - timing_s/old_log_prob:7.374 - timing_s/ref:7.285 - timing_s/adv:0.027 - timing_s/update_actor:21.525 - timing_s/dump_rollout_generations:0.341 - timing_s/step:65.757 - timing_per_token_ms/ref:0.011 - timing_per_token_ms/gen:0.177 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - perf/total_num_tokens:638520.000 - perf/time_per_step:65.757 - perf/throughput:1213.786
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/9.jsonl
step:9 - global_seqlen/min:77807.000 - global_seqlen/max:79631.000 - global_seqlen/minmax_diff:1824.000 - global_seqlen/balanced_min:78725.000 - global_seqlen/balanced_max:78782.000 - global_seqlen/mean:78732.125 - actor/entropy_loss:0.977 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.066 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:-0.010 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.576 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.033 - perf/max_memory_reserved_gb:54.314 - perf/cpu_memory_used_gb:111.863 - actor/lr:0.000 - training/global_step:9.000 - training/epoch:0.000 - critic/score/mean:0.638 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.638 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.004 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.004 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:155.571 - response_length/max:360.000 - response_length/min:83.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.523 - prompt_length/max:506.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.188 - timing_s/reshard:6.800 - timing_s/gen:20.552 - timing_s/reward:0.154 - timing_s/old_log_prob:7.408 - timing_s/ref:7.251 - timing_s/adv:0.020 - timing_s/update_actor:21.894 - timing_s/dump_rollout_generations:0.324 - timing_s/step:57.640 - timing_per_token_ms/ref:0.012 - timing_per_token_ms/gen:0.129 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - perf/total_num_tokens:629857.000 - perf/time_per_step:57.640 - perf/throughput:1365.926
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/10.jsonl
step:10 - global_seqlen/min:77350.000 - global_seqlen/max:80907.000 - global_seqlen/minmax_diff:3557.000 - global_seqlen/balanced_min:79110.000 - global_seqlen/balanced_max:79110.000 - global_seqlen/mean:79110.000 - actor/entropy_loss:0.965 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.042 - training/rollout_probs_diff_std:0.064 - actor/kl_loss:0.005 - actor/kl_coef:0.010 - actor/pg_loss:0.006 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.891 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:28.033 - perf/max_memory_reserved_gb:54.314 - perf/cpu_memory_used_gb:113.054 - actor/lr:0.000 - training/global_step:10.000 - training/epoch:0.000 - critic/score/mean:0.655 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.655 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.000 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.000 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:156.547 - response_length/max:257.000 - response_length/min:49.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.500 - prompt_length/max:516.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.811 - timing_s/reshard:7.947 - timing_s/gen:21.319 - timing_s/reward:0.153 - timing_s/old_log_prob:7.410 - timing_s/ref:7.492 - timing_s/adv:0.020 - timing_s/update_actor:22.375 - timing_s/dump_rollout_generations:0.346 - timing_s/step:59.161 - timing_per_token_ms/ref:0.012 - timing_per_token_ms/gen:0.133 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - perf/total_num_tokens:632880.000 - perf/time_per_step:59.161 - perf/throughput:1337.202
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/11.jsonl
step:11 - global_seqlen/min:78023.000 - global_seqlen/max:80322.000 - global_seqlen/minmax_diff:2299.000 - global_seqlen/balanced_min:78855.000 - global_seqlen/balanced_max:80519.000 - global_seqlen/mean:79063.250 - actor/entropy_loss:0.963 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.042 - training/rollout_probs_diff_std:0.066 - actor/kl_loss:0.010 - actor/kl_coef:0.010 - actor/pg_loss:0.135 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.750 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.033 - perf/max_memory_reserved_gb:54.314 - perf/cpu_memory_used_gb:112.507 - actor/lr:0.000 - training/global_step:11.000 - training/epoch:0.000 - critic/score/mean:0.592 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.592 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.033 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.033 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:158.314 - response_length/max:2048.000 - response_length/min:72.000 - response_length/clip_ratio:0.001 - prompt_length/mean:459.367 - prompt_length/max:508.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.240 - timing_s/reshard:8.034 - timing_s/gen:31.589 - timing_s/reward:0.153 - timing_s/old_log_prob:7.439 - timing_s/ref:7.211 - timing_s/adv:0.025 - timing_s/update_actor:21.392 - timing_s/dump_rollout_generations:0.364 - timing_s/step:68.206 - timing_per_token_ms/ref:0.011 - timing_per_token_ms/gen:0.195 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - perf/total_num_tokens:632506.000 - perf/time_per_step:68.206 - perf/throughput:1159.191
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/12.jsonl
step:12 - global_seqlen/min:77339.000 - global_seqlen/max:81478.000 - global_seqlen/minmax_diff:4139.000 - global_seqlen/balanced_min:79582.000 - global_seqlen/balanced_max:79583.000 - global_seqlen/mean:79582.875 - actor/entropy_loss:0.963 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.067 - actor/kl_loss:0.002 - actor/kl_coef:0.010 - actor/pg_loss:-0.006 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.917 - perf/mfu/actor:0.177 - perf/max_memory_allocated_gb:28.033 - perf/max_memory_reserved_gb:54.314 - perf/cpu_memory_used_gb:111.412 - actor/lr:0.000 - training/global_step:12.000 - training/epoch:0.000 - critic/score/mean:0.618 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.618 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:158.194 - response_length/max:258.000 - response_length/min:7.000 - response_length/clip_ratio:0.000 - prompt_length/mean:463.547 - prompt_length/max:519.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:11.935 - timing_s/reshard:4.311 - timing_s/gen:16.792 - timing_s/reward:0.153 - timing_s/old_log_prob:7.406 - timing_s/ref:7.270 - timing_s/adv:0.020 - timing_s/update_actor:21.529 - timing_s/dump_rollout_generations:0.320 - timing_s/step:53.525 - timing_per_token_ms/ref:0.011 - timing_per_token_ms/gen:0.104 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - perf/total_num_tokens:636663.000 - perf/time_per_step:53.525 - perf/throughput:1486.849
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/13.jsonl
step:13 - global_seqlen/min:78434.000 - global_seqlen/max:80003.000 - global_seqlen/minmax_diff:1569.000 - global_seqlen/balanced_min:78920.000 - global_seqlen/balanced_max:78921.000 - global_seqlen/mean:78920.625 - actor/entropy_loss:0.985 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.065 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:-0.023 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.943 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:28.033 - perf/max_memory_reserved_gb:54.314 - perf/cpu_memory_used_gb:111.779 - actor/lr:0.000 - training/global_step:13.000 - training/epoch:0.000 - critic/score/mean:0.654 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.654 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:157.669 - response_length/max:313.000 - response_length/min:59.000 - response_length/clip_ratio:0.000 - prompt_length/mean:458.898 - prompt_length/max:492.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.037 - timing_s/reshard:8.105 - timing_s/gen:20.710 - timing_s/reward:0.155 - timing_s/old_log_prob:7.476 - timing_s/ref:7.378 - timing_s/adv:0.022 - timing_s/update_actor:22.361 - timing_s/dump_rollout_generations:0.375 - timing_s/step:58.518 - timing_per_token_ms/ref:0.012 - timing_per_token_ms/gen:0.128 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - perf/total_num_tokens:631365.000 - perf/time_per_step:58.518 - perf/throughput:1348.647
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/14.jsonl
step:14 - global_seqlen/min:78232.000 - global_seqlen/max:80345.000 - global_seqlen/minmax_diff:2113.000 - global_seqlen/balanced_min:79105.000 - global_seqlen/balanced_max:79106.000 - global_seqlen/mean:79105.875 - actor/entropy_loss:0.964 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.066 - actor/kl_loss:0.018 - actor/kl_coef:0.010 - actor/pg_loss:0.023 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.638 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.033 - perf/max_memory_reserved_gb:54.314 - perf/cpu_memory_used_gb:111.775 - actor/lr:0.000 - training/global_step:14.000 - training/epoch:0.000 - critic/score/mean:0.604 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.604 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:158.405 - response_length/max:262.000 - response_length/min:72.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.609 - prompt_length/max:511.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.165 - timing_s/reshard:7.939 - timing_s/gen:20.655 - timing_s/reward:0.152 - timing_s/old_log_prob:7.050 - timing_s/ref:6.990 - timing_s/adv:0.020 - timing_s/update_actor:21.698 - timing_s/dump_rollout_generations:0.355 - timing_s/step:56.955 - timing_per_token_ms/ref:0.011 - timing_per_token_ms/gen:0.127 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - perf/total_num_tokens:632847.000 - perf/time_per_step:56.955 - perf/throughput:1388.926
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/15.jsonl
step:15 - global_seqlen/min:78301.000 - global_seqlen/max:80514.000 - global_seqlen/minmax_diff:2213.000 - global_seqlen/balanced_min:79436.000 - global_seqlen/balanced_max:79437.000 - global_seqlen/mean:79436.875 - actor/entropy_loss:0.957 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.066 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:0.041 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.223 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.033 - perf/max_memory_reserved_gb:54.314 - perf/cpu_memory_used_gb:112.182 - actor/lr:0.000 - training/global_step:15.000 - training/epoch:0.000 - critic/score/mean:0.604 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.604 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.002 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.002 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:158.702 - response_length/max:278.000 - response_length/min:85.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.898 - prompt_length/max:517.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.021 - timing_s/reshard:8.406 - timing_s/gen:21.040 - timing_s/reward:0.153 - timing_s/old_log_prob:7.167 - timing_s/ref:7.044 - timing_s/adv:0.019 - timing_s/update_actor:22.056 - timing_s/dump_rollout_generations:0.338 - timing_s/step:57.855 - timing_per_token_ms/ref:0.011 - timing_per_token_ms/gen:0.129 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - perf/total_num_tokens:635495.000 - perf/time_per_step:57.855 - perf/throughput:1373.042
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/16.jsonl
step:16 - global_seqlen/min:77119.000 - global_seqlen/max:80926.000 - global_seqlen/minmax_diff:3807.000 - global_seqlen/balanced_min:79440.000 - global_seqlen/balanced_max:79441.000 - global_seqlen/mean:79440.375 - actor/entropy_loss:0.961 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.066 - actor/kl_loss:0.003 - actor/kl_coef:0.010 - actor/pg_loss:-0.042 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.023 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.033 - perf/max_memory_reserved_gb:54.314 - perf/cpu_memory_used_gb:112.767 - actor/lr:0.000 - training/global_step:16.000 - training/epoch:0.000 - critic/score/mean:0.590 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.590 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.000 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.000 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:159.542 - response_length/max:284.000 - response_length/min:94.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.086 - prompt_length/max:509.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.867 - timing_s/reshard:5.441 - timing_s/gen:18.941 - timing_s/reward:0.153 - timing_s/old_log_prob:7.288 - timing_s/ref:7.146 - timing_s/adv:0.022 - timing_s/update_actor:21.387 - timing_s/dump_rollout_generations:0.347 - timing_s/step:55.318 - timing_per_token_ms/ref:0.011 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - perf/total_num_tokens:635523.000 - perf/time_per_step:55.318 - perf/throughput:1436.062
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/17.jsonl
step:17 - global_seqlen/min:77507.000 - global_seqlen/max:80236.000 - global_seqlen/minmax_diff:2729.000 - global_seqlen/balanced_min:79073.000 - global_seqlen/balanced_max:79074.000 - global_seqlen/mean:79073.625 - actor/entropy_loss:0.981 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.042 - training/rollout_probs_diff_std:0.065 - actor/kl_loss:0.008 - actor/kl_coef:0.010 - actor/pg_loss:0.063 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.610 - perf/mfu/actor:0.182 - perf/max_memory_allocated_gb:28.033 - perf/max_memory_reserved_gb:54.314 - perf/cpu_memory_used_gb:113.462 - actor/lr:0.000 - training/global_step:17.000 - training/epoch:0.000 - critic/score/mean:0.631 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.631 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:157.833 - response_length/max:279.000 - response_length/min:29.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.930 - prompt_length/max:497.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.997 - timing_s/reshard:4.074 - timing_s/gen:18.615 - timing_s/reward:0.155 - timing_s/old_log_prob:7.489 - timing_s/ref:7.289 - timing_s/adv:0.020 - timing_s/update_actor:20.965 - timing_s/dump_rollout_generations:0.341 - timing_s/step:54.912 - timing_per_token_ms/ref:0.012 - timing_per_token_ms/gen:0.115 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.033 - perf/total_num_tokens:632589.000 - perf/time_per_step:54.912 - perf/throughput:1439.999
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/18.jsonl
step:18 - global_seqlen/min:79087.000 - global_seqlen/max:82025.000 - global_seqlen/minmax_diff:2938.000 - global_seqlen/balanced_min:79595.000 - global_seqlen/balanced_max:81324.000 - global_seqlen/mean:79811.875 - actor/entropy_loss:0.960 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.042 - training/rollout_probs_diff_std:0.065 - actor/kl_loss:0.002 - actor/kl_coef:0.010 - actor/pg_loss:0.140 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.568 - perf/mfu/actor:0.178 - perf/max_memory_allocated_gb:28.033 - perf/max_memory_reserved_gb:54.314 - perf/cpu_memory_used_gb:114.167 - actor/lr:0.000 - training/global_step:18.000 - training/epoch:0.000 - critic/score/mean:0.593 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.593 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.030 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.030 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:160.858 - response_length/max:2048.000 - response_length/min:89.000 - response_length/clip_ratio:0.001 - prompt_length/mean:462.672 - prompt_length/max:507.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.777 - timing_s/reshard:4.009 - timing_s/gen:26.314 - timing_s/reward:0.156 - timing_s/old_log_prob:7.380 - timing_s/ref:7.289 - timing_s/adv:0.021 - timing_s/update_actor:21.516 - timing_s/dump_rollout_generations:0.341 - timing_s/step:63.059 - timing_per_token_ms/ref:0.011 - timing_per_token_ms/gen:0.160 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - perf/total_num_tokens:638495.000 - perf/time_per_step:63.059 - perf/throughput:1265.672
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/19.jsonl
step:19 - global_seqlen/min:77522.000 - global_seqlen/max:80217.000 - global_seqlen/minmax_diff:2695.000 - global_seqlen/balanced_min:79459.000 - global_seqlen/balanced_max:79459.000 - global_seqlen/mean:79459.000 - actor/entropy_loss:0.956 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.066 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:-0.039 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.738 - perf/mfu/actor:0.176 - perf/max_memory_allocated_gb:28.033 - perf/max_memory_reserved_gb:54.314 - perf/cpu_memory_used_gb:114.560 - actor/lr:0.000 - training/global_step:19.000 - training/epoch:0.000 - critic/score/mean:0.541 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.541 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:158.555 - response_length/max:287.000 - response_length/min:83.000 - response_length/clip_ratio:0.000 - prompt_length/mean:462.219 - prompt_length/max:540.000 - prompt_length/min:435.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.785 - timing_s/reshard:4.013 - timing_s/gen:18.345 - timing_s/reward:0.156 - timing_s/old_log_prob:7.286 - timing_s/ref:7.270 - timing_s/adv:0.021 - timing_s/update_actor:21.709 - timing_s/dump_rollout_generations:0.379 - timing_s/step:55.213 - timing_per_token_ms/ref:0.011 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - perf/total_num_tokens:635672.000 - perf/time_per_step:55.213 - perf/throughput:1439.125
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/20.jsonl
step:20 - global_seqlen/min:78512.000 - global_seqlen/max:80763.000 - global_seqlen/minmax_diff:2251.000 - global_seqlen/balanced_min:79209.000 - global_seqlen/balanced_max:80865.000 - global_seqlen/mean:79416.375 - actor/entropy_loss:0.946 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.042 - training/rollout_probs_diff_std:0.066 - actor/kl_loss:0.009 - actor/kl_coef:0.010 - actor/pg_loss:0.123 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.812 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.033 - perf/max_memory_reserved_gb:54.314 - perf/cpu_memory_used_gb:115.035 - actor/lr:0.000 - training/global_step:20.000 - training/epoch:0.000 - critic/score/mean:0.608 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.608 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.028 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.028 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:158.800 - response_length/max:2048.000 - response_length/min:65.000 - response_length/clip_ratio:0.001 - prompt_length/mean:461.641 - prompt_length/max:514.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:21.742 - timing_s/reshard:4.045 - timing_s/gen:26.373 - timing_s/reward:0.155 - timing_s/old_log_prob:7.365 - timing_s/ref:7.280 - timing_s/adv:0.025 - timing_s/update_actor:21.749 - timing_s/dump_rollout_generations:0.334 - timing_s/step:63.316 - timing_per_token_ms/ref:0.011 - timing_per_token_ms/gen:0.162 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.034 - perf/total_num_tokens:635331.000 - perf/time_per_step:63.316 - perf/throughput:1254.284
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/21.jsonl
step:21 - global_seqlen/min:77068.000 - global_seqlen/max:80887.000 - global_seqlen/minmax_diff:3819.000 - global_seqlen/balanced_min:79178.000 - global_seqlen/balanced_max:79179.000 - global_seqlen/mean:79178.875 - actor/entropy_loss:0.962 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.042 - training/rollout_probs_diff_std:0.065 - actor/kl_loss:0.005 - actor/kl_coef:0.010 - actor/pg_loss:-0.024 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.747 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:28.033 - perf/max_memory_reserved_gb:54.314 - perf/cpu_memory_used_gb:115.837 - actor/lr:0.000 - training/global_step:21.000 - training/epoch:0.000 - critic/score/mean:0.628 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.628 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.006 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.006 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:159.577 - response_length/max:259.000 - response_length/min:72.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.008 - prompt_length/max:512.000 - prompt_length/min:433.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:12.944 - timing_s/reshard:4.076 - timing_s/gen:17.767 - timing_s/reward:0.152 - timing_s/old_log_prob:7.359 - timing_s/ref:7.292 - timing_s/adv:0.022 - timing_s/update_actor:22.390 - timing_s/dump_rollout_generations:0.321 - timing_s/step:55.337 - timing_per_token_ms/ref:0.012 - timing_per_token_ms/gen:0.109 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - perf/total_num_tokens:633431.000 - perf/time_per_step:55.337 - perf/throughput:1430.860
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/22.jsonl
step:22 - global_seqlen/min:77412.000 - global_seqlen/max:80805.000 - global_seqlen/minmax_diff:3393.000 - global_seqlen/balanced_min:79333.000 - global_seqlen/balanced_max:79334.000 - global_seqlen/mean:79333.375 - actor/entropy_loss:0.952 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.066 - actor/kl_loss:0.004 - actor/kl_coef:0.010 - actor/pg_loss:0.019 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.110 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.033 - perf/max_memory_reserved_gb:54.314 - perf/cpu_memory_used_gb:117.674 - actor/lr:0.000 - training/global_step:22.000 - training/epoch:0.000 - critic/score/mean:0.617 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.617 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.000 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:159.253 - response_length/max:320.000 - response_length/min:83.000 - response_length/clip_ratio:0.000 - prompt_length/mean:460.539 - prompt_length/max:526.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:14.690 - timing_s/reshard:4.074 - timing_s/gen:20.004 - timing_s/reward:0.155 - timing_s/old_log_prob:7.198 - timing_s/ref:7.124 - timing_s/adv:0.022 - timing_s/update_actor:22.007 - timing_s/dump_rollout_generations:0.344 - timing_s/step:56.898 - timing_per_token_ms/ref:0.011 - timing_per_token_ms/gen:0.123 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - perf/total_num_tokens:634667.000 - perf/time_per_step:56.898 - perf/throughput:1394.297
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['attention_mask', 'prompts', 'rollout_log_probs', 'position_ids', 'responses', 'input_ids', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to /nfs/roberts/scratch/pi_hz27/tl688/ckpt_pathor1_1e6/rollout_data/23.jsonl
step:23 - global_seqlen/min:78597.000 - global_seqlen/max:79999.000 - global_seqlen/minmax_diff:1402.000 - global_seqlen/balanced_min:79221.000 - global_seqlen/balanced_max:79221.000 - global_seqlen/mean:79221.000 - actor/entropy_loss:0.947 - training/rollout_probs_diff_max:1.000 - training/rollout_probs_diff_mean:0.042 - training/rollout_probs_diff_std:0.065 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:0.026 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.140 - perf/mfu/actor:0.173 - perf/max_memory_allocated_gb:28.033 - perf/max_memory_reserved_gb:54.314 - perf/cpu_memory_used_gb:119.826 - actor/lr:0.000 - training/global_step:23.000 - training/epoch:0.000 - critic/score/mean:0.630 - critic/score/max:1.000 - critic/score/min:0.100 - critic/rewards/mean:0.630 - critic/rewards/max:1.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.003 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.003 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:157.789 - response_length/max:265.000 - response_length/min:56.000 - response_length/clip_ratio:0.000 - prompt_length/mean:461.125 - prompt_length/max:494.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:13.302 - timing_s/reshard:4.045 - timing_s/gen:18.779 - timing_s/reward:0.155 - timing_s/old_log_prob:7.512 - timing_s/ref:7.109 - timing_s/adv:0.019 - timing_s/update_actor:21.981 - timing_s/dump_rollout_generations:0.350 - timing_s/step:55.947 - timing_per_token_ms/ref:0.011 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/update_actor:0.035 - perf/total_num_tokens:633768.000 - perf/time_per_step:55.947 - perf/throughput:1416.000
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/roberts/project/pi_hz27/tl688/verl/verl/single_controller/ray/base.py", line 645, in func
    return getattr(self.worker_dict[key], name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/roberts/project/pi_hz27/tl688/verl/verl/single_controller/base/decorator.py", line 540, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/roberts/project/pi_hz27/tl688/verl/verl/workers/fsdp_workers.py", line 630, in generate_sequences
    output = self.rollout.generate_sequences(prompts=prompts)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/roberts/project/pi_hz27/tl688/verl/verl/utils/debug/performance.py", line 78, in f
    return self.log(decorated_function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/roberts/project/pi_hz27/tl688/verl/verl/utils/debug/performance.py", line 88, in log
    output = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tl688/.conda/envs/verl/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/roberts/project/pi_hz27/tl688/verl/verl/workers/rollout/sglang_rollout/sglang_rollout.py", line 520, in generate_sequences
    return self._batch_level_generate_sequences(prompts, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/roberts/project/pi_hz27/tl688/verl/verl/utils/debug/performance.py", line 78, in f
    return self.log(decorated_function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/roberts/project/pi_hz27/tl688/verl/verl/utils/debug/performance.py", line 88, in log
    output = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tl688/.conda/envs/verl/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/roberts/project/pi_hz27/tl688/verl/verl/workers/rollout/sglang_rollout/sglang_rollout.py", line 659, in _batch_level_generate_sequences
    dist.barrier()
  File "/home/tl688/.conda/envs/verl/lib/python3.11/site-packages/torch/distributed/c10d_logger.py", line 81, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tl688/.conda/envs/verl/lib/python3.11/site-packages/torch/distributed/distributed_c10d.py", line 4556, in barrier
    work.wait()
RuntimeError: [/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.18.20.40]:47527
