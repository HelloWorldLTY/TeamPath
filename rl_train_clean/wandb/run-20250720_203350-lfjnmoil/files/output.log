Using LocalLogger is deprecated. The constructor API will change
Checkpoint tracker file does not exist: %s /nfs/roberts/project/pi_hz27/tl688/verl/../ckpt/checkpoints/latest_checkpointed_iteration.txt
Training from scratch
Training Progress:   1%|          | 3/340 [03:52<6:56:02, 74.07s/it]Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::WorkerDict.actor_rollout_generate_sequences()[39m (pid=4103722, ip=10.18.20.39, actor_id=c261d23396bef0d9547330b201000000, repr=<verl.single_controller.ray.base.WorkerDict object at 0x148185934c90>)
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['prompts', 'position_ids', 'input_ids', 'attention_mask', 'rollout_log_probs', 'responses', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/1.jsonl
step:1 - global_seqlen/min:79080.000 - global_seqlen/max:82392.000 - global_seqlen/minmax_diff:3312.000 - global_seqlen/balanced_min:80559.000 - global_seqlen/balanced_max:81695.000 - global_seqlen/mean:80750.625 - actor/entropy_loss:1.709 - training/rollout_probs_diff_max:0.963 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.073 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:-0.143 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.545 - perf/mfu/actor:0.158 - perf/max_memory_allocated_gb:20.036 - perf/max_memory_reserved_gb:42.324 - perf/cpu_memory_used_gb:97.160 - actor/lr:0.000 - training/global_step:1.000 - training/epoch:0.000 - critic/score/mean:0.471 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.471 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.007 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:169.185 - response_length/max:2048.000 - response_length/min:42.000 - response_length/clip_ratio:0.001 - prompt_length/mean:461.680 - prompt_length/max:511.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:29.726 - timing_s/reshard:8.113 - timing_s/gen:42.842 - timing_s/reward:0.155 - timing_s/old_log_prob:11.783 - timing_s/ref:11.393 - timing_s/adv:0.023 - timing_s/update_actor:24.844 - timing_s/dump_rollout_generations:0.269 - timing_s/step:91.349 - timing_per_token_ms/gen:0.247 - timing_per_token_ms/ref:0.018 - timing_per_token_ms/update_actor:0.038 - timing_per_token_ms/adv:0.000 - perf/total_num_tokens:646005.000 - perf/time_per_step:91.349 - perf/throughput:883.977
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['prompts', 'position_ids', 'input_ids', 'attention_mask', 'rollout_log_probs', 'responses', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/2.jsonl
step:2 - global_seqlen/min:77691.000 - global_seqlen/max:83708.000 - global_seqlen/minmax_diff:6017.000 - global_seqlen/balanced_min:79736.000 - global_seqlen/balanced_max:80820.000 - global_seqlen/mean:79953.875 - actor/entropy_loss:1.733 - training/rollout_probs_diff_max:0.838 - training/rollout_probs_diff_mean:0.043 - training/rollout_probs_diff_std:0.072 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:0.039 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.864 - perf/mfu/actor:0.170 - perf/max_memory_allocated_gb:27.434 - perf/max_memory_reserved_gb:47.240 - perf/cpu_memory_used_gb:99.001 - actor/lr:0.000 - training/global_step:2.000 - training/epoch:0.000 - critic/score/mean:0.514 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.514 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.024 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.024 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:166.382 - response_length/max:2048.000 - response_length/min:33.000 - response_length/clip_ratio:0.001 - prompt_length/mean:458.258 - prompt_length/max:521.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:23.530 - timing_s/reshard:6.609 - timing_s/gen:31.423 - timing_s/reward:0.158 - timing_s/old_log_prob:7.531 - timing_s/ref:7.382 - timing_s/adv:0.021 - timing_s/update_actor:22.618 - timing_s/dump_rollout_generations:0.260 - timing_s/step:69.428 - timing_per_token_ms/gen:0.184 - timing_per_token_ms/ref:0.012 - timing_per_token_ms/update_actor:0.035 - timing_per_token_ms/adv:0.000 - perf/total_num_tokens:639631.000 - perf/time_per_step:69.428 - perf/throughput:1151.601
list(reward_extra_infos_dict.keys())=['score', 'acc', 'pred', 'follow_format', 'gt', 'raw_solution']
_StringKeys(dict_keys(['prompts', 'position_ids', 'input_ids', 'attention_mask', 'rollout_log_probs', 'responses', 'response_mask', 'old_log_probs', 'ref_log_prob', 'token_level_scores', 'token_level_rewards', 'advantages', 'returns']))
Dumped generations to ../ckpt/rollout_data/3.jsonl
step:3 - global_seqlen/min:77520.000 - global_seqlen/max:86433.000 - global_seqlen/minmax_diff:8913.000 - global_seqlen/balanced_min:80442.000 - global_seqlen/balanced_max:81289.000 - global_seqlen/mean:80601.500 - actor/entropy_loss:1.789 - training/rollout_probs_diff_max:0.982 - training/rollout_probs_diff_mean:0.044 - training/rollout_probs_diff_std:0.074 - actor/kl_loss:0.001 - actor/kl_coef:0.010 - actor/pg_loss:0.006 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.785 - perf/mfu/actor:0.175 - perf/max_memory_allocated_gb:28.214 - perf/max_memory_reserved_gb:49.688 - perf/cpu_memory_used_gb:101.528 - actor/lr:0.000 - training/global_step:3.000 - training/epoch:0.000 - critic/score/mean:0.538 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.538 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.043 - critic/advantages/max:2.475 - critic/advantages/min:-2.475 - critic/returns/mean:-0.043 - critic/returns/max:2.475 - critic/returns/min:-2.475 - response_length/mean:170.457 - response_length/max:1740.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:459.242 - prompt_length/max:535.000 - prompt_length/min:434.000 - prompt_length/clip_ratio:0.000 - timing_s/generate_sequences:22.736 - timing_s/reshard:4.144 - timing_s/gen:27.453 - timing_s/reward:0.181 - timing_s/old_log_prob:7.504 - timing_s/ref:7.652 - timing_s/adv:0.028 - timing_s/update_actor:22.174 - timing_s/dump_rollout_generations:0.267 - timing_s/step:65.300 - timing_per_token_ms/gen:0.157 - timing_per_token_ms/ref:0.012 - timing_per_token_ms/update_actor:0.034 - timing_per_token_ms/adv:0.000 - perf/total_num_tokens:644812.000 - perf/time_per_step:65.300 - perf/throughput:1234.322
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/roberts/project/pi_hz27/tl688/verl/verl/single_controller/ray/base.py", line 645, in func
    return getattr(self.worker_dict[key], name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/roberts/project/pi_hz27/tl688/verl/verl/single_controller/base/decorator.py", line 540, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/roberts/project/pi_hz27/tl688/verl/verl/workers/fsdp_workers.py", line 630, in generate_sequences
    output = self.rollout.generate_sequences(prompts=prompts)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/roberts/project/pi_hz27/tl688/verl/verl/utils/debug/performance.py", line 78, in f
    return self.log(decorated_function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/roberts/project/pi_hz27/tl688/verl/verl/utils/debug/performance.py", line 88, in log
    output = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tl688/.conda/envs/verl/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/roberts/project/pi_hz27/tl688/verl/verl/workers/rollout/sglang_rollout/sglang_rollout.py", line 520, in generate_sequences
    return self._batch_level_generate_sequences(prompts, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/roberts/project/pi_hz27/tl688/verl/verl/utils/debug/performance.py", line 78, in f
    return self.log(decorated_function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/roberts/project/pi_hz27/tl688/verl/verl/utils/debug/performance.py", line 88, in log
    output = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tl688/.conda/envs/verl/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/roberts/project/pi_hz27/tl688/verl/verl/workers/rollout/sglang_rollout/sglang_rollout.py", line 659, in _batch_level_generate_sequences
    dist.barrier()
  File "/home/tl688/.conda/envs/verl/lib/python3.11/site-packages/torch/distributed/c10d_logger.py", line 81, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tl688/.conda/envs/verl/lib/python3.11/site-packages/torch/distributed/distributed_c10d.py", line 4556, in barrier
    work.wait()
RuntimeError: [/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.18.20.39]:46825
